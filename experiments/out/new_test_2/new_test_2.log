averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_2
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 100
2018-03-12 19:37:46 -- 
2018-03-12 19:37:46 -- Initializing...
2018-03-12 19:37:46 -- Training...
2018-03-12 19:37:46 -- Building model...
2018-03-12 19:37:47 -- Training model...
2018-03-12 19:38:06 -- 
2018-03-12 19:38:06 -- Epoch = 1/50:
2018-03-12 19:39:11 -- train loss = 0.1022
2018-03-12 19:39:11 -- dev loss = 0.0471
2018-03-12 19:39:11 -- train ROC AUC = 0.7337
2018-03-12 19:39:11 -- dev ROC AUC = 0.7359
2018-03-12 19:39:11 -- New best dev ROC AUC = 0.7359
2018-03-12 19:39:11 -- Saving new best model...
2018-03-12 19:39:13 -- 
2018-03-12 19:39:13 -- Epoch = 2/50:
2018-03-12 19:40:19 -- train loss = 0.0483
2018-03-12 19:40:19 -- dev loss = 0.0387
2018-03-12 19:40:19 -- train ROC AUC = 0.9040
2018-03-12 19:40:19 -- dev ROC AUC = 0.9009
2018-03-12 19:40:19 -- New best dev ROC AUC = 0.9009
2018-03-12 19:40:19 -- Saving new best model...
2018-03-12 19:40:36 -- 
2018-03-12 19:40:36 -- Epoch = 3/50:
2018-03-12 19:41:42 -- train loss = 0.0375
2018-03-12 19:41:42 -- dev loss = 0.0308
2018-03-12 19:41:42 -- train ROC AUC = 0.9454
2018-03-12 19:41:42 -- dev ROC AUC = 0.9387
2018-03-12 19:41:42 -- New best dev ROC AUC = 0.9387
2018-03-12 19:41:42 -- Saving new best model...
2018-03-12 19:41:59 -- 
2018-03-12 19:41:59 -- Epoch = 4/50:
2018-03-12 19:43:05 -- train loss = 0.0313
2018-03-12 19:43:05 -- dev loss = 0.0278
2018-03-12 19:43:05 -- train ROC AUC = 0.9596
2018-03-12 19:43:05 -- dev ROC AUC = 0.9511
2018-03-12 19:43:05 -- New best dev ROC AUC = 0.9511
2018-03-12 19:43:05 -- Saving new best model...
2018-03-12 19:43:23 -- 
2018-03-12 19:43:23 -- Epoch = 5/50:
2018-03-12 19:44:30 -- train loss = 0.0280
2018-03-12 19:44:30 -- dev loss = 0.0270
2018-03-12 19:44:30 -- train ROC AUC = 0.9672
2018-03-12 19:44:30 -- dev ROC AUC = 0.9568
2018-03-12 19:44:30 -- New best dev ROC AUC = 0.9568
2018-03-12 19:44:30 -- Saving new best model...
2018-03-12 19:44:48 -- 
2018-03-12 19:44:48 -- Epoch = 6/50:
2018-03-12 19:45:55 -- train loss = 0.0258
2018-03-12 19:45:55 -- dev loss = 0.0251
2018-03-12 19:45:55 -- train ROC AUC = 0.9740
2018-03-12 19:45:55 -- dev ROC AUC = 0.9618
2018-03-12 19:45:55 -- New best dev ROC AUC = 0.9618
2018-03-12 19:45:55 -- Saving new best model...
2018-03-12 19:46:13 -- 
2018-03-12 19:46:13 -- Epoch = 7/50:
2018-03-12 19:47:19 -- train loss = 0.0238
2018-03-12 19:47:19 -- dev loss = 0.0245
2018-03-12 19:47:19 -- train ROC AUC = 0.9780
2018-03-12 19:47:19 -- dev ROC AUC = 0.9641
2018-03-12 19:47:19 -- New best dev ROC AUC = 0.9641
2018-03-12 19:47:19 -- Saving new best model...
2018-03-12 19:47:38 -- 
2018-03-12 19:47:38 -- Epoch = 8/50:
2018-03-12 19:48:45 -- train loss = 0.0220
2018-03-12 19:48:45 -- dev loss = 0.0238
2018-03-12 19:48:45 -- train ROC AUC = 0.9807
2018-03-12 19:48:45 -- dev ROC AUC = 0.9654
2018-03-12 19:48:45 -- New best dev ROC AUC = 0.9654
2018-03-12 19:48:45 -- Saving new best model...
2018-03-12 19:49:01 -- 
2018-03-12 19:49:01 -- Epoch = 9/50:
2018-03-12 19:50:09 -- train loss = 0.0203
2018-03-12 19:50:09 -- dev loss = 0.0245
2018-03-12 19:50:09 -- train ROC AUC = 0.9824
2018-03-12 19:50:09 -- dev ROC AUC = 0.9656
2018-03-12 19:50:09 -- New best dev ROC AUC = 0.9656
2018-03-12 19:50:09 -- Saving new best model...
2018-03-12 19:50:25 -- 
2018-03-12 19:50:25 -- Epoch = 10/50:
2018-03-12 19:51:33 -- train loss = 0.0193
2018-03-12 19:51:33 -- dev loss = 0.0239
2018-03-12 19:51:33 -- train ROC AUC = 0.9850
2018-03-12 19:51:33 -- dev ROC AUC = 0.9679
2018-03-12 19:51:33 -- New best dev ROC AUC = 0.9679
2018-03-12 19:51:33 -- Saving new best model...
2018-03-12 19:51:50 -- 
2018-03-12 19:51:50 -- Epoch = 11/50:
2018-03-12 19:52:58 -- train loss = 0.0186
2018-03-12 19:52:58 -- dev loss = 0.0236
2018-03-12 19:52:58 -- train ROC AUC = 0.9861
2018-03-12 19:52:58 -- dev ROC AUC = 0.9678
2018-03-12 19:52:58 -- 
2018-03-12 19:52:58 -- Epoch = 12/50:
2018-03-12 19:54:06 -- train loss = 0.0171
2018-03-12 19:54:06 -- dev loss = 0.0240
2018-03-12 19:54:06 -- train ROC AUC = 0.9877
2018-03-12 19:54:06 -- dev ROC AUC = 0.9683
2018-03-12 19:54:06 -- New best dev ROC AUC = 0.9683
2018-03-12 19:54:06 -- Saving new best model...
2018-03-12 19:54:26 -- 
2018-03-12 19:54:26 -- Epoch = 13/50:
2018-03-12 19:55:34 -- train loss = 0.0166
2018-03-12 19:55:34 -- dev loss = 0.0245
2018-03-12 19:55:34 -- train ROC AUC = 0.9881
2018-03-12 19:55:34 -- dev ROC AUC = 0.9668
2018-03-12 19:55:34 -- 
2018-03-12 19:55:34 -- Epoch = 14/50:
2018-03-12 19:56:43 -- train loss = 0.0158
2018-03-12 19:56:43 -- dev loss = 0.0248
2018-03-12 19:56:43 -- train ROC AUC = 0.9887
2018-03-12 19:56:43 -- dev ROC AUC = 0.9656
2018-03-12 19:56:43 -- 
2018-03-12 19:56:43 -- Epoch = 15/50:
2018-03-12 19:57:52 -- train loss = 0.0149
2018-03-12 19:57:52 -- dev loss = 0.0245
2018-03-12 19:57:52 -- train ROC AUC = 0.9904
2018-03-12 19:57:52 -- dev ROC AUC = 0.9679
2018-03-12 19:57:52 -- 
2018-03-12 19:57:52 -- Epoch = 16/50:
2018-03-12 19:59:01 -- train loss = 0.0140
2018-03-12 19:59:01 -- dev loss = 0.0250
2018-03-12 19:59:01 -- train ROC AUC = 0.9908
2018-03-12 19:59:01 -- dev ROC AUC = 0.9670
2018-03-12 19:59:01 -- 
2018-03-12 19:59:01 -- Epoch = 17/50:
2018-03-12 20:00:10 -- train loss = 0.0161
2018-03-12 20:00:10 -- dev loss = 0.0254
2018-03-12 20:00:10 -- train ROC AUC = 0.9901
2018-03-12 20:00:10 -- dev ROC AUC = 0.9644
2018-03-12 20:00:10 -- 
2018-03-12 20:00:10 -- Epoch = 18/50:
2018-03-12 20:01:19 -- train loss = 0.0142
2018-03-12 20:01:19 -- dev loss = 0.0251
2018-03-12 20:01:19 -- train ROC AUC = 0.9913
2018-03-12 20:01:19 -- dev ROC AUC = 0.9655
2018-03-12 20:01:19 -- 
2018-03-12 20:01:19 -- Epoch = 19/50:
2018-03-12 20:02:29 -- train loss = 0.0131
2018-03-12 20:02:29 -- dev loss = 0.0260
2018-03-12 20:02:29 -- train ROC AUC = 0.9917
2018-03-12 20:02:29 -- dev ROC AUC = 0.9647
2018-03-12 20:02:29 -- 
2018-03-12 20:02:29 -- Epoch = 20/50:
2018-03-12 20:03:39 -- train loss = 0.0138
2018-03-12 20:03:39 -- dev loss = 0.0255
2018-03-12 20:03:39 -- train ROC AUC = 0.9923
2018-03-12 20:03:39 -- dev ROC AUC = 0.9660
2018-03-12 20:03:39 -- 
2018-03-12 20:03:39 -- Epoch = 21/50:
2018-03-12 20:04:49 -- train loss = 0.0126
2018-03-12 20:04:49 -- dev loss = 0.0264
2018-03-12 20:04:49 -- train ROC AUC = 0.9929
2018-03-12 20:04:49 -- dev ROC AUC = 0.9651
2018-03-12 20:04:49 -- 
2018-03-12 20:04:49 -- Epoch = 22/50:
2018-03-12 20:06:00 -- train loss = 0.0118
2018-03-12 20:06:00 -- dev loss = 0.0271
2018-03-12 20:06:00 -- train ROC AUC = 0.9932
2018-03-12 20:06:00 -- dev ROC AUC = 0.9643
2018-03-12 20:06:00 -- 
2018-03-12 20:06:00 -- Epoch = 23/50:
2018-03-12 20:07:11 -- train loss = 0.0114
2018-03-12 20:07:11 -- dev loss = 0.0277
2018-03-12 20:07:11 -- train ROC AUC = 0.9935
2018-03-12 20:07:11 -- dev ROC AUC = 0.9634
2018-03-12 20:07:11 -- 
2018-03-12 20:07:11 -- Epoch = 24/50:
2018-03-12 20:09:36 -- train loss = 0.0112
2018-03-12 20:09:36 -- dev loss = 0.0279
2018-03-12 20:09:36 -- train ROC AUC = 0.9940
2018-03-12 20:09:36 -- dev ROC AUC = 0.9632
2018-03-12 20:09:36 -- 
2018-03-12 20:09:36 -- Epoch = 25/50:
2018-03-12 20:10:47 -- train loss = 0.0111
2018-03-12 20:10:47 -- dev loss = 0.0283
2018-03-12 20:10:47 -- train ROC AUC = 0.9942
2018-03-12 20:10:47 -- dev ROC AUC = 0.9633
2018-03-12 20:10:47 -- 
2018-03-12 20:10:47 -- Epoch = 26/50:
2018-03-12 20:11:59 -- train loss = 0.0105
2018-03-12 20:11:59 -- dev loss = 0.0288
2018-03-12 20:11:59 -- train ROC AUC = 0.9945
2018-03-12 20:11:59 -- dev ROC AUC = 0.9621
2018-03-12 20:11:59 -- 
2018-03-12 20:11:59 -- Epoch = 27/50:
2018-03-12 20:13:11 -- train loss = 0.0101
2018-03-12 20:13:11 -- dev loss = 0.0293
2018-03-12 20:13:11 -- train ROC AUC = 0.9948
2018-03-12 20:13:11 -- dev ROC AUC = 0.9624
2018-03-12 20:13:11 -- 
2018-03-12 20:13:11 -- Epoch = 28/50:
2018-03-12 20:14:24 -- train loss = 0.0098
2018-03-12 20:14:24 -- dev loss = 0.0300
2018-03-12 20:14:24 -- train ROC AUC = 0.9950
2018-03-12 20:14:24 -- dev ROC AUC = 0.9616
2018-03-12 20:14:24 -- 
2018-03-12 20:14:24 -- Epoch = 29/50:
2018-03-12 20:15:37 -- train loss = 0.0095
2018-03-12 20:15:37 -- dev loss = 0.0307
2018-03-12 20:15:37 -- train ROC AUC = 0.9953
2018-03-12 20:15:37 -- dev ROC AUC = 0.9604
2018-03-12 20:15:37 -- 
2018-03-12 20:15:37 -- Epoch = 30/50:
2018-03-12 20:16:50 -- train loss = 0.0092
2018-03-12 20:16:50 -- dev loss = 0.0311
2018-03-12 20:16:50 -- train ROC AUC = 0.9954
2018-03-12 20:16:50 -- dev ROC AUC = 0.9603
2018-03-12 20:16:50 -- 
2018-03-12 20:16:50 -- Epoch = 31/50:
2018-03-12 20:18:03 -- train loss = 0.0089
2018-03-12 20:18:03 -- dev loss = 0.0313
2018-03-12 20:18:03 -- train ROC AUC = 0.9957
2018-03-12 20:18:03 -- dev ROC AUC = 0.9607
2018-03-12 20:18:03 -- 
2018-03-12 20:18:03 -- Epoch = 32/50:
2018-03-12 20:19:17 -- train loss = 0.0096
2018-03-12 20:19:17 -- dev loss = 0.0316
2018-03-12 20:19:17 -- train ROC AUC = 0.9956
2018-03-12 20:19:17 -- dev ROC AUC = 0.9601
2018-03-12 20:19:17 -- 
2018-03-12 20:19:17 -- Epoch = 33/50:
2018-03-12 20:20:31 -- train loss = 0.0092
2018-03-12 20:20:31 -- dev loss = 0.0309
2018-03-12 20:20:31 -- train ROC AUC = 0.9958
2018-03-12 20:20:31 -- dev ROC AUC = 0.9606
2018-03-12 20:20:31 -- 
2018-03-12 20:20:31 -- Epoch = 34/50:
2018-03-12 20:21:46 -- train loss = 0.0085
2018-03-12 20:21:46 -- dev loss = 0.0318
2018-03-12 20:21:46 -- train ROC AUC = 0.9960
2018-03-12 20:21:46 -- dev ROC AUC = 0.9593
2018-03-12 20:21:46 -- 
2018-03-12 20:21:46 -- Epoch = 35/50:
2018-03-12 20:23:00 -- train loss = 0.0082
2018-03-12 20:23:00 -- dev loss = 0.0324
2018-03-12 20:23:00 -- train ROC AUC = 0.9962
2018-03-12 20:23:00 -- dev ROC AUC = 0.9587
2018-03-12 20:23:00 -- 
2018-03-12 20:23:00 -- Epoch = 36/50:
2018-03-12 20:24:15 -- train loss = 0.0080
2018-03-12 20:24:15 -- dev loss = 0.0333
2018-03-12 20:24:15 -- train ROC AUC = 0.9964
2018-03-12 20:24:15 -- dev ROC AUC = 0.9581
2018-03-12 20:24:15 -- 
2018-03-12 20:24:15 -- Epoch = 37/50:
2018-03-12 20:25:31 -- train loss = 0.0080
2018-03-12 20:25:31 -- dev loss = 0.0342
2018-03-12 20:25:31 -- train ROC AUC = 0.9966
2018-03-12 20:25:31 -- dev ROC AUC = 0.9581
2018-03-12 20:25:31 -- 
2018-03-12 20:25:31 -- Epoch = 38/50:
2018-03-12 20:26:47 -- train loss = 0.0077
2018-03-12 20:26:47 -- dev loss = 0.0353
2018-03-12 20:26:47 -- train ROC AUC = 0.9964
2018-03-12 20:26:47 -- dev ROC AUC = 0.9556
2018-03-12 20:26:47 -- 
2018-03-12 20:26:47 -- Epoch = 39/50:
2018-03-12 20:28:03 -- train loss = 0.0076
2018-03-12 20:28:03 -- dev loss = 0.0351
2018-03-12 20:28:03 -- train ROC AUC = 0.9967
2018-03-12 20:28:03 -- dev ROC AUC = 0.9561
2018-03-12 20:28:03 -- 
2018-03-12 20:28:03 -- Epoch = 40/50:
2018-03-12 20:29:19 -- train loss = 0.0074
2018-03-12 20:29:19 -- dev loss = 0.0349
2018-03-12 20:29:19 -- train ROC AUC = 0.9969
2018-03-12 20:29:19 -- dev ROC AUC = 0.9573
2018-03-12 20:29:19 -- 
2018-03-12 20:29:19 -- Epoch = 41/50:
2018-03-12 20:30:36 -- train loss = 0.0073
2018-03-12 20:30:36 -- dev loss = 0.0358
2018-03-12 20:30:36 -- train ROC AUC = 0.9970
2018-03-12 20:30:36 -- dev ROC AUC = 0.9550
2018-03-12 20:30:36 -- 
2018-03-12 20:30:36 -- Epoch = 42/50:
2018-03-12 20:31:53 -- train loss = 0.0070
2018-03-12 20:31:53 -- dev loss = 0.0363
2018-03-12 20:31:53 -- train ROC AUC = 0.9970
2018-03-12 20:31:53 -- dev ROC AUC = 0.9549
2018-03-12 20:31:53 -- 
2018-03-12 20:31:53 -- Epoch = 43/50:
2018-03-12 20:33:10 -- train loss = 0.0071
2018-03-12 20:33:10 -- dev loss = 0.0353
2018-03-12 20:33:10 -- train ROC AUC = 0.9970
2018-03-12 20:33:10 -- dev ROC AUC = 0.9559
2018-03-12 20:33:10 -- 
2018-03-12 20:33:10 -- Epoch = 44/50:
2018-03-12 20:34:28 -- train loss = 0.0072
2018-03-12 20:34:28 -- dev loss = 0.0364
2018-03-12 20:34:28 -- train ROC AUC = 0.9970
2018-03-12 20:34:28 -- dev ROC AUC = 0.9564
2018-03-12 20:34:28 -- 
2018-03-12 20:34:28 -- Epoch = 45/50:
2018-03-12 20:35:46 -- train loss = 0.0074
2018-03-12 20:35:46 -- dev loss = 0.0367
2018-03-12 20:35:46 -- train ROC AUC = 0.9972
2018-03-12 20:35:46 -- dev ROC AUC = 0.9559
2018-03-12 20:35:46 -- 
2018-03-12 20:35:46 -- Epoch = 46/50:
2018-03-12 20:37:04 -- train loss = 0.0080
2018-03-12 20:37:04 -- dev loss = 0.0361
2018-03-12 20:37:04 -- train ROC AUC = 0.9971
2018-03-12 20:37:04 -- dev ROC AUC = 0.9558
2018-03-12 20:37:04 -- 
2018-03-12 20:37:04 -- Epoch = 47/50:
2018-03-12 20:38:23 -- train loss = 0.0068
2018-03-12 20:38:23 -- dev loss = 0.0371
2018-03-12 20:38:23 -- train ROC AUC = 0.9974
2018-03-12 20:38:23 -- dev ROC AUC = 0.9560
2018-03-12 20:38:23 -- 
2018-03-12 20:38:23 -- Epoch = 48/50:
2018-03-12 20:39:42 -- train loss = 0.0064
2018-03-12 20:39:42 -- dev loss = 0.0381
2018-03-12 20:39:42 -- train ROC AUC = 0.9976
2018-03-12 20:39:42 -- dev ROC AUC = 0.9537
2018-03-12 20:39:42 -- 
2018-03-12 20:39:42 -- Epoch = 49/50:
2018-03-12 20:41:02 -- train loss = 0.0062
2018-03-12 20:41:02 -- dev loss = 0.0386
2018-03-12 20:41:02 -- train ROC AUC = 0.9977
2018-03-12 20:41:02 -- dev ROC AUC = 0.9540
2018-03-12 20:41:02 -- 
2018-03-12 20:41:02 -- Epoch = 50/50:
2018-03-12 20:42:22 -- train loss = 0.0060
2018-03-12 20:42:22 -- dev loss = 0.0384
2018-03-12 20:42:22 -- train ROC AUC = 0.9974
2018-03-12 20:42:22 -- dev ROC AUC = 0.9542
2018-03-12 20:42:22 -- 
2018-03-12 20:42:22 -- Testing...
2018-03-12 20:42:22 -- Rebuilding model...
2018-03-12 20:42:23 -- Restoring best model...
2018-03-12 20:42:32 -- Restoring parameters from out/new_test_2/new_test_2.weights
2018-03-12 20:42:33 -- Predicting labels for test set...
2018-03-12 20:43:09 -- Saving test prediction...
2018-03-12 20:43:10 -- 
2018-03-12 20:43:10 -- Evaluating...
2018-03-12 20:43:11 -- Mean column-wise ROC AUC - train = 0.9877
2018-03-12 20:43:11 -- Mean column-wise ROC AUC - dev = 0.9683
2018-03-12 20:43:11 -- ROC AUC of toxic - train = 0.9756
2018-03-12 20:43:11 -- ROC AUC of toxic - dev = 0.9519
2018-03-12 20:43:11 -- ROC AUC of severe_toxic - train = 0.9919
2018-03-12 20:43:11 -- ROC AUC of severe_toxic - dev = 0.9852
2018-03-12 20:43:11 -- ROC AUC of obscene - train = 0.9849
2018-03-12 20:43:11 -- ROC AUC of obscene - dev = 0.9675
2018-03-12 20:43:11 -- ROC AUC of threat - train = 0.9983
2018-03-12 20:43:11 -- ROC AUC of threat - dev = 0.9810
2018-03-12 20:43:11 -- ROC AUC of insult - train = 0.9832
2018-03-12 20:43:11 -- ROC AUC of insult - dev = 0.9645
2018-03-12 20:43:11 -- ROC AUC of identity_hate - train = 0.9923
2018-03-12 20:43:11 -- ROC AUC of identity_hate - dev = 0.9596
2018-03-12 20:43:12 -- Mean column-wise average precision - train = 0.7706
2018-03-12 20:43:12 -- Mean column-wise average precision - dev = 0.5473
2018-03-12 20:43:12 -- average precision of toxic - train = 0.8744
2018-03-12 20:43:12 -- average precision of toxic - dev = 0.7890
2018-03-12 20:43:12 -- average precision of severe_toxic - train = 0.5598
2018-03-12 20:43:12 -- average precision of severe_toxic - dev = 0.4605
2018-03-12 20:43:12 -- average precision of obscene - train = 0.8443
2018-03-12 20:43:12 -- average precision of obscene - dev = 0.7635
2018-03-12 20:43:13 -- average precision of threat - train = 0.8785
2018-03-12 20:43:13 -- average precision of threat - dev = 0.3177
2018-03-12 20:43:13 -- average precision of insult - train = 0.7739
2018-03-12 20:43:13 -- average precision of insult - dev = 0.6768
2018-03-12 20:43:13 -- average precision of identity_hate - train = 0.6927
2018-03-12 20:43:13 -- average precision of identity_hate - dev = 0.2765
