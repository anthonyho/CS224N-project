attention: true
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_10
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 2
state_size: 50
2018-03-13 11:17:44 -- 
2018-03-13 11:17:44 -- Initializing...
2018-03-13 11:17:44 -- Training...
2018-03-13 11:17:44 -- Building model...
2018-03-13 11:17:46 -- Training model...
2018-03-13 11:18:06 -- 
2018-03-13 11:18:06 -- Epoch = 1/50:
2018-03-13 11:19:25 -- train loss = 0.1961
2018-03-13 11:19:25 -- dev loss = 0.0537
2018-03-13 11:19:25 -- train ROC AUC = 0.6447
2018-03-13 11:19:25 -- dev ROC AUC = 0.6330
2018-03-13 11:19:25 -- New best dev ROC AUC = 0.6330
2018-03-13 11:19:25 -- Saving new best model...
2018-03-13 11:19:27 -- 
2018-03-13 11:19:27 -- Epoch = 2/50:
2018-03-13 11:20:46 -- train loss = 0.0607
2018-03-13 11:20:46 -- dev loss = 0.0478
2018-03-13 11:20:46 -- train ROC AUC = 0.6641
2018-03-13 11:20:46 -- dev ROC AUC = 0.6521
2018-03-13 11:20:46 -- New best dev ROC AUC = 0.6521
2018-03-13 11:20:46 -- Saving new best model...
2018-03-13 11:21:04 -- 
2018-03-13 11:21:04 -- Epoch = 3/50:
2018-03-13 11:22:23 -- train loss = 0.0552
2018-03-13 11:22:23 -- dev loss = 0.0432
2018-03-13 11:22:23 -- train ROC AUC = 0.8441
2018-03-13 11:22:23 -- dev ROC AUC = 0.8347
2018-03-13 11:22:23 -- New best dev ROC AUC = 0.8347
2018-03-13 11:22:23 -- Saving new best model...
2018-03-13 11:22:41 -- 
2018-03-13 11:22:41 -- Epoch = 4/50:
2018-03-13 11:24:00 -- train loss = 0.0444
2018-03-13 11:24:00 -- dev loss = 0.0332
2018-03-13 11:24:00 -- train ROC AUC = 0.9334
2018-03-13 11:24:00 -- dev ROC AUC = 0.9264
2018-03-13 11:24:00 -- New best dev ROC AUC = 0.9264
2018-03-13 11:24:00 -- Saving new best model...
2018-03-13 11:24:18 -- 
2018-03-13 11:24:18 -- Epoch = 5/50:
2018-03-13 11:25:38 -- train loss = 0.0358
2018-03-13 11:25:38 -- dev loss = 0.0295
2018-03-13 11:25:38 -- train ROC AUC = 0.9584
2018-03-13 11:25:38 -- dev ROC AUC = 0.9490
2018-03-13 11:25:38 -- New best dev ROC AUC = 0.9490
2018-03-13 11:25:38 -- Saving new best model...
2018-03-13 11:25:57 -- 
2018-03-13 11:25:57 -- Epoch = 6/50:
2018-03-13 11:27:17 -- train loss = 0.0315
2018-03-13 11:27:17 -- dev loss = 0.0274
2018-03-13 11:27:17 -- train ROC AUC = 0.9682
2018-03-13 11:27:17 -- dev ROC AUC = 0.9564
2018-03-13 11:27:17 -- New best dev ROC AUC = 0.9564
2018-03-13 11:27:17 -- Saving new best model...
2018-03-13 11:27:35 -- 
2018-03-13 11:27:35 -- Epoch = 7/50:
2018-03-13 11:28:55 -- train loss = 0.0283
2018-03-13 11:28:55 -- dev loss = 0.0264
2018-03-13 11:28:55 -- train ROC AUC = 0.9741
2018-03-13 11:28:55 -- dev ROC AUC = 0.9597
2018-03-13 11:28:55 -- New best dev ROC AUC = 0.9597
2018-03-13 11:28:55 -- Saving new best model...
2018-03-13 11:29:12 -- 
2018-03-13 11:29:12 -- Epoch = 8/50:
2018-03-13 11:30:32 -- train loss = 0.0259
2018-03-13 11:30:32 -- dev loss = 0.0250
2018-03-13 11:30:32 -- train ROC AUC = 0.9799
2018-03-13 11:30:32 -- dev ROC AUC = 0.9656
2018-03-13 11:30:32 -- New best dev ROC AUC = 0.9656
2018-03-13 11:30:32 -- Saving new best model...
2018-03-13 11:30:47 -- 
2018-03-13 11:30:47 -- Epoch = 9/50:
2018-03-13 11:32:07 -- train loss = 0.0237
2018-03-13 11:32:07 -- dev loss = 0.0252
2018-03-13 11:32:07 -- train ROC AUC = 0.9819
2018-03-13 11:32:07 -- dev ROC AUC = 0.9643
2018-03-13 11:32:07 -- 
2018-03-13 11:32:07 -- Epoch = 10/50:
2018-03-13 11:33:28 -- train loss = 0.0217
2018-03-13 11:33:28 -- dev loss = 0.0244
2018-03-13 11:33:28 -- train ROC AUC = 0.9842
2018-03-13 11:33:28 -- dev ROC AUC = 0.9665
2018-03-13 11:33:28 -- New best dev ROC AUC = 0.9665
2018-03-13 11:33:28 -- Saving new best model...
2018-03-13 11:33:43 -- 
2018-03-13 11:33:43 -- Epoch = 11/50:
2018-03-13 11:35:04 -- train loss = 0.0200
2018-03-13 11:35:04 -- dev loss = 0.0233
2018-03-13 11:35:04 -- train ROC AUC = 0.9874
2018-03-13 11:35:04 -- dev ROC AUC = 0.9703
2018-03-13 11:35:04 -- New best dev ROC AUC = 0.9703
2018-03-13 11:35:04 -- Saving new best model...
2018-03-13 11:35:23 -- 
2018-03-13 11:35:23 -- Epoch = 12/50:
2018-03-13 11:36:45 -- train loss = 0.0184
2018-03-13 11:36:45 -- dev loss = 0.0243
2018-03-13 11:36:45 -- train ROC AUC = 0.9885
2018-03-13 11:36:45 -- dev ROC AUC = 0.9680
2018-03-13 11:36:45 -- 
2018-03-13 11:36:45 -- Epoch = 13/50:
2018-03-13 11:38:06 -- train loss = 0.0172
2018-03-13 11:38:06 -- dev loss = 0.0240
2018-03-13 11:38:06 -- train ROC AUC = 0.9894
2018-03-13 11:38:06 -- dev ROC AUC = 0.9690
2018-03-13 11:38:06 -- 
2018-03-13 11:38:06 -- Epoch = 14/50:
2018-03-13 11:39:28 -- train loss = 0.0159
2018-03-13 11:39:28 -- dev loss = 0.0243
2018-03-13 11:39:28 -- train ROC AUC = 0.9907
2018-03-13 11:39:28 -- dev ROC AUC = 0.9688
2018-03-13 11:39:28 -- 
2018-03-13 11:39:28 -- Epoch = 15/50:
2018-03-13 11:40:50 -- train loss = 0.0152
2018-03-13 11:40:50 -- dev loss = 0.0242
2018-03-13 11:40:50 -- train ROC AUC = 0.9915
2018-03-13 11:40:50 -- dev ROC AUC = 0.9689
2018-03-13 11:40:50 -- 
2018-03-13 11:40:50 -- Epoch = 16/50:
2018-03-13 11:42:12 -- train loss = 0.0142
2018-03-13 11:42:12 -- dev loss = 0.0252
2018-03-13 11:42:12 -- train ROC AUC = 0.9921
2018-03-13 11:42:12 -- dev ROC AUC = 0.9685
2018-03-13 11:42:12 -- 
2018-03-13 11:42:12 -- Epoch = 17/50:
2018-03-13 11:43:34 -- train loss = 0.0134
2018-03-13 11:43:34 -- dev loss = 0.0250
2018-03-13 11:43:34 -- train ROC AUC = 0.9929
2018-03-13 11:43:34 -- dev ROC AUC = 0.9691
2018-03-13 11:43:34 -- 
2018-03-13 11:43:34 -- Epoch = 18/50:
2018-03-13 11:44:56 -- train loss = 0.0132
2018-03-13 11:44:56 -- dev loss = 0.0253
2018-03-13 11:44:56 -- train ROC AUC = 0.9933
2018-03-13 11:44:56 -- dev ROC AUC = 0.9691
2018-03-13 11:44:56 -- 
2018-03-13 11:44:56 -- Epoch = 19/50:
2018-03-13 11:46:19 -- train loss = 0.0121
2018-03-13 11:46:19 -- dev loss = 0.0255
2018-03-13 11:46:19 -- train ROC AUC = 0.9938
2018-03-13 11:46:19 -- dev ROC AUC = 0.9685
2018-03-13 11:46:19 -- 
2018-03-13 11:46:19 -- Epoch = 20/50:
2018-03-13 11:47:43 -- train loss = 0.0118
2018-03-13 11:47:43 -- dev loss = 0.0260
2018-03-13 11:47:43 -- train ROC AUC = 0.9941
2018-03-13 11:47:43 -- dev ROC AUC = 0.9689
2018-03-13 11:47:43 -- 
2018-03-13 11:47:43 -- Epoch = 21/50:
2018-03-13 11:49:07 -- train loss = 0.0112
2018-03-13 11:49:07 -- dev loss = 0.0267
2018-03-13 11:49:07 -- train ROC AUC = 0.9943
2018-03-13 11:49:07 -- dev ROC AUC = 0.9691
2018-03-13 11:49:07 -- 
2018-03-13 11:49:07 -- Epoch = 22/50:
2018-03-13 11:50:31 -- train loss = 0.0109
2018-03-13 11:50:31 -- dev loss = 0.0267
2018-03-13 11:50:31 -- train ROC AUC = 0.9945
2018-03-13 11:50:31 -- dev ROC AUC = 0.9693
2018-03-13 11:50:31 -- 
2018-03-13 11:50:31 -- Epoch = 23/50:
2018-03-13 11:51:55 -- train loss = 0.0109
2018-03-13 11:51:55 -- dev loss = 0.0277
2018-03-13 11:51:55 -- train ROC AUC = 0.9946
2018-03-13 11:51:55 -- dev ROC AUC = 0.9682
2018-03-13 11:51:55 -- 
2018-03-13 11:51:55 -- Epoch = 24/50:
2018-03-13 11:53:20 -- train loss = 0.0106
2018-03-13 11:53:20 -- dev loss = 0.0276
2018-03-13 11:53:20 -- train ROC AUC = 0.9950
2018-03-13 11:53:20 -- dev ROC AUC = 0.9686
2018-03-13 11:53:20 -- 
2018-03-13 11:53:20 -- Epoch = 25/50:
2018-03-13 11:54:44 -- train loss = 0.0100
2018-03-13 11:54:44 -- dev loss = 0.0278
2018-03-13 11:54:44 -- train ROC AUC = 0.9953
2018-03-13 11:54:44 -- dev ROC AUC = 0.9688
2018-03-13 11:54:44 -- 
2018-03-13 11:54:44 -- Epoch = 26/50:
2018-03-13 11:56:09 -- train loss = 0.0095
2018-03-13 11:56:09 -- dev loss = 0.0296
2018-03-13 11:56:09 -- train ROC AUC = 0.9954
2018-03-13 11:56:09 -- dev ROC AUC = 0.9664
2018-03-13 11:56:09 -- 
2018-03-13 11:56:09 -- Epoch = 27/50:
2018-03-13 11:57:35 -- train loss = 0.0092
2018-03-13 11:57:35 -- dev loss = 0.0288
2018-03-13 11:57:35 -- train ROC AUC = 0.9957
2018-03-13 11:57:35 -- dev ROC AUC = 0.9680
2018-03-13 11:57:35 -- 
2018-03-13 11:57:35 -- Epoch = 28/50:
2018-03-13 11:59:01 -- train loss = 0.0090
2018-03-13 11:59:01 -- dev loss = 0.0292
2018-03-13 11:59:01 -- train ROC AUC = 0.9958
2018-03-13 11:59:01 -- dev ROC AUC = 0.9681
2018-03-13 11:59:01 -- 
2018-03-13 11:59:01 -- Epoch = 29/50:
2018-03-13 12:00:27 -- train loss = 0.0086
2018-03-13 12:00:27 -- dev loss = 0.0304
2018-03-13 12:00:27 -- train ROC AUC = 0.9960
2018-03-13 12:00:27 -- dev ROC AUC = 0.9672
2018-03-13 12:00:27 -- 
2018-03-13 12:00:27 -- Epoch = 30/50:
2018-03-13 12:01:53 -- train loss = 0.0090
2018-03-13 12:01:53 -- dev loss = 0.0293
2018-03-13 12:01:53 -- train ROC AUC = 0.9960
2018-03-13 12:01:53 -- dev ROC AUC = 0.9676
2018-03-13 12:01:53 -- 
2018-03-13 12:01:53 -- Epoch = 31/50:
2018-03-13 12:03:20 -- train loss = 0.0088
2018-03-13 12:03:20 -- dev loss = 0.0313
2018-03-13 12:03:20 -- train ROC AUC = 0.9958
2018-03-13 12:03:20 -- dev ROC AUC = 0.9653
2018-03-13 12:03:20 -- 
2018-03-13 12:03:20 -- Epoch = 32/50:
2018-03-13 12:04:47 -- train loss = 0.0084
2018-03-13 12:04:47 -- dev loss = 0.0310
2018-03-13 12:04:47 -- train ROC AUC = 0.9962
2018-03-13 12:04:47 -- dev ROC AUC = 0.9667
2018-03-13 12:04:47 -- 
2018-03-13 12:04:47 -- Epoch = 33/50:
2018-03-13 12:06:14 -- train loss = 0.0080
2018-03-13 12:06:14 -- dev loss = 0.0317
2018-03-13 12:06:14 -- train ROC AUC = 0.9963
2018-03-13 12:06:14 -- dev ROC AUC = 0.9665
2018-03-13 12:06:14 -- 
2018-03-13 12:06:14 -- Epoch = 34/50:
2018-03-13 12:07:42 -- train loss = 0.0082
2018-03-13 12:07:42 -- dev loss = 0.0321
2018-03-13 12:07:42 -- train ROC AUC = 0.9964
2018-03-13 12:07:42 -- dev ROC AUC = 0.9672
2018-03-13 12:07:42 -- 
2018-03-13 12:07:42 -- Epoch = 35/50:
2018-03-13 12:09:09 -- train loss = 0.0079
2018-03-13 12:09:09 -- dev loss = 0.0326
2018-03-13 12:09:09 -- train ROC AUC = 0.9964
2018-03-13 12:09:09 -- dev ROC AUC = 0.9661
2018-03-13 12:09:09 -- 
2018-03-13 12:09:09 -- Epoch = 36/50:
2018-03-13 12:10:37 -- train loss = 0.0080
2018-03-13 12:10:37 -- dev loss = 0.0323
2018-03-13 12:10:37 -- train ROC AUC = 0.9966
2018-03-13 12:10:37 -- dev ROC AUC = 0.9666
2018-03-13 12:10:37 -- 
2018-03-13 12:10:37 -- Epoch = 37/50:
2018-03-13 12:12:06 -- train loss = 0.0073
2018-03-13 12:12:06 -- dev loss = 0.0333
2018-03-13 12:12:06 -- train ROC AUC = 0.9967
2018-03-13 12:12:06 -- dev ROC AUC = 0.9660
2018-03-13 12:12:06 -- 
2018-03-13 12:12:06 -- Epoch = 38/50:
2018-03-13 12:13:35 -- train loss = 0.0071
2018-03-13 12:13:35 -- dev loss = 0.0338
2018-03-13 12:13:35 -- train ROC AUC = 0.9968
2018-03-13 12:13:35 -- dev ROC AUC = 0.9662
2018-03-13 12:13:35 -- 
2018-03-13 12:13:35 -- Epoch = 39/50:
2018-03-13 12:15:04 -- train loss = 0.0072
2018-03-13 12:15:04 -- dev loss = 0.0350
2018-03-13 12:15:04 -- train ROC AUC = 0.9968
2018-03-13 12:15:04 -- dev ROC AUC = 0.9635
2018-03-13 12:15:04 -- 
2018-03-13 12:15:04 -- Epoch = 40/50:
2018-03-13 12:16:33 -- train loss = 0.0069
2018-03-13 12:16:33 -- dev loss = 0.0349
2018-03-13 12:16:33 -- train ROC AUC = 0.9970
2018-03-13 12:16:33 -- dev ROC AUC = 0.9643
2018-03-13 12:16:33 -- 
2018-03-13 12:16:33 -- Epoch = 41/50:
2018-03-13 12:18:03 -- train loss = 0.0068
2018-03-13 12:18:03 -- dev loss = 0.0365
2018-03-13 12:18:03 -- train ROC AUC = 0.9968
2018-03-13 12:18:03 -- dev ROC AUC = 0.9624
2018-03-13 12:18:03 -- 
2018-03-13 12:18:03 -- Epoch = 42/50:
2018-03-13 12:19:33 -- train loss = 0.0068
2018-03-13 12:19:33 -- dev loss = 0.0353
2018-03-13 12:19:33 -- train ROC AUC = 0.9971
2018-03-13 12:19:33 -- dev ROC AUC = 0.9664
2018-03-13 12:19:33 -- 
2018-03-13 12:19:33 -- Epoch = 43/50:
2018-03-13 12:21:04 -- train loss = 0.0065
2018-03-13 12:21:04 -- dev loss = 0.0369
2018-03-13 12:21:04 -- train ROC AUC = 0.9972
2018-03-13 12:21:04 -- dev ROC AUC = 0.9618
2018-03-13 12:21:04 -- 
2018-03-13 12:21:04 -- Epoch = 44/50:
2018-03-13 12:22:34 -- train loss = 0.0068
2018-03-13 12:22:34 -- dev loss = 0.0359
2018-03-13 12:22:34 -- train ROC AUC = 0.9973
2018-03-13 12:22:34 -- dev ROC AUC = 0.9640
2018-03-13 12:22:34 -- 
2018-03-13 12:22:34 -- Epoch = 45/50:
2018-03-13 12:24:06 -- train loss = 0.0063
2018-03-13 12:24:06 -- dev loss = 0.0367
2018-03-13 12:24:06 -- train ROC AUC = 0.9974
2018-03-13 12:24:06 -- dev ROC AUC = 0.9621
2018-03-13 12:24:06 -- 
2018-03-13 12:24:06 -- Epoch = 46/50:
2018-03-13 12:25:39 -- train loss = 0.0063
2018-03-13 12:25:39 -- dev loss = 0.0376
2018-03-13 12:25:39 -- train ROC AUC = 0.9973
2018-03-13 12:25:39 -- dev ROC AUC = 0.9633
2018-03-13 12:25:39 -- 
2018-03-13 12:25:39 -- Epoch = 47/50:
2018-03-13 12:27:11 -- train loss = 0.0061
2018-03-13 12:27:11 -- dev loss = 0.0374
2018-03-13 12:27:11 -- train ROC AUC = 0.9975
2018-03-13 12:27:11 -- dev ROC AUC = 0.9647
2018-03-13 12:27:11 -- 
2018-03-13 12:27:11 -- Epoch = 48/50:
2018-03-13 12:28:43 -- train loss = 0.0059
2018-03-13 12:28:43 -- dev loss = 0.0381
2018-03-13 12:28:43 -- train ROC AUC = 0.9976
2018-03-13 12:28:43 -- dev ROC AUC = 0.9614
2018-03-13 12:28:43 -- 
2018-03-13 12:28:43 -- Epoch = 49/50:
2018-03-13 12:30:15 -- train loss = 0.0057
2018-03-13 12:30:15 -- dev loss = 0.0385
2018-03-13 12:30:15 -- train ROC AUC = 0.9976
2018-03-13 12:30:15 -- dev ROC AUC = 0.9637
2018-03-13 12:30:15 -- 
2018-03-13 12:30:15 -- Epoch = 50/50:
2018-03-13 12:31:48 -- train loss = 0.0058
2018-03-13 12:31:48 -- dev loss = 0.0381
2018-03-13 12:31:48 -- train ROC AUC = 0.9976
2018-03-13 12:31:48 -- dev ROC AUC = 0.9650
2018-03-13 12:31:48 -- 
2018-03-13 12:31:48 -- Testing...
2018-03-13 12:31:48 -- Rebuilding model...
2018-03-13 12:31:50 -- Restoring best model...
2018-03-13 12:32:08 -- Restoring parameters from out/new_test_10/new_test_10.weights
2018-03-13 12:32:09 -- Predicting labels for test set...
2018-03-13 12:32:48 -- Saving test prediction...
2018-03-13 12:32:49 -- 
2018-03-13 12:32:49 -- Evaluating...
2018-03-13 12:32:50 -- Mean column-wise ROC AUC - train = 0.9874
2018-03-13 12:32:50 -- Mean column-wise ROC AUC - dev = 0.9703
2018-03-13 12:32:50 -- ROC AUC of toxic - train = 0.9756
2018-03-13 12:32:50 -- ROC AUC of toxic - dev = 0.9607
2018-03-13 12:32:50 -- ROC AUC of severe_toxic - train = 0.9923
2018-03-13 12:32:50 -- ROC AUC of severe_toxic - dev = 0.9870
2018-03-13 12:32:50 -- ROC AUC of obscene - train = 0.9864
2018-03-13 12:32:50 -- ROC AUC of obscene - dev = 0.9736
2018-03-13 12:32:50 -- ROC AUC of threat - train = 0.9975
2018-03-13 12:32:50 -- ROC AUC of threat - dev = 0.9666
2018-03-13 12:32:50 -- ROC AUC of insult - train = 0.9850
2018-03-13 12:32:50 -- ROC AUC of insult - dev = 0.9709
2018-03-13 12:32:51 -- ROC AUC of identity_hate - train = 0.9878
2018-03-13 12:32:51 -- ROC AUC of identity_hate - dev = 0.9632
2018-03-13 12:32:51 -- Mean column-wise average precision - train = 0.6920
2018-03-13 12:32:51 -- Mean column-wise average precision - dev = 0.5328
2018-03-13 12:32:51 -- average precision of toxic - train = 0.8799
2018-03-13 12:32:52 -- average precision of toxic - dev = 0.8061
2018-03-13 12:32:52 -- average precision of severe_toxic - train = 0.4987
2018-03-13 12:32:52 -- average precision of severe_toxic - dev = 0.4433
2018-03-13 12:32:52 -- average precision of obscene - train = 0.8356
2018-03-13 12:32:52 -- average precision of obscene - dev = 0.7566
2018-03-13 12:32:52 -- average precision of threat - train = 0.7996
2018-03-13 12:32:52 -- average precision of threat - dev = 0.2857
2018-03-13 12:32:52 -- average precision of insult - train = 0.7540
2018-03-13 12:32:52 -- average precision of insult - dev = 0.6540
2018-03-13 12:32:52 -- average precision of identity_hate - train = 0.3840
2018-03-13 12:32:52 -- average precision of identity_hate - dev = 0.2514
