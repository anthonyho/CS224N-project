attention: true
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_12
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 2
state_size: 50
2018-03-13 14:05:35 -- 
2018-03-13 14:05:35 -- Initializing...
2018-03-13 14:05:35 -- Training...
2018-03-13 14:05:35 -- Building model...
2018-03-13 14:05:37 -- Training model...
2018-03-13 14:05:57 -- 
2018-03-13 14:05:57 -- Epoch = 1/50:
2018-03-13 14:08:32 -- train loss = 0.1446
2018-03-13 14:08:32 -- dev loss = 0.0493
2018-03-13 14:08:32 -- train ROC AUC = 0.6704
2018-03-13 14:08:32 -- dev ROC AUC = 0.6593
2018-03-13 14:08:32 -- New best dev ROC AUC = 0.6593
2018-03-13 14:08:32 -- Saving new best model...
2018-03-13 14:08:34 -- 
2018-03-13 14:08:34 -- Epoch = 2/50:
2018-03-13 14:11:09 -- train loss = 0.0589
2018-03-13 14:11:09 -- dev loss = 0.0475
2018-03-13 14:11:09 -- train ROC AUC = 0.7269
2018-03-13 14:11:09 -- dev ROC AUC = 0.7165
2018-03-13 14:11:09 -- New best dev ROC AUC = 0.7165
2018-03-13 14:11:09 -- Saving new best model...
2018-03-13 14:11:28 -- 
2018-03-13 14:11:28 -- Epoch = 3/50:
2018-03-13 14:14:04 -- train loss = 0.0522
2018-03-13 14:14:04 -- dev loss = 0.0362
2018-03-13 14:14:04 -- train ROC AUC = 0.9192
2018-03-13 14:14:04 -- dev ROC AUC = 0.9113
2018-03-13 14:14:04 -- New best dev ROC AUC = 0.9113
2018-03-13 14:14:04 -- Saving new best model...
2018-03-13 14:14:22 -- 
2018-03-13 14:14:22 -- Epoch = 4/50:
2018-03-13 14:16:57 -- train loss = 0.0372
2018-03-13 14:16:57 -- dev loss = 0.0287
2018-03-13 14:16:57 -- train ROC AUC = 0.9591
2018-03-13 14:16:57 -- dev ROC AUC = 0.9468
2018-03-13 14:16:57 -- New best dev ROC AUC = 0.9468
2018-03-13 14:16:57 -- Saving new best model...
2018-03-13 14:17:12 -- 
2018-03-13 14:17:12 -- Epoch = 5/50:
2018-03-13 14:19:47 -- train loss = 0.0304
2018-03-13 14:19:47 -- dev loss = 0.0266
2018-03-13 14:19:47 -- train ROC AUC = 0.9689
2018-03-13 14:19:47 -- dev ROC AUC = 0.9560
2018-03-13 14:19:47 -- New best dev ROC AUC = 0.9560
2018-03-13 14:19:47 -- Saving new best model...
2018-03-13 14:20:05 -- 
2018-03-13 14:20:05 -- Epoch = 6/50:
2018-03-13 14:22:40 -- train loss = 0.0274
2018-03-13 14:22:40 -- dev loss = 0.0248
2018-03-13 14:22:40 -- train ROC AUC = 0.9760
2018-03-13 14:22:40 -- dev ROC AUC = 0.9642
2018-03-13 14:22:40 -- New best dev ROC AUC = 0.9642
2018-03-13 14:22:40 -- Saving new best model...
2018-03-13 14:22:59 -- 
2018-03-13 14:22:59 -- Epoch = 7/50:
2018-03-13 14:25:34 -- train loss = 0.0249
2018-03-13 14:25:34 -- dev loss = 0.0243
2018-03-13 14:25:34 -- train ROC AUC = 0.9788
2018-03-13 14:25:34 -- dev ROC AUC = 0.9657
2018-03-13 14:25:34 -- New best dev ROC AUC = 0.9657
2018-03-13 14:25:34 -- Saving new best model...
2018-03-13 14:25:51 -- 
2018-03-13 14:25:51 -- Epoch = 8/50:
2018-03-13 14:28:26 -- train loss = 0.0227
2018-03-13 14:28:26 -- dev loss = 0.0233
2018-03-13 14:28:26 -- train ROC AUC = 0.9829
2018-03-13 14:28:26 -- dev ROC AUC = 0.9696
2018-03-13 14:28:26 -- New best dev ROC AUC = 0.9696
2018-03-13 14:28:26 -- Saving new best model...
2018-03-13 14:28:46 -- 
2018-03-13 14:28:46 -- Epoch = 9/50:
2018-03-13 14:31:22 -- train loss = 0.0208
2018-03-13 14:31:22 -- dev loss = 0.0239
2018-03-13 14:31:22 -- train ROC AUC = 0.9839
2018-03-13 14:31:22 -- dev ROC AUC = 0.9691
2018-03-13 14:31:22 -- 
2018-03-13 14:31:22 -- Epoch = 10/50:
2018-03-13 14:33:58 -- train loss = 0.0197
2018-03-13 14:33:58 -- dev loss = 0.0242
2018-03-13 14:33:58 -- train ROC AUC = 0.9843
2018-03-13 14:33:58 -- dev ROC AUC = 0.9680
2018-03-13 14:33:58 -- 
2018-03-13 14:33:58 -- Epoch = 11/50:
2018-03-13 14:36:34 -- train loss = 0.0183
2018-03-13 14:36:34 -- dev loss = 0.0233
2018-03-13 14:36:34 -- train ROC AUC = 0.9877
2018-03-13 14:36:34 -- dev ROC AUC = 0.9718
2018-03-13 14:36:34 -- New best dev ROC AUC = 0.9718
2018-03-13 14:36:34 -- Saving new best model...
2018-03-13 14:36:53 -- 
2018-03-13 14:36:53 -- Epoch = 12/50:
2018-03-13 14:39:30 -- train loss = 0.0169
2018-03-13 14:39:30 -- dev loss = 0.0236
2018-03-13 14:39:30 -- train ROC AUC = 0.9886
2018-03-13 14:39:30 -- dev ROC AUC = 0.9718
2018-03-13 14:39:30 -- New best dev ROC AUC = 0.9718
2018-03-13 14:39:30 -- Saving new best model...
2018-03-13 14:39:49 -- 
2018-03-13 14:39:49 -- Epoch = 13/50:
2018-03-13 14:42:26 -- train loss = 0.0159
2018-03-13 14:42:26 -- dev loss = 0.0239
2018-03-13 14:42:26 -- train ROC AUC = 0.9892
2018-03-13 14:42:26 -- dev ROC AUC = 0.9696
2018-03-13 14:42:26 -- 
2018-03-13 14:42:26 -- Epoch = 14/50:
2018-03-13 14:45:03 -- train loss = 0.0150
2018-03-13 14:45:03 -- dev loss = 0.0239
2018-03-13 14:45:03 -- train ROC AUC = 0.9901
2018-03-13 14:45:03 -- dev ROC AUC = 0.9701
2018-03-13 14:45:03 -- 
2018-03-13 14:45:03 -- Epoch = 15/50:
2018-03-13 14:47:41 -- train loss = 0.0144
2018-03-13 14:47:41 -- dev loss = 0.0238
2018-03-13 14:47:41 -- train ROC AUC = 0.9911
2018-03-13 14:47:41 -- dev ROC AUC = 0.9716
2018-03-13 14:47:41 -- 
2018-03-13 14:47:41 -- Epoch = 16/50:
2018-03-13 14:50:19 -- train loss = 0.0135
2018-03-13 14:50:19 -- dev loss = 0.0242
2018-03-13 14:50:19 -- train ROC AUC = 0.9916
2018-03-13 14:50:19 -- dev ROC AUC = 0.9705
2018-03-13 14:50:19 -- 
2018-03-13 14:50:19 -- Epoch = 17/50:
2018-03-13 14:52:57 -- train loss = 0.0131
2018-03-13 14:52:57 -- dev loss = 0.0243
2018-03-13 14:52:57 -- train ROC AUC = 0.9922
2018-03-13 14:52:57 -- dev ROC AUC = 0.9707
2018-03-13 14:52:57 -- 
2018-03-13 14:52:57 -- Epoch = 18/50:
2018-03-13 14:55:35 -- train loss = 0.0120
2018-03-13 14:55:35 -- dev loss = 0.0248
2018-03-13 14:55:35 -- train ROC AUC = 0.9926
2018-03-13 14:55:35 -- dev ROC AUC = 0.9706
2018-03-13 14:55:35 -- 
2018-03-13 14:55:35 -- Epoch = 19/50:
2018-03-13 14:58:14 -- train loss = 0.0115
2018-03-13 14:58:14 -- dev loss = 0.0255
2018-03-13 14:58:14 -- train ROC AUC = 0.9927
2018-03-13 14:58:14 -- dev ROC AUC = 0.9676
2018-03-13 14:58:14 -- 
2018-03-13 14:58:14 -- Epoch = 20/50:
2018-03-13 15:00:53 -- train loss = 0.0112
2018-03-13 15:00:53 -- dev loss = 0.0263
2018-03-13 15:00:53 -- train ROC AUC = 0.9932
2018-03-13 15:00:53 -- dev ROC AUC = 0.9684
2018-03-13 15:00:53 -- 
2018-03-13 15:00:53 -- Epoch = 21/50:
2018-03-13 15:03:32 -- train loss = 0.0106
2018-03-13 15:03:32 -- dev loss = 0.0275
2018-03-13 15:03:32 -- train ROC AUC = 0.9932
2018-03-13 15:03:32 -- dev ROC AUC = 0.9658
2018-03-13 15:03:32 -- 
2018-03-13 15:03:32 -- Epoch = 22/50:
2018-03-13 15:06:12 -- train loss = 0.0104
2018-03-13 15:06:12 -- dev loss = 0.0266
2018-03-13 15:06:12 -- train ROC AUC = 0.9938
2018-03-13 15:06:12 -- dev ROC AUC = 0.9704
2018-03-13 15:06:12 -- 
2018-03-13 15:06:12 -- Epoch = 23/50:
2018-03-13 15:08:52 -- train loss = 0.0097
2018-03-13 15:08:52 -- dev loss = 0.0275
2018-03-13 15:08:52 -- train ROC AUC = 0.9942
2018-03-13 15:08:52 -- dev ROC AUC = 0.9679
2018-03-13 15:08:52 -- 
2018-03-13 15:08:52 -- Epoch = 24/50:
2018-03-13 15:11:32 -- train loss = 0.0095
2018-03-13 15:11:32 -- dev loss = 0.0275
2018-03-13 15:11:32 -- train ROC AUC = 0.9944
2018-03-13 15:11:32 -- dev ROC AUC = 0.9679
2018-03-13 15:11:32 -- 
2018-03-13 15:11:32 -- Epoch = 25/50:
2018-03-13 15:14:13 -- train loss = 0.0092
2018-03-13 15:14:13 -- dev loss = 0.0283
2018-03-13 15:14:13 -- train ROC AUC = 0.9947
2018-03-13 15:14:13 -- dev ROC AUC = 0.9692
2018-03-13 15:14:13 -- 
2018-03-13 15:14:13 -- Epoch = 26/50:
2018-03-13 15:16:54 -- train loss = 0.0089
2018-03-13 15:16:54 -- dev loss = 0.0287
2018-03-13 15:16:54 -- train ROC AUC = 0.9949
2018-03-13 15:16:54 -- dev ROC AUC = 0.9677
2018-03-13 15:16:54 -- 
2018-03-13 15:16:54 -- Epoch = 27/50:
2018-03-13 15:19:35 -- train loss = 0.0089
2018-03-13 15:19:35 -- dev loss = 0.0288
2018-03-13 15:19:35 -- train ROC AUC = 0.9949
2018-03-13 15:19:35 -- dev ROC AUC = 0.9669
2018-03-13 15:19:35 -- 
2018-03-13 15:19:35 -- Epoch = 28/50:
2018-03-13 15:22:16 -- train loss = 0.0087
2018-03-13 15:22:16 -- dev loss = 0.0301
2018-03-13 15:22:16 -- train ROC AUC = 0.9950
2018-03-13 15:22:16 -- dev ROC AUC = 0.9686
2018-03-13 15:22:16 -- 
2018-03-13 15:22:16 -- Epoch = 29/50:
2018-03-13 15:24:58 -- train loss = 0.0084
2018-03-13 15:24:58 -- dev loss = 0.0303
2018-03-13 15:24:58 -- train ROC AUC = 0.9951
2018-03-13 15:24:58 -- dev ROC AUC = 0.9686
2018-03-13 15:24:58 -- 
2018-03-13 15:24:58 -- Epoch = 30/50:
2018-03-13 15:27:40 -- train loss = 0.0083
2018-03-13 15:27:40 -- dev loss = 0.0306
2018-03-13 15:27:40 -- train ROC AUC = 0.9953
2018-03-13 15:27:40 -- dev ROC AUC = 0.9665
2018-03-13 15:27:40 -- 
2018-03-13 15:27:40 -- Epoch = 31/50:
2018-03-13 15:30:22 -- train loss = 0.0079
2018-03-13 15:30:22 -- dev loss = 0.0308
2018-03-13 15:30:22 -- train ROC AUC = 0.9954
2018-03-13 15:30:22 -- dev ROC AUC = 0.9680
2018-03-13 15:30:22 -- 
2018-03-13 15:30:22 -- Epoch = 32/50:
2018-03-13 15:33:08 -- train loss = 0.0076
2018-03-13 15:33:08 -- dev loss = 0.0313
2018-03-13 15:33:08 -- train ROC AUC = 0.9957
2018-03-13 15:33:08 -- dev ROC AUC = 0.9680
2018-03-13 15:33:08 -- 
2018-03-13 15:33:08 -- Epoch = 33/50:
2018-03-13 15:35:51 -- train loss = 0.0082
2018-03-13 15:35:51 -- dev loss = 0.0313
2018-03-13 15:35:51 -- train ROC AUC = 0.9955
2018-03-13 15:35:51 -- dev ROC AUC = 0.9661
2018-03-13 15:35:51 -- 
2018-03-13 15:35:51 -- Epoch = 34/50:
2018-03-13 15:38:34 -- train loss = 0.0079
2018-03-13 15:38:34 -- dev loss = 0.0329
2018-03-13 15:38:34 -- train ROC AUC = 0.9956
2018-03-13 15:38:34 -- dev ROC AUC = 0.9643
2018-03-13 15:38:34 -- 
2018-03-13 15:38:34 -- Epoch = 35/50:
2018-03-13 15:41:17 -- train loss = 0.0075
2018-03-13 15:41:17 -- dev loss = 0.0330
2018-03-13 15:41:17 -- train ROC AUC = 0.9958
2018-03-13 15:41:17 -- dev ROC AUC = 0.9665
2018-03-13 15:41:17 -- 
2018-03-13 15:41:17 -- Epoch = 36/50:
2018-03-13 15:44:02 -- train loss = 0.0070
2018-03-13 15:44:02 -- dev loss = 0.0328
2018-03-13 15:44:02 -- train ROC AUC = 0.9960
2018-03-13 15:44:02 -- dev ROC AUC = 0.9656
2018-03-13 15:44:02 -- 
2018-03-13 15:44:02 -- Epoch = 37/50:
2018-03-13 15:46:46 -- train loss = 0.0067
2018-03-13 15:46:46 -- dev loss = 0.0342
2018-03-13 15:46:46 -- train ROC AUC = 0.9961
2018-03-13 15:46:46 -- dev ROC AUC = 0.9633
2018-03-13 15:46:46 -- 
2018-03-13 15:46:46 -- Epoch = 38/50:
2018-03-13 15:49:31 -- train loss = 0.0066
2018-03-13 15:49:31 -- dev loss = 0.0347
2018-03-13 15:49:31 -- train ROC AUC = 0.9962
2018-03-13 15:49:31 -- dev ROC AUC = 0.9628
2018-03-13 15:49:31 -- 
2018-03-13 15:49:31 -- Epoch = 39/50:
2018-03-13 15:52:17 -- train loss = 0.0065
2018-03-13 15:52:17 -- dev loss = 0.0344
2018-03-13 15:52:17 -- train ROC AUC = 0.9964
2018-03-13 15:52:17 -- dev ROC AUC = 0.9665
2018-03-13 15:52:17 -- 
2018-03-13 15:52:17 -- Epoch = 40/50:
2018-03-13 15:55:04 -- train loss = 0.0066
2018-03-13 15:55:04 -- dev loss = 0.0349
2018-03-13 15:55:04 -- train ROC AUC = 0.9964
2018-03-13 15:55:04 -- dev ROC AUC = 0.9658
2018-03-13 15:55:04 -- 
2018-03-13 15:55:04 -- Epoch = 41/50:
2018-03-13 15:57:51 -- train loss = 0.0062
2018-03-13 15:57:51 -- dev loss = 0.0354
2018-03-13 15:57:51 -- train ROC AUC = 0.9966
2018-03-13 15:57:51 -- dev ROC AUC = 0.9663
2018-03-13 15:57:51 -- 
2018-03-13 15:57:51 -- Epoch = 42/50:
2018-03-13 16:00:38 -- train loss = 0.0062
2018-03-13 16:00:38 -- dev loss = 0.0362
2018-03-13 16:00:38 -- train ROC AUC = 0.9965
2018-03-13 16:00:38 -- dev ROC AUC = 0.9625
2018-03-13 16:00:38 -- 
2018-03-13 16:00:38 -- Epoch = 43/50:
2018-03-13 16:03:27 -- train loss = 0.0063
2018-03-13 16:03:27 -- dev loss = 0.0360
2018-03-13 16:03:27 -- train ROC AUC = 0.9966
2018-03-13 16:03:27 -- dev ROC AUC = 0.9647
2018-03-13 16:03:27 -- 
2018-03-13 16:03:27 -- Epoch = 44/50:
2018-03-13 16:06:15 -- train loss = 0.0059
2018-03-13 16:06:15 -- dev loss = 0.0361
2018-03-13 16:06:15 -- train ROC AUC = 0.9967
2018-03-13 16:06:15 -- dev ROC AUC = 0.9658
2018-03-13 16:06:15 -- 
2018-03-13 16:06:15 -- Epoch = 45/50:
2018-03-13 16:09:03 -- train loss = 0.0058
2018-03-13 16:09:03 -- dev loss = 0.0369
2018-03-13 16:09:03 -- train ROC AUC = 0.9969
2018-03-13 16:09:03 -- dev ROC AUC = 0.9639
2018-03-13 16:09:03 -- 
2018-03-13 16:09:03 -- Epoch = 46/50:
2018-03-13 16:11:52 -- train loss = 0.0056
2018-03-13 16:11:52 -- dev loss = 0.0372
2018-03-13 16:11:52 -- train ROC AUC = 0.9970
2018-03-13 16:11:52 -- dev ROC AUC = 0.9627
2018-03-13 16:11:52 -- 
2018-03-13 16:11:52 -- Epoch = 47/50:
2018-03-13 16:14:41 -- train loss = 0.0057
2018-03-13 16:14:41 -- dev loss = 0.0375
2018-03-13 16:14:41 -- train ROC AUC = 0.9971
2018-03-13 16:14:41 -- dev ROC AUC = 0.9652
2018-03-13 16:14:41 -- 
2018-03-13 16:14:41 -- Epoch = 48/50:
2018-03-13 16:17:30 -- train loss = 0.0053
2018-03-13 16:17:30 -- dev loss = 0.0388
2018-03-13 16:17:30 -- train ROC AUC = 0.9970
2018-03-13 16:17:30 -- dev ROC AUC = 0.9631
2018-03-13 16:17:30 -- 
2018-03-13 16:17:30 -- Epoch = 49/50:
2018-03-13 16:20:19 -- train loss = 0.0054
2018-03-13 16:20:19 -- dev loss = 0.0389
2018-03-13 16:20:19 -- train ROC AUC = 0.9973
2018-03-13 16:20:19 -- dev ROC AUC = 0.9642
2018-03-13 16:20:19 -- 
2018-03-13 16:20:19 -- Epoch = 50/50:
2018-03-13 16:23:09 -- train loss = 0.0053
2018-03-13 16:23:09 -- dev loss = 0.0387
2018-03-13 16:23:09 -- train ROC AUC = 0.9973
2018-03-13 16:23:09 -- dev ROC AUC = 0.9659
2018-03-13 16:23:09 -- 
2018-03-13 16:23:09 -- Testing...
2018-03-13 16:23:09 -- Rebuilding model...
2018-03-13 16:23:11 -- Restoring best model...
2018-03-13 16:23:40 -- Restoring parameters from out/new_test_12/new_test_12.weights
2018-03-13 16:23:40 -- Predicting labels for test set...
2018-03-13 16:24:51 -- Saving test prediction...
2018-03-13 16:24:52 -- 
2018-03-13 16:24:52 -- Evaluating...
2018-03-13 16:24:53 -- Mean column-wise ROC AUC - train = 0.9886
2018-03-13 16:24:53 -- Mean column-wise ROC AUC - dev = 0.9718
2018-03-13 16:24:53 -- ROC AUC of toxic - train = 0.9759
2018-03-13 16:24:53 -- ROC AUC of toxic - dev = 0.9591
2018-03-13 16:24:53 -- ROC AUC of severe_toxic - train = 0.9930
2018-03-13 16:24:54 -- ROC AUC of severe_toxic - dev = 0.9875
2018-03-13 16:24:54 -- ROC AUC of obscene - train = 0.9882
2018-03-13 16:24:54 -- ROC AUC of obscene - dev = 0.9762
2018-03-13 16:24:54 -- ROC AUC of threat - train = 0.9987
2018-03-13 16:24:54 -- ROC AUC of threat - dev = 0.9677
2018-03-13 16:24:54 -- ROC AUC of insult - train = 0.9868
2018-03-13 16:24:54 -- ROC AUC of insult - dev = 0.9740
2018-03-13 16:24:54 -- ROC AUC of identity_hate - train = 0.9891
2018-03-13 16:24:54 -- ROC AUC of identity_hate - dev = 0.9665
2018-03-13 16:24:55 -- Mean column-wise average precision - train = 0.7448
2018-03-13 16:24:55 -- Mean column-wise average precision - dev = 0.5553
2018-03-13 16:24:55 -- average precision of toxic - train = 0.8989
2018-03-13 16:24:55 -- average precision of toxic - dev = 0.8255
2018-03-13 16:24:55 -- average precision of severe_toxic - train = 0.5107
2018-03-13 16:24:55 -- average precision of severe_toxic - dev = 0.4313
2018-03-13 16:24:55 -- average precision of obscene - train = 0.8486
2018-03-13 16:24:55 -- average precision of obscene - dev = 0.7849
2018-03-13 16:24:55 -- average precision of threat - train = 0.9112
2018-03-13 16:24:56 -- average precision of threat - dev = 0.3168
2018-03-13 16:24:56 -- average precision of insult - train = 0.8043
2018-03-13 16:24:56 -- average precision of insult - dev = 0.7099
2018-03-13 16:24:56 -- average precision of identity_hate - train = 0.4948
2018-03-13 16:24:56 -- average precision of identity_hate - dev = 0.2634
