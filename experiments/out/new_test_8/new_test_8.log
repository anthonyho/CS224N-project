attention: false
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: GRU
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_8
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 2
state_size: 50
2018-03-13 07:43:55 -- 
2018-03-13 07:43:55 -- Initializing...
2018-03-13 07:43:55 -- Training...
2018-03-13 07:43:55 -- Building model...
2018-03-13 07:44:00 -- Training model...
2018-03-13 07:44:17 -- 
2018-03-13 07:44:17 -- Epoch = 1/50:
2018-03-13 07:47:12 -- train loss = 0.1422
2018-03-13 07:47:12 -- dev loss = 0.0493
2018-03-13 07:47:12 -- train ROC AUC = 0.6731
2018-03-13 07:47:12 -- dev ROC AUC = 0.6594
2018-03-13 07:47:12 -- New best dev ROC AUC = 0.6594
2018-03-13 07:47:12 -- Saving new best model...
2018-03-13 07:47:16 -- 
2018-03-13 07:47:16 -- Epoch = 2/50:
2018-03-13 07:50:11 -- train loss = 0.0590
2018-03-13 07:50:11 -- dev loss = 0.0471
2018-03-13 07:50:11 -- train ROC AUC = 0.7287
2018-03-13 07:50:11 -- dev ROC AUC = 0.7099
2018-03-13 07:50:11 -- New best dev ROC AUC = 0.7099
2018-03-13 07:50:11 -- Saving new best model...
2018-03-13 07:50:30 -- 
2018-03-13 07:50:30 -- Epoch = 3/50:
2018-03-13 07:53:26 -- train loss = 0.0533
2018-03-13 07:53:26 -- dev loss = 0.0398
2018-03-13 07:53:26 -- train ROC AUC = 0.9063
2018-03-13 07:53:26 -- dev ROC AUC = 0.8994
2018-03-13 07:53:26 -- New best dev ROC AUC = 0.8994
2018-03-13 07:53:26 -- Saving new best model...
2018-03-13 07:53:44 -- 
2018-03-13 07:53:44 -- Epoch = 4/50:
2018-03-13 07:56:41 -- train loss = 0.0410
2018-03-13 07:56:41 -- dev loss = 0.0306
2018-03-13 07:56:41 -- train ROC AUC = 0.9591
2018-03-13 07:56:41 -- dev ROC AUC = 0.9545
2018-03-13 07:56:41 -- New best dev ROC AUC = 0.9545
2018-03-13 07:56:41 -- Saving new best model...
2018-03-13 07:56:59 -- 
2018-03-13 07:56:59 -- Epoch = 5/50:
2018-03-13 07:59:56 -- train loss = 0.0323
2018-03-13 07:59:56 -- dev loss = 0.0265
2018-03-13 07:59:56 -- train ROC AUC = 0.9729
2018-03-13 07:59:56 -- dev ROC AUC = 0.9670
2018-03-13 07:59:56 -- New best dev ROC AUC = 0.9670
2018-03-13 07:59:56 -- Saving new best model...
2018-03-13 08:00:14 -- 
2018-03-13 08:00:14 -- Epoch = 6/50:
2018-03-13 08:03:10 -- train loss = 0.0274
2018-03-13 08:03:10 -- dev loss = 0.0243
2018-03-13 08:03:10 -- train ROC AUC = 0.9792
2018-03-13 08:03:10 -- dev ROC AUC = 0.9722
2018-03-13 08:03:10 -- New best dev ROC AUC = 0.9722
2018-03-13 08:03:10 -- Saving new best model...
2018-03-13 08:03:29 -- 
2018-03-13 08:03:29 -- Epoch = 7/50:
2018-03-13 08:06:27 -- train loss = 0.0243
2018-03-13 08:06:27 -- dev loss = 0.0232
2018-03-13 08:06:27 -- train ROC AUC = 0.9829
2018-03-13 08:06:27 -- dev ROC AUC = 0.9746
2018-03-13 08:06:27 -- New best dev ROC AUC = 0.9746
2018-03-13 08:06:27 -- Saving new best model...
2018-03-13 08:06:45 -- 
2018-03-13 08:06:45 -- Epoch = 8/50:
2018-03-13 08:09:42 -- train loss = 0.0222
2018-03-13 08:09:42 -- dev loss = 0.0229
2018-03-13 08:09:42 -- train ROC AUC = 0.9850
2018-03-13 08:09:42 -- dev ROC AUC = 0.9749
2018-03-13 08:09:42 -- New best dev ROC AUC = 0.9749
2018-03-13 08:09:42 -- Saving new best model...
2018-03-13 08:10:01 -- 
2018-03-13 08:10:01 -- Epoch = 9/50:
2018-03-13 08:12:58 -- train loss = 0.0204
2018-03-13 08:12:58 -- dev loss = 0.0223
2018-03-13 08:12:58 -- train ROC AUC = 0.9873
2018-03-13 08:12:58 -- dev ROC AUC = 0.9761
2018-03-13 08:12:58 -- New best dev ROC AUC = 0.9761
2018-03-13 08:12:58 -- Saving new best model...
2018-03-13 08:13:15 -- 
2018-03-13 08:13:15 -- Epoch = 10/50:
2018-03-13 08:16:13 -- train loss = 0.0187
2018-03-13 08:16:13 -- dev loss = 0.0223
2018-03-13 08:16:13 -- train ROC AUC = 0.9891
2018-03-13 08:16:13 -- dev ROC AUC = 0.9758
2018-03-13 08:16:13 -- 
2018-03-13 08:16:13 -- Epoch = 11/50:
2018-03-13 08:19:11 -- train loss = 0.0175
2018-03-13 08:19:11 -- dev loss = 0.0225
2018-03-13 08:19:11 -- train ROC AUC = 0.9901
2018-03-13 08:19:11 -- dev ROC AUC = 0.9744
2018-03-13 08:19:11 -- 
2018-03-13 08:19:11 -- Epoch = 12/50:
2018-03-13 08:22:09 -- train loss = 0.0162
2018-03-13 08:22:09 -- dev loss = 0.0226
2018-03-13 08:22:09 -- train ROC AUC = 0.9914
2018-03-13 08:22:09 -- dev ROC AUC = 0.9746
2018-03-13 08:22:09 -- 
2018-03-13 08:22:09 -- Epoch = 13/50:
2018-03-13 08:25:08 -- train loss = 0.0151
2018-03-13 08:25:08 -- dev loss = 0.0234
2018-03-13 08:25:08 -- train ROC AUC = 0.9921
2018-03-13 08:25:08 -- dev ROC AUC = 0.9732
2018-03-13 08:25:08 -- 
2018-03-13 08:25:08 -- Epoch = 14/50:
2018-03-13 08:28:06 -- train loss = 0.0144
2018-03-13 08:28:06 -- dev loss = 0.0233
2018-03-13 08:28:06 -- train ROC AUC = 0.9929
2018-03-13 08:28:06 -- dev ROC AUC = 0.9730
2018-03-13 08:28:06 -- 
2018-03-13 08:28:06 -- Epoch = 15/50:
2018-03-13 08:31:06 -- train loss = 0.0134
2018-03-13 08:31:06 -- dev loss = 0.0237
2018-03-13 08:31:06 -- train ROC AUC = 0.9935
2018-03-13 08:31:06 -- dev ROC AUC = 0.9718
2018-03-13 08:31:06 -- 
2018-03-13 08:31:06 -- Epoch = 16/50:
2018-03-13 08:34:06 -- train loss = 0.0128
2018-03-13 08:34:06 -- dev loss = 0.0240
2018-03-13 08:34:06 -- train ROC AUC = 0.9941
2018-03-13 08:34:06 -- dev ROC AUC = 0.9718
2018-03-13 08:34:06 -- 
2018-03-13 08:34:06 -- Epoch = 17/50:
2018-03-13 08:37:05 -- train loss = 0.0122
2018-03-13 08:37:05 -- dev loss = 0.0244
2018-03-13 08:37:05 -- train ROC AUC = 0.9944
2018-03-13 08:37:05 -- dev ROC AUC = 0.9715
2018-03-13 08:37:05 -- 
2018-03-13 08:37:05 -- Epoch = 18/50:
2018-03-13 08:40:05 -- train loss = 0.0118
2018-03-13 08:40:05 -- dev loss = 0.0250
2018-03-13 08:40:05 -- train ROC AUC = 0.9948
2018-03-13 08:40:05 -- dev ROC AUC = 0.9705
2018-03-13 08:40:05 -- 
2018-03-13 08:40:05 -- Epoch = 19/50:
2018-03-13 08:43:05 -- train loss = 0.0112
2018-03-13 08:43:05 -- dev loss = 0.0258
2018-03-13 08:43:05 -- train ROC AUC = 0.9951
2018-03-13 08:43:05 -- dev ROC AUC = 0.9702
2018-03-13 08:43:05 -- 
2018-03-13 08:43:05 -- Epoch = 20/50:
2018-03-13 08:46:06 -- train loss = 0.0106
2018-03-13 08:46:06 -- dev loss = 0.0261
2018-03-13 08:46:06 -- train ROC AUC = 0.9954
2018-03-13 08:46:06 -- dev ROC AUC = 0.9695
2018-03-13 08:46:06 -- 
2018-03-13 08:46:06 -- Epoch = 21/50:
2018-03-13 08:49:06 -- train loss = 0.0102
2018-03-13 08:49:06 -- dev loss = 0.0269
2018-03-13 08:49:06 -- train ROC AUC = 0.9957
2018-03-13 08:49:06 -- dev ROC AUC = 0.9694
2018-03-13 08:49:06 -- 
2018-03-13 08:49:06 -- Epoch = 22/50:
2018-03-13 08:52:07 -- train loss = 0.0099
2018-03-13 08:52:07 -- dev loss = 0.0274
2018-03-13 08:52:07 -- train ROC AUC = 0.9959
2018-03-13 08:52:07 -- dev ROC AUC = 0.9683
2018-03-13 08:52:07 -- 
2018-03-13 08:52:07 -- Epoch = 23/50:
2018-03-13 08:55:09 -- train loss = 0.0095
2018-03-13 08:55:09 -- dev loss = 0.0283
2018-03-13 08:55:09 -- train ROC AUC = 0.9960
2018-03-13 08:55:09 -- dev ROC AUC = 0.9680
2018-03-13 08:55:09 -- 
2018-03-13 08:55:09 -- Epoch = 24/50:
2018-03-13 08:58:10 -- train loss = 0.0090
2018-03-13 08:58:10 -- dev loss = 0.0292
2018-03-13 08:58:10 -- train ROC AUC = 0.9962
2018-03-13 08:58:10 -- dev ROC AUC = 0.9669
2018-03-13 08:58:10 -- 
2018-03-13 08:58:10 -- Epoch = 25/50:
2018-03-13 09:01:11 -- train loss = 0.0086
2018-03-13 09:01:11 -- dev loss = 0.0295
2018-03-13 09:01:11 -- train ROC AUC = 0.9964
2018-03-13 09:01:11 -- dev ROC AUC = 0.9661
2018-03-13 09:01:11 -- 
2018-03-13 09:01:11 -- Epoch = 26/50:
2018-03-13 09:04:13 -- train loss = 0.0084
2018-03-13 09:04:13 -- dev loss = 0.0302
2018-03-13 09:04:13 -- train ROC AUC = 0.9965
2018-03-13 09:04:13 -- dev ROC AUC = 0.9661
2018-03-13 09:04:13 -- 
2018-03-13 09:04:13 -- Epoch = 27/50:
2018-03-13 09:07:14 -- train loss = 0.0081
2018-03-13 09:07:14 -- dev loss = 0.0314
2018-03-13 09:07:14 -- train ROC AUC = 0.9967
2018-03-13 09:07:14 -- dev ROC AUC = 0.9652
2018-03-13 09:07:14 -- 
2018-03-13 09:07:14 -- Epoch = 28/50:
2018-03-13 09:10:16 -- train loss = 0.0078
2018-03-13 09:10:16 -- dev loss = 0.0316
2018-03-13 09:10:16 -- train ROC AUC = 0.9968
2018-03-13 09:10:16 -- dev ROC AUC = 0.9650
2018-03-13 09:10:16 -- 
2018-03-13 09:10:16 -- Epoch = 29/50:
2018-03-13 09:13:18 -- train loss = 0.0074
2018-03-13 09:13:18 -- dev loss = 0.0318
2018-03-13 09:13:18 -- train ROC AUC = 0.9970
2018-03-13 09:13:18 -- dev ROC AUC = 0.9651
2018-03-13 09:13:18 -- 
2018-03-13 09:13:18 -- Epoch = 30/50:
2018-03-13 09:16:21 -- train loss = 0.0073
2018-03-13 09:16:21 -- dev loss = 0.0332
2018-03-13 09:16:21 -- train ROC AUC = 0.9970
2018-03-13 09:16:21 -- dev ROC AUC = 0.9634
2018-03-13 09:16:21 -- 
2018-03-13 09:16:21 -- Epoch = 31/50:
2018-03-13 09:19:23 -- train loss = 0.0070
2018-03-13 09:19:23 -- dev loss = 0.0331
2018-03-13 09:19:23 -- train ROC AUC = 0.9972
2018-03-13 09:19:23 -- dev ROC AUC = 0.9641
2018-03-13 09:19:23 -- 
2018-03-13 09:19:23 -- Epoch = 32/50:
2018-03-13 09:22:27 -- train loss = 0.0067
2018-03-13 09:22:27 -- dev loss = 0.0342
2018-03-13 09:22:27 -- train ROC AUC = 0.9972
2018-03-13 09:22:27 -- dev ROC AUC = 0.9635
2018-03-13 09:22:27 -- 
2018-03-13 09:22:27 -- Epoch = 33/50:
2018-03-13 09:25:31 -- train loss = 0.0067
2018-03-13 09:25:31 -- dev loss = 0.0347
2018-03-13 09:25:31 -- train ROC AUC = 0.9973
2018-03-13 09:25:31 -- dev ROC AUC = 0.9645
2018-03-13 09:25:31 -- 
2018-03-13 09:25:31 -- Epoch = 34/50:
2018-03-13 09:28:36 -- train loss = 0.0065
2018-03-13 09:28:36 -- dev loss = 0.0347
2018-03-13 09:28:36 -- train ROC AUC = 0.9974
2018-03-13 09:28:36 -- dev ROC AUC = 0.9643
2018-03-13 09:28:36 -- 
2018-03-13 09:28:36 -- Epoch = 35/50:
2018-03-13 09:31:41 -- train loss = 0.0066
2018-03-13 09:31:41 -- dev loss = 0.0349
2018-03-13 09:31:41 -- train ROC AUC = 0.9974
2018-03-13 09:31:41 -- dev ROC AUC = 0.9637
2018-03-13 09:31:41 -- 
2018-03-13 09:31:41 -- Epoch = 36/50:
2018-03-13 09:34:47 -- train loss = 0.0062
2018-03-13 09:34:47 -- dev loss = 0.0350
2018-03-13 09:34:47 -- train ROC AUC = 0.9975
2018-03-13 09:34:47 -- dev ROC AUC = 0.9643
2018-03-13 09:34:47 -- 
2018-03-13 09:34:47 -- Epoch = 37/50:
2018-03-13 09:37:53 -- train loss = 0.0060
2018-03-13 09:37:53 -- dev loss = 0.0364
2018-03-13 09:37:53 -- train ROC AUC = 0.9976
2018-03-13 09:37:53 -- dev ROC AUC = 0.9623
2018-03-13 09:37:53 -- 
2018-03-13 09:37:53 -- Epoch = 38/50:
2018-03-13 09:40:59 -- train loss = 0.0058
2018-03-13 09:40:59 -- dev loss = 0.0363
2018-03-13 09:40:59 -- train ROC AUC = 0.9977
2018-03-13 09:40:59 -- dev ROC AUC = 0.9631
2018-03-13 09:40:59 -- 
2018-03-13 09:40:59 -- Epoch = 39/50:
2018-03-13 09:44:05 -- train loss = 0.0058
2018-03-13 09:44:05 -- dev loss = 0.0369
2018-03-13 09:44:05 -- train ROC AUC = 0.9976
2018-03-13 09:44:05 -- dev ROC AUC = 0.9624
2018-03-13 09:44:05 -- 
2018-03-13 09:44:05 -- Epoch = 40/50:
2018-03-13 09:47:12 -- train loss = 0.0058
2018-03-13 09:47:12 -- dev loss = 0.0369
2018-03-13 09:47:12 -- train ROC AUC = 0.9977
2018-03-13 09:47:12 -- dev ROC AUC = 0.9639
2018-03-13 09:47:12 -- 
2018-03-13 09:47:12 -- Epoch = 41/50:
2018-03-13 09:50:19 -- train loss = 0.0054
2018-03-13 09:50:19 -- dev loss = 0.0384
2018-03-13 09:50:19 -- train ROC AUC = 0.9978
2018-03-13 09:50:19 -- dev ROC AUC = 0.9627
2018-03-13 09:50:19 -- 
2018-03-13 09:50:19 -- Epoch = 42/50:
2018-03-13 09:53:26 -- train loss = 0.0053
2018-03-13 09:53:26 -- dev loss = 0.0387
2018-03-13 09:53:26 -- train ROC AUC = 0.9979
2018-03-13 09:53:26 -- dev ROC AUC = 0.9637
2018-03-13 09:53:26 -- 
2018-03-13 09:53:26 -- Epoch = 43/50:
2018-03-13 09:56:34 -- train loss = 0.0051
2018-03-13 09:56:34 -- dev loss = 0.0395
2018-03-13 09:56:34 -- train ROC AUC = 0.9980
2018-03-13 09:56:34 -- dev ROC AUC = 0.9630
2018-03-13 09:56:34 -- 
2018-03-13 09:56:34 -- Epoch = 44/50:
2018-03-13 09:59:43 -- train loss = 0.0051
2018-03-13 09:59:43 -- dev loss = 0.0403
2018-03-13 09:59:43 -- train ROC AUC = 0.9980
2018-03-13 09:59:43 -- dev ROC AUC = 0.9619
2018-03-13 09:59:43 -- 
2018-03-13 09:59:43 -- Epoch = 45/50:
2018-03-13 10:02:52 -- train loss = 0.0049
2018-03-13 10:02:52 -- dev loss = 0.0408
2018-03-13 10:02:52 -- train ROC AUC = 0.9980
2018-03-13 10:02:52 -- dev ROC AUC = 0.9623
2018-03-13 10:02:52 -- 
2018-03-13 10:02:52 -- Epoch = 46/50:
2018-03-13 10:06:01 -- train loss = 0.0051
2018-03-13 10:06:01 -- dev loss = 0.0412
2018-03-13 10:06:01 -- train ROC AUC = 0.9981
2018-03-13 10:06:01 -- dev ROC AUC = 0.9617
2018-03-13 10:06:01 -- 
2018-03-13 10:06:01 -- Epoch = 47/50:
2018-03-13 10:09:11 -- train loss = 0.0046
2018-03-13 10:09:11 -- dev loss = 0.0415
2018-03-13 10:09:11 -- train ROC AUC = 0.9982
2018-03-13 10:09:11 -- dev ROC AUC = 0.9619
2018-03-13 10:09:11 -- 
2018-03-13 10:09:11 -- Epoch = 48/50:
2018-03-13 10:12:21 -- train loss = 0.0046
2018-03-13 10:12:21 -- dev loss = 0.0423
2018-03-13 10:12:21 -- train ROC AUC = 0.9982
2018-03-13 10:12:21 -- dev ROC AUC = 0.9616
2018-03-13 10:12:21 -- 
2018-03-13 10:12:21 -- Epoch = 49/50:
2018-03-13 10:15:31 -- train loss = 0.0044
2018-03-13 10:15:31 -- dev loss = 0.0422
2018-03-13 10:15:31 -- train ROC AUC = 0.9983
2018-03-13 10:15:31 -- dev ROC AUC = 0.9620
2018-03-13 10:15:31 -- 
2018-03-13 10:15:31 -- Epoch = 50/50:
2018-03-13 10:18:41 -- train loss = 0.0043
2018-03-13 10:18:41 -- dev loss = 0.0433
2018-03-13 10:18:41 -- train ROC AUC = 0.9984
2018-03-13 10:18:41 -- dev ROC AUC = 0.9612
2018-03-13 10:18:41 -- 
2018-03-13 10:18:41 -- Testing...
2018-03-13 10:18:41 -- Rebuilding model...
2018-03-13 10:18:46 -- Restoring best model...
2018-03-13 10:19:06 -- Restoring parameters from out/new_test_8/new_test_8.weights
2018-03-13 10:19:07 -- Predicting labels for test set...
2018-03-13 10:20:16 -- Saving test prediction...
2018-03-13 10:20:17 -- 
2018-03-13 10:20:17 -- Evaluating...
2018-03-13 10:20:18 -- Mean column-wise ROC AUC - train = 0.9873
2018-03-13 10:20:18 -- Mean column-wise ROC AUC - dev = 0.9761
2018-03-13 10:20:18 -- ROC AUC of toxic - train = 0.9763
2018-03-13 10:20:18 -- ROC AUC of toxic - dev = 0.9669
2018-03-13 10:20:18 -- ROC AUC of severe_toxic - train = 0.9901
2018-03-13 10:20:18 -- ROC AUC of severe_toxic - dev = 0.9887
2018-03-13 10:20:18 -- ROC AUC of obscene - train = 0.9865
2018-03-13 10:20:18 -- ROC AUC of obscene - dev = 0.9772
2018-03-13 10:20:18 -- ROC AUC of threat - train = 0.9982
2018-03-13 10:20:18 -- ROC AUC of threat - dev = 0.9761
2018-03-13 10:20:18 -- ROC AUC of insult - train = 0.9856
2018-03-13 10:20:18 -- ROC AUC of insult - dev = 0.9756
2018-03-13 10:20:19 -- ROC AUC of identity_hate - train = 0.9874
2018-03-13 10:20:19 -- ROC AUC of identity_hate - dev = 0.9720
2018-03-13 10:20:19 -- Mean column-wise average precision - train = 0.7025
2018-03-13 10:20:19 -- Mean column-wise average precision - dev = 0.5619
2018-03-13 10:20:19 -- average precision of toxic - train = 0.8897
2018-03-13 10:20:20 -- average precision of toxic - dev = 0.8477
2018-03-13 10:20:20 -- average precision of severe_toxic - train = 0.4761
2018-03-13 10:20:20 -- average precision of severe_toxic - dev = 0.4469
2018-03-13 10:20:20 -- average precision of obscene - train = 0.8371
2018-03-13 10:20:20 -- average precision of obscene - dev = 0.7763
2018-03-13 10:20:20 -- average precision of threat - train = 0.7996
2018-03-13 10:20:20 -- average precision of threat - dev = 0.2912
2018-03-13 10:20:20 -- average precision of insult - train = 0.7901
2018-03-13 10:20:20 -- average precision of insult - dev = 0.7077
2018-03-13 10:20:20 -- average precision of identity_hate - train = 0.4223
2018-03-13 10:20:20 -- average precision of identity_hate - dev = 0.3016
