attention: true
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_11
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-13 12:32:54 -- 
2018-03-13 12:32:54 -- Initializing...
2018-03-13 12:32:54 -- Training...
2018-03-13 12:32:54 -- Building model...
2018-03-13 12:32:58 -- Training model...
2018-03-13 12:33:15 -- 
2018-03-13 12:33:15 -- Epoch = 1/50:
2018-03-13 12:34:52 -- train loss = 0.1619
2018-03-13 12:34:52 -- dev loss = 0.0480
2018-03-13 12:34:52 -- train ROC AUC = 0.7107
2018-03-13 12:34:52 -- dev ROC AUC = 0.7010
2018-03-13 12:34:52 -- New best dev ROC AUC = 0.7010
2018-03-13 12:34:52 -- Saving new best model...
2018-03-13 12:34:54 -- 
2018-03-13 12:34:54 -- Epoch = 2/50:
2018-03-13 12:36:31 -- train loss = 0.0548
2018-03-13 12:36:31 -- dev loss = 0.0442
2018-03-13 12:36:31 -- train ROC AUC = 0.8399
2018-03-13 12:36:31 -- dev ROC AUC = 0.8314
2018-03-13 12:36:31 -- New best dev ROC AUC = 0.8314
2018-03-13 12:36:31 -- Saving new best model...
2018-03-13 12:36:53 -- 
2018-03-13 12:36:53 -- Epoch = 3/50:
2018-03-13 12:38:30 -- train loss = 0.0473
2018-03-13 12:38:30 -- dev loss = 0.0360
2018-03-13 12:38:30 -- train ROC AUC = 0.9290
2018-03-13 12:38:30 -- dev ROC AUC = 0.9221
2018-03-13 12:38:30 -- New best dev ROC AUC = 0.9221
2018-03-13 12:38:30 -- Saving new best model...
2018-03-13 12:38:49 -- 
2018-03-13 12:38:49 -- Epoch = 4/50:
2018-03-13 12:40:26 -- train loss = 0.0376
2018-03-13 12:40:26 -- dev loss = 0.0298
2018-03-13 12:40:26 -- train ROC AUC = 0.9592
2018-03-13 12:40:26 -- dev ROC AUC = 0.9548
2018-03-13 12:40:26 -- New best dev ROC AUC = 0.9548
2018-03-13 12:40:26 -- Saving new best model...
2018-03-13 12:40:43 -- 
2018-03-13 12:40:43 -- Epoch = 5/50:
2018-03-13 12:42:21 -- train loss = 0.0324
2018-03-13 12:42:21 -- dev loss = 0.0267
2018-03-13 12:42:21 -- train ROC AUC = 0.9706
2018-03-13 12:42:21 -- dev ROC AUC = 0.9648
2018-03-13 12:42:21 -- New best dev ROC AUC = 0.9648
2018-03-13 12:42:21 -- Saving new best model...
2018-03-13 12:42:40 -- 
2018-03-13 12:42:40 -- Epoch = 6/50:
2018-03-13 12:44:18 -- train loss = 0.0286
2018-03-13 12:44:18 -- dev loss = 0.0253
2018-03-13 12:44:18 -- train ROC AUC = 0.9762
2018-03-13 12:44:18 -- dev ROC AUC = 0.9690
2018-03-13 12:44:18 -- New best dev ROC AUC = 0.9690
2018-03-13 12:44:18 -- Saving new best model...
2018-03-13 12:44:36 -- 
2018-03-13 12:44:37 -- Epoch = 7/50:
2018-03-13 12:46:15 -- train loss = 0.0265
2018-03-13 12:46:15 -- dev loss = 0.0244
2018-03-13 12:46:15 -- train ROC AUC = 0.9794
2018-03-13 12:46:15 -- dev ROC AUC = 0.9710
2018-03-13 12:46:15 -- New best dev ROC AUC = 0.9710
2018-03-13 12:46:15 -- Saving new best model...
2018-03-13 12:46:34 -- 
2018-03-13 12:46:34 -- Epoch = 8/50:
2018-03-13 12:48:13 -- train loss = 0.0243
2018-03-13 12:48:13 -- dev loss = 0.0233
2018-03-13 12:48:13 -- train ROC AUC = 0.9826
2018-03-13 12:48:13 -- dev ROC AUC = 0.9732
2018-03-13 12:48:13 -- New best dev ROC AUC = 0.9732
2018-03-13 12:48:13 -- Saving new best model...
2018-03-13 12:48:33 -- 
2018-03-13 12:48:33 -- Epoch = 9/50:
2018-03-13 12:50:12 -- train loss = 0.0223
2018-03-13 12:50:12 -- dev loss = 0.0229
2018-03-13 12:50:12 -- train ROC AUC = 0.9845
2018-03-13 12:50:12 -- dev ROC AUC = 0.9739
2018-03-13 12:50:12 -- New best dev ROC AUC = 0.9739
2018-03-13 12:50:12 -- Saving new best model...
2018-03-13 12:50:31 -- 
2018-03-13 12:50:31 -- Epoch = 10/50:
2018-03-13 12:52:10 -- train loss = 0.0210
2018-03-13 12:52:10 -- dev loss = 0.0235
2018-03-13 12:52:10 -- train ROC AUC = 0.9848
2018-03-13 12:52:10 -- dev ROC AUC = 0.9734
2018-03-13 12:52:10 -- 
2018-03-13 12:52:10 -- Epoch = 11/50:
2018-03-13 12:53:50 -- train loss = 0.0199
2018-03-13 12:53:50 -- dev loss = 0.0217
2018-03-13 12:53:50 -- train ROC AUC = 0.9875
2018-03-13 12:53:50 -- dev ROC AUC = 0.9764
2018-03-13 12:53:50 -- New best dev ROC AUC = 0.9764
2018-03-13 12:53:50 -- Saving new best model...
2018-03-13 12:54:08 -- 
2018-03-13 12:54:08 -- Epoch = 12/50:
2018-03-13 12:55:48 -- train loss = 0.0186
2018-03-13 12:55:48 -- dev loss = 0.0216
2018-03-13 12:55:48 -- train ROC AUC = 0.9884
2018-03-13 12:55:48 -- dev ROC AUC = 0.9760
2018-03-13 12:55:48 -- 
2018-03-13 12:55:48 -- Epoch = 13/50:
2018-03-13 12:57:28 -- train loss = 0.0175
2018-03-13 12:57:28 -- dev loss = 0.0214
2018-03-13 12:57:28 -- train ROC AUC = 0.9886
2018-03-13 12:57:28 -- dev ROC AUC = 0.9764
2018-03-13 12:57:28 -- New best dev ROC AUC = 0.9764
2018-03-13 12:57:28 -- Saving new best model...
2018-03-13 12:57:46 -- 
2018-03-13 12:57:46 -- Epoch = 14/50:
2018-03-13 12:59:27 -- train loss = 0.0169
2018-03-13 12:59:27 -- dev loss = 0.0212
2018-03-13 12:59:27 -- train ROC AUC = 0.9901
2018-03-13 12:59:27 -- dev ROC AUC = 0.9767
2018-03-13 12:59:27 -- New best dev ROC AUC = 0.9767
2018-03-13 12:59:27 -- Saving new best model...
2018-03-13 12:59:45 -- 
2018-03-13 12:59:45 -- Epoch = 15/50:
2018-03-13 13:01:27 -- train loss = 0.0160
2018-03-13 13:01:27 -- dev loss = 0.0211
2018-03-13 13:01:27 -- train ROC AUC = 0.9904
2018-03-13 13:01:27 -- dev ROC AUC = 0.9770
2018-03-13 13:01:27 -- New best dev ROC AUC = 0.9770
2018-03-13 13:01:27 -- Saving new best model...
2018-03-13 13:01:51 -- 
2018-03-13 13:01:51 -- Epoch = 16/50:
2018-03-13 13:03:32 -- train loss = 0.0156
2018-03-13 13:03:32 -- dev loss = 0.0212
2018-03-13 13:03:32 -- train ROC AUC = 0.9910
2018-03-13 13:03:32 -- dev ROC AUC = 0.9768
2018-03-13 13:03:32 -- 
2018-03-13 13:03:32 -- Epoch = 17/50:
2018-03-13 13:05:13 -- train loss = 0.0151
2018-03-13 13:05:13 -- dev loss = 0.0213
2018-03-13 13:05:13 -- train ROC AUC = 0.9918
2018-03-13 13:05:13 -- dev ROC AUC = 0.9777
2018-03-13 13:05:13 -- New best dev ROC AUC = 0.9777
2018-03-13 13:05:13 -- Saving new best model...
2018-03-13 13:05:31 -- 
2018-03-13 13:05:31 -- Epoch = 18/50:
2018-03-13 13:07:13 -- train loss = 0.0144
2018-03-13 13:07:13 -- dev loss = 0.0210
2018-03-13 13:07:13 -- train ROC AUC = 0.9921
2018-03-13 13:07:13 -- dev ROC AUC = 0.9783
2018-03-13 13:07:13 -- New best dev ROC AUC = 0.9783
2018-03-13 13:07:13 -- Saving new best model...
2018-03-13 13:07:35 -- 
2018-03-13 13:07:35 -- Epoch = 19/50:
2018-03-13 13:09:18 -- train loss = 0.0137
2018-03-13 13:09:18 -- dev loss = 0.0223
2018-03-13 13:09:18 -- train ROC AUC = 0.9923
2018-03-13 13:09:18 -- dev ROC AUC = 0.9762
2018-03-13 13:09:18 -- 
2018-03-13 13:09:18 -- Epoch = 20/50:
2018-03-13 13:10:59 -- train loss = 0.0151
2018-03-13 13:10:59 -- dev loss = 0.0215
2018-03-13 13:10:59 -- train ROC AUC = 0.9912
2018-03-13 13:10:59 -- dev ROC AUC = 0.9766
2018-03-13 13:10:59 -- 
2018-03-13 13:10:59 -- Epoch = 21/50:
2018-03-13 13:12:41 -- train loss = 0.0142
2018-03-13 13:12:41 -- dev loss = 0.0219
2018-03-13 13:12:41 -- train ROC AUC = 0.9923
2018-03-13 13:12:41 -- dev ROC AUC = 0.9770
2018-03-13 13:12:41 -- 
2018-03-13 13:12:41 -- Epoch = 22/50:
2018-03-13 13:14:24 -- train loss = 0.0131
2018-03-13 13:14:24 -- dev loss = 0.0218
2018-03-13 13:14:24 -- train ROC AUC = 0.9930
2018-03-13 13:14:24 -- dev ROC AUC = 0.9775
2018-03-13 13:14:24 -- 
2018-03-13 13:14:24 -- Epoch = 23/50:
2018-03-13 13:16:06 -- train loss = 0.0125
2018-03-13 13:16:06 -- dev loss = 0.0225
2018-03-13 13:16:06 -- train ROC AUC = 0.9935
2018-03-13 13:16:06 -- dev ROC AUC = 0.9767
2018-03-13 13:16:06 -- 
2018-03-13 13:16:06 -- Epoch = 24/50:
2018-03-13 13:17:49 -- train loss = 0.0135
2018-03-13 13:17:49 -- dev loss = 0.0228
2018-03-13 13:17:49 -- train ROC AUC = 0.9912
2018-03-13 13:17:49 -- dev ROC AUC = 0.9768
2018-03-13 13:17:49 -- 
2018-03-13 13:17:49 -- Epoch = 25/50:
2018-03-13 13:19:32 -- train loss = 0.0147
2018-03-13 13:19:32 -- dev loss = 0.0221
2018-03-13 13:19:32 -- train ROC AUC = 0.9930
2018-03-13 13:19:32 -- dev ROC AUC = 0.9773
2018-03-13 13:19:32 -- 
2018-03-13 13:19:32 -- Epoch = 26/50:
2018-03-13 13:21:16 -- train loss = 0.0126
2018-03-13 13:21:16 -- dev loss = 0.0229
2018-03-13 13:21:16 -- train ROC AUC = 0.9935
2018-03-13 13:21:16 -- dev ROC AUC = 0.9763
2018-03-13 13:21:16 -- 
2018-03-13 13:21:16 -- Epoch = 27/50:
2018-03-13 13:23:00 -- train loss = 0.0122
2018-03-13 13:23:00 -- dev loss = 0.0230
2018-03-13 13:23:00 -- train ROC AUC = 0.9937
2018-03-13 13:23:00 -- dev ROC AUC = 0.9766
2018-03-13 13:23:00 -- 
2018-03-13 13:23:00 -- Epoch = 28/50:
2018-03-13 13:24:44 -- train loss = 0.0115
2018-03-13 13:24:44 -- dev loss = 0.0237
2018-03-13 13:24:44 -- train ROC AUC = 0.9941
2018-03-13 13:24:44 -- dev ROC AUC = 0.9757
2018-03-13 13:24:44 -- 
2018-03-13 13:24:44 -- Epoch = 29/50:
2018-03-13 13:26:29 -- train loss = 0.0111
2018-03-13 13:26:29 -- dev loss = 0.0240
2018-03-13 13:26:29 -- train ROC AUC = 0.9943
2018-03-13 13:26:29 -- dev ROC AUC = 0.9752
2018-03-13 13:26:29 -- 
2018-03-13 13:26:29 -- Epoch = 30/50:
2018-03-13 13:28:14 -- train loss = 0.0112
2018-03-13 13:28:14 -- dev loss = 0.0236
2018-03-13 13:28:14 -- train ROC AUC = 0.9945
2018-03-13 13:28:14 -- dev ROC AUC = 0.9760
2018-03-13 13:28:14 -- 
2018-03-13 13:28:14 -- Epoch = 31/50:
2018-03-13 13:29:59 -- train loss = 0.0105
2018-03-13 13:29:59 -- dev loss = 0.0247
2018-03-13 13:29:59 -- train ROC AUC = 0.9948
2018-03-13 13:29:59 -- dev ROC AUC = 0.9746
2018-03-13 13:29:59 -- 
2018-03-13 13:29:59 -- Epoch = 32/50:
2018-03-13 13:31:44 -- train loss = 0.0102
2018-03-13 13:31:44 -- dev loss = 0.0251
2018-03-13 13:31:44 -- train ROC AUC = 0.9949
2018-03-13 13:31:44 -- dev ROC AUC = 0.9751
2018-03-13 13:31:44 -- 
2018-03-13 13:31:44 -- Epoch = 33/50:
2018-03-13 13:33:30 -- train loss = 0.0100
2018-03-13 13:33:30 -- dev loss = 0.0258
2018-03-13 13:33:30 -- train ROC AUC = 0.9951
2018-03-13 13:33:30 -- dev ROC AUC = 0.9735
2018-03-13 13:33:30 -- 
2018-03-13 13:33:30 -- Epoch = 34/50:
2018-03-13 13:35:17 -- train loss = 0.0098
2018-03-13 13:35:17 -- dev loss = 0.0255
2018-03-13 13:35:17 -- train ROC AUC = 0.9954
2018-03-13 13:35:17 -- dev ROC AUC = 0.9741
2018-03-13 13:35:17 -- 
2018-03-13 13:35:17 -- Epoch = 35/50:
2018-03-13 13:37:03 -- train loss = 0.0094
2018-03-13 13:37:03 -- dev loss = 0.0259
2018-03-13 13:37:03 -- train ROC AUC = 0.9956
2018-03-13 13:37:03 -- dev ROC AUC = 0.9741
2018-03-13 13:37:03 -- 
2018-03-13 13:37:03 -- Epoch = 36/50:
2018-03-13 13:38:50 -- train loss = 0.0093
2018-03-13 13:38:50 -- dev loss = 0.0261
2018-03-13 13:38:50 -- train ROC AUC = 0.9957
2018-03-13 13:38:50 -- dev ROC AUC = 0.9746
2018-03-13 13:38:50 -- 
2018-03-13 13:38:50 -- Epoch = 37/50:
2018-03-13 13:40:37 -- train loss = 0.0093
2018-03-13 13:40:37 -- dev loss = 0.0264
2018-03-13 13:40:37 -- train ROC AUC = 0.9958
2018-03-13 13:40:37 -- dev ROC AUC = 0.9743
2018-03-13 13:40:37 -- 
2018-03-13 13:40:37 -- Epoch = 38/50:
2018-03-13 13:42:24 -- train loss = 0.0088
2018-03-13 13:42:24 -- dev loss = 0.0267
2018-03-13 13:42:24 -- train ROC AUC = 0.9960
2018-03-13 13:42:24 -- dev ROC AUC = 0.9737
2018-03-13 13:42:24 -- 
2018-03-13 13:42:24 -- Epoch = 39/50:
2018-03-13 13:44:12 -- train loss = 0.0087
2018-03-13 13:44:12 -- dev loss = 0.0270
2018-03-13 13:44:12 -- train ROC AUC = 0.9961
2018-03-13 13:44:12 -- dev ROC AUC = 0.9740
2018-03-13 13:44:12 -- 
2018-03-13 13:44:12 -- Epoch = 40/50:
2018-03-13 13:46:00 -- train loss = 0.0085
2018-03-13 13:46:00 -- dev loss = 0.0278
2018-03-13 13:46:00 -- train ROC AUC = 0.9962
2018-03-13 13:46:00 -- dev ROC AUC = 0.9729
2018-03-13 13:46:00 -- 
2018-03-13 13:46:00 -- Epoch = 41/50:
2018-03-13 13:47:48 -- train loss = 0.0085
2018-03-13 13:47:48 -- dev loss = 0.0280
2018-03-13 13:47:48 -- train ROC AUC = 0.9964
2018-03-13 13:47:48 -- dev ROC AUC = 0.9734
2018-03-13 13:47:48 -- 
2018-03-13 13:47:48 -- Epoch = 42/50:
2018-03-13 13:49:37 -- train loss = 0.0081
2018-03-13 13:49:37 -- dev loss = 0.0280
2018-03-13 13:49:37 -- train ROC AUC = 0.9965
2018-03-13 13:49:37 -- dev ROC AUC = 0.9738
2018-03-13 13:49:37 -- 
2018-03-13 13:49:37 -- Epoch = 43/50:
2018-03-13 13:51:26 -- train loss = 0.0080
2018-03-13 13:51:26 -- dev loss = 0.0290
2018-03-13 13:51:26 -- train ROC AUC = 0.9965
2018-03-13 13:51:26 -- dev ROC AUC = 0.9726
2018-03-13 13:51:26 -- 
2018-03-13 13:51:26 -- Epoch = 44/50:
2018-03-13 13:53:15 -- train loss = 0.0078
2018-03-13 13:53:15 -- dev loss = 0.0285
2018-03-13 13:53:15 -- train ROC AUC = 0.9967
2018-03-13 13:53:15 -- dev ROC AUC = 0.9735
2018-03-13 13:53:15 -- 
2018-03-13 13:53:15 -- Epoch = 45/50:
2018-03-13 13:55:05 -- train loss = 0.0077
2018-03-13 13:55:05 -- dev loss = 0.0293
2018-03-13 13:55:05 -- train ROC AUC = 0.9968
2018-03-13 13:55:05 -- dev ROC AUC = 0.9723
2018-03-13 13:55:05 -- 
2018-03-13 13:55:05 -- Epoch = 46/50:
2018-03-13 13:56:55 -- train loss = 0.0074
2018-03-13 13:56:55 -- dev loss = 0.0299
2018-03-13 13:56:55 -- train ROC AUC = 0.9969
2018-03-13 13:56:55 -- dev ROC AUC = 0.9722
2018-03-13 13:56:55 -- 
2018-03-13 13:56:55 -- Epoch = 47/50:
2018-03-13 13:58:46 -- train loss = 0.0073
2018-03-13 13:58:46 -- dev loss = 0.0300
2018-03-13 13:58:46 -- train ROC AUC = 0.9970
2018-03-13 13:58:46 -- dev ROC AUC = 0.9725
2018-03-13 13:58:46 -- 
2018-03-13 13:58:46 -- Epoch = 48/50:
2018-03-13 14:00:36 -- train loss = 0.0072
2018-03-13 14:00:36 -- dev loss = 0.0305
2018-03-13 14:00:36 -- train ROC AUC = 0.9971
2018-03-13 14:00:36 -- dev ROC AUC = 0.9719
2018-03-13 14:00:36 -- 
2018-03-13 14:00:36 -- Epoch = 49/50:
2018-03-13 14:02:27 -- train loss = 0.0071
2018-03-13 14:02:27 -- dev loss = 0.0307
2018-03-13 14:02:27 -- train ROC AUC = 0.9971
2018-03-13 14:02:27 -- dev ROC AUC = 0.9721
2018-03-13 14:02:27 -- 
2018-03-13 14:02:27 -- Epoch = 50/50:
2018-03-13 14:04:19 -- train loss = 0.0073
2018-03-13 14:04:19 -- dev loss = 0.0313
2018-03-13 14:04:19 -- train ROC AUC = 0.9972
2018-03-13 14:04:19 -- dev ROC AUC = 0.9712
2018-03-13 14:04:19 -- 
2018-03-13 14:04:19 -- Testing...
2018-03-13 14:04:19 -- Rebuilding model...
2018-03-13 14:04:22 -- Restoring best model...
2018-03-13 14:04:43 -- Restoring parameters from out/new_test_11/new_test_11.weights
2018-03-13 14:04:43 -- Predicting labels for test set...
2018-03-13 14:05:29 -- Saving test prediction...
2018-03-13 14:05:30 -- 
2018-03-13 14:05:30 -- Evaluating...
2018-03-13 14:05:31 -- Mean column-wise ROC AUC - train = 0.9921
2018-03-13 14:05:31 -- Mean column-wise ROC AUC - dev = 0.9783
2018-03-13 14:05:31 -- ROC AUC of toxic - train = 0.9831
2018-03-13 14:05:31 -- ROC AUC of toxic - dev = 0.9670
2018-03-13 14:05:31 -- ROC AUC of severe_toxic - train = 0.9936
2018-03-13 14:05:31 -- ROC AUC of severe_toxic - dev = 0.9893
2018-03-13 14:05:31 -- ROC AUC of obscene - train = 0.9915
2018-03-13 14:05:31 -- ROC AUC of obscene - dev = 0.9815
2018-03-13 14:05:31 -- ROC AUC of threat - train = 0.9997
2018-03-13 14:05:32 -- ROC AUC of threat - dev = 0.9792
2018-03-13 14:05:32 -- ROC AUC of insult - train = 0.9888
2018-03-13 14:05:32 -- ROC AUC of insult - dev = 0.9772
2018-03-13 14:05:32 -- ROC AUC of identity_hate - train = 0.9960
2018-03-13 14:05:32 -- ROC AUC of identity_hate - dev = 0.9757
2018-03-13 14:05:32 -- Mean column-wise average precision - train = 0.8208
2018-03-13 14:05:33 -- Mean column-wise average precision - dev = 0.6061
2018-03-13 14:05:33 -- average precision of toxic - train = 0.9090
2018-03-13 14:05:33 -- average precision of toxic - dev = 0.8446
2018-03-13 14:05:33 -- average precision of severe_toxic - train = 0.5875
2018-03-13 14:05:33 -- average precision of severe_toxic - dev = 0.4743
2018-03-13 14:05:33 -- average precision of obscene - train = 0.8988
2018-03-13 14:05:33 -- average precision of obscene - dev = 0.8379
2018-03-13 14:05:33 -- average precision of threat - train = 0.9412
2018-03-13 14:05:33 -- average precision of threat - dev = 0.3315
2018-03-13 14:05:33 -- average precision of insult - train = 0.8192
2018-03-13 14:05:33 -- average precision of insult - dev = 0.7196
2018-03-13 14:05:33 -- average precision of identity_hate - train = 0.7691
2018-03-13 14:05:33 -- average precision of identity_hate - dev = 0.4289
