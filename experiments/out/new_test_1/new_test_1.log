averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_1
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-12 18:43:28 -- 
2018-03-12 18:43:28 -- Initializing...
2018-03-12 18:43:28 -- Training...
2018-03-12 18:43:28 -- Building model...
2018-03-12 18:43:31 -- Training model...
2018-03-12 18:44:01 -- 
2018-03-12 18:44:01 -- Epoch = 1/50:
2018-03-12 18:44:56 -- train loss = 0.1714
2018-03-12 18:44:56 -- dev loss = 0.0505
2018-03-12 18:44:56 -- train ROC AUC = 0.6753
2018-03-12 18:44:56 -- dev ROC AUC = 0.6808
2018-03-12 18:44:56 -- New best dev ROC AUC = 0.6808
2018-03-12 18:44:56 -- Saving new best model...
2018-03-12 18:44:59 -- 
2018-03-12 18:44:59 -- Epoch = 2/50:
2018-03-12 18:45:51 -- train loss = 0.0575
2018-03-12 18:45:51 -- dev loss = 0.0461
2018-03-12 18:45:51 -- train ROC AUC = 0.7529
2018-03-12 18:45:51 -- dev ROC AUC = 0.7543
2018-03-12 18:45:51 -- New best dev ROC AUC = 0.7543
2018-03-12 18:45:51 -- Saving new best model...
2018-03-12 18:46:08 -- 
2018-03-12 18:46:08 -- Epoch = 3/50:
2018-03-12 18:47:01 -- train loss = 0.0509
2018-03-12 18:47:01 -- dev loss = 0.0397
2018-03-12 18:47:01 -- train ROC AUC = 0.8840
2018-03-12 18:47:01 -- dev ROC AUC = 0.8810
2018-03-12 18:47:01 -- New best dev ROC AUC = 0.8810
2018-03-12 18:47:01 -- Saving new best model...
2018-03-12 18:47:17 -- 
2018-03-12 18:47:17 -- Epoch = 4/50:
2018-03-12 18:48:11 -- train loss = 0.0424
2018-03-12 18:48:11 -- dev loss = 0.0338
2018-03-12 18:48:11 -- train ROC AUC = 0.9262
2018-03-12 18:48:11 -- dev ROC AUC = 0.9182
2018-03-12 18:48:11 -- New best dev ROC AUC = 0.9182
2018-03-12 18:48:11 -- Saving new best model...
2018-03-12 18:48:29 -- 
2018-03-12 18:48:29 -- Epoch = 5/50:
2018-03-12 18:49:23 -- train loss = 0.0359
2018-03-12 18:49:23 -- dev loss = 0.0302
2018-03-12 18:49:23 -- train ROC AUC = 0.9488
2018-03-12 18:49:23 -- dev ROC AUC = 0.9399
2018-03-12 18:49:23 -- New best dev ROC AUC = 0.9399
2018-03-12 18:49:23 -- Saving new best model...
2018-03-12 18:49:40 -- 
2018-03-12 18:49:40 -- Epoch = 6/50:
2018-03-12 18:50:35 -- train loss = 0.0342
2018-03-12 18:50:35 -- dev loss = 0.0305
2018-03-12 18:50:35 -- train ROC AUC = 0.9481
2018-03-12 18:50:35 -- dev ROC AUC = 0.9398
2018-03-12 18:50:35 -- 
2018-03-12 18:50:35 -- Epoch = 7/50:
2018-03-12 18:51:29 -- train loss = 0.0316
2018-03-12 18:51:29 -- dev loss = 0.0277
2018-03-12 18:51:29 -- train ROC AUC = 0.9626
2018-03-12 18:51:29 -- dev ROC AUC = 0.9516
2018-03-12 18:51:29 -- New best dev ROC AUC = 0.9516
2018-03-12 18:51:29 -- Saving new best model...
2018-03-12 18:51:46 -- 
2018-03-12 18:51:46 -- Epoch = 8/50:
2018-03-12 18:52:41 -- train loss = 0.0295
2018-03-12 18:52:41 -- dev loss = 0.0267
2018-03-12 18:52:41 -- train ROC AUC = 0.9682
2018-03-12 18:52:41 -- dev ROC AUC = 0.9559
2018-03-12 18:52:41 -- New best dev ROC AUC = 0.9559
2018-03-12 18:52:41 -- Saving new best model...
2018-03-12 18:53:00 -- 
2018-03-12 18:53:00 -- Epoch = 9/50:
2018-03-12 18:53:55 -- train loss = 0.0274
2018-03-12 18:53:55 -- dev loss = 0.0267
2018-03-12 18:53:55 -- train ROC AUC = 0.9704
2018-03-12 18:53:55 -- dev ROC AUC = 0.9559
2018-03-12 18:53:55 -- New best dev ROC AUC = 0.9559
2018-03-12 18:53:55 -- Saving new best model...
2018-03-12 18:54:13 -- 
2018-03-12 18:54:13 -- Epoch = 10/50:
2018-03-12 18:55:07 -- train loss = 0.0261
2018-03-12 18:55:07 -- dev loss = 0.0257
2018-03-12 18:55:07 -- train ROC AUC = 0.9748
2018-03-12 18:55:07 -- dev ROC AUC = 0.9590
2018-03-12 18:55:07 -- New best dev ROC AUC = 0.9590
2018-03-12 18:55:07 -- Saving new best model...
2018-03-12 18:55:25 -- 
2018-03-12 18:55:25 -- Epoch = 11/50:
2018-03-12 18:56:20 -- train loss = 0.0250
2018-03-12 18:56:20 -- dev loss = 0.0257
2018-03-12 18:56:20 -- train ROC AUC = 0.9767
2018-03-12 18:56:20 -- dev ROC AUC = 0.9584
2018-03-12 18:56:20 -- 
2018-03-12 18:56:20 -- Epoch = 12/50:
2018-03-12 18:57:16 -- train loss = 0.0237
2018-03-12 18:57:16 -- dev loss = 0.0254
2018-03-12 18:57:16 -- train ROC AUC = 0.9787
2018-03-12 18:57:16 -- dev ROC AUC = 0.9594
2018-03-12 18:57:16 -- New best dev ROC AUC = 0.9594
2018-03-12 18:57:16 -- Saving new best model...
2018-03-12 18:57:35 -- 
2018-03-12 18:57:35 -- Epoch = 13/50:
2018-03-12 18:58:31 -- train loss = 0.0226
2018-03-12 18:58:31 -- dev loss = 0.0257
2018-03-12 18:58:31 -- train ROC AUC = 0.9802
2018-03-12 18:58:31 -- dev ROC AUC = 0.9594
2018-03-12 18:58:31 -- 
2018-03-12 18:58:31 -- Epoch = 14/50:
2018-03-12 18:59:27 -- train loss = 0.0217
2018-03-12 18:59:27 -- dev loss = 0.0253
2018-03-12 18:59:27 -- train ROC AUC = 0.9814
2018-03-12 18:59:27 -- dev ROC AUC = 0.9606
2018-03-12 18:59:27 -- New best dev ROC AUC = 0.9606
2018-03-12 18:59:27 -- Saving new best model...
2018-03-12 18:59:44 -- 
2018-03-12 18:59:44 -- Epoch = 15/50:
2018-03-12 19:00:41 -- train loss = 0.0212
2018-03-12 19:00:41 -- dev loss = 0.0251
2018-03-12 19:00:41 -- train ROC AUC = 0.9832
2018-03-12 19:00:41 -- dev ROC AUC = 0.9610
2018-03-12 19:00:41 -- New best dev ROC AUC = 0.9610
2018-03-12 19:00:41 -- Saving new best model...
2018-03-12 19:00:58 -- 
2018-03-12 19:00:58 -- Epoch = 16/50:
2018-03-12 19:01:54 -- train loss = 0.0198
2018-03-12 19:01:54 -- dev loss = 0.0254
2018-03-12 19:01:54 -- train ROC AUC = 0.9846
2018-03-12 19:01:54 -- dev ROC AUC = 0.9609
2018-03-12 19:01:54 -- 
2018-03-12 19:01:54 -- Epoch = 17/50:
2018-03-12 19:02:51 -- train loss = 0.0201
2018-03-12 19:02:51 -- dev loss = 0.0258
2018-03-12 19:02:51 -- train ROC AUC = 0.9845
2018-03-12 19:02:51 -- dev ROC AUC = 0.9595
2018-03-12 19:02:51 -- 
2018-03-12 19:02:51 -- Epoch = 18/50:
2018-03-12 19:03:48 -- train loss = 0.0195
2018-03-12 19:03:48 -- dev loss = 0.0259
2018-03-12 19:03:48 -- train ROC AUC = 0.9859
2018-03-12 19:03:48 -- dev ROC AUC = 0.9592
2018-03-12 19:03:48 -- 
2018-03-12 19:03:48 -- Epoch = 19/50:
2018-03-12 19:04:45 -- train loss = 0.0181
2018-03-12 19:04:45 -- dev loss = 0.0262
2018-03-12 19:04:45 -- train ROC AUC = 0.9868
2018-03-12 19:04:45 -- dev ROC AUC = 0.9594
2018-03-12 19:04:45 -- 
2018-03-12 19:04:45 -- Epoch = 20/50:
2018-03-12 19:05:43 -- train loss = 0.0173
2018-03-12 19:05:43 -- dev loss = 0.0261
2018-03-12 19:05:43 -- train ROC AUC = 0.9878
2018-03-12 19:05:43 -- dev ROC AUC = 0.9600
2018-03-12 19:05:43 -- 
2018-03-12 19:05:43 -- Epoch = 21/50:
2018-03-12 19:06:41 -- train loss = 0.0169
2018-03-12 19:06:41 -- dev loss = 0.0263
2018-03-12 19:06:41 -- train ROC AUC = 0.9884
2018-03-12 19:06:41 -- dev ROC AUC = 0.9598
2018-03-12 19:06:41 -- 
2018-03-12 19:06:41 -- Epoch = 22/50:
2018-03-12 19:07:41 -- train loss = 0.0163
2018-03-12 19:07:41 -- dev loss = 0.0266
2018-03-12 19:07:41 -- train ROC AUC = 0.9884
2018-03-12 19:07:41 -- dev ROC AUC = 0.9591
2018-03-12 19:07:41 -- 
2018-03-12 19:07:41 -- Epoch = 23/50:
2018-03-12 19:08:39 -- train loss = 0.0160
2018-03-12 19:08:39 -- dev loss = 0.0266
2018-03-12 19:08:39 -- train ROC AUC = 0.9893
2018-03-12 19:08:39 -- dev ROC AUC = 0.9598
2018-03-12 19:08:39 -- 
2018-03-12 19:08:39 -- Epoch = 24/50:
2018-03-12 19:09:38 -- train loss = 0.0154
2018-03-12 19:09:38 -- dev loss = 0.0269
2018-03-12 19:09:38 -- train ROC AUC = 0.9902
2018-03-12 19:09:38 -- dev ROC AUC = 0.9596
2018-03-12 19:09:38 -- 
2018-03-12 19:09:38 -- Epoch = 25/50:
2018-03-12 19:10:37 -- train loss = 0.0151
2018-03-12 19:10:37 -- dev loss = 0.0271
2018-03-12 19:10:37 -- train ROC AUC = 0.9905
2018-03-12 19:10:37 -- dev ROC AUC = 0.9598
2018-03-12 19:10:37 -- 
2018-03-12 19:10:37 -- Epoch = 26/50:
2018-03-12 19:11:37 -- train loss = 0.0144
2018-03-12 19:11:37 -- dev loss = 0.0272
2018-03-12 19:11:37 -- train ROC AUC = 0.9911
2018-03-12 19:11:37 -- dev ROC AUC = 0.9601
2018-03-12 19:11:37 -- 
2018-03-12 19:11:37 -- Epoch = 27/50:
2018-03-12 19:12:37 -- train loss = 0.0157
2018-03-12 19:12:37 -- dev loss = 0.0285
2018-03-12 19:12:37 -- train ROC AUC = 0.9900
2018-03-12 19:12:37 -- dev ROC AUC = 0.9570
2018-03-12 19:12:37 -- 
2018-03-12 19:12:37 -- Epoch = 28/50:
2018-03-12 19:13:37 -- train loss = 0.0173
2018-03-12 19:13:37 -- dev loss = 0.0268
2018-03-12 19:13:37 -- train ROC AUC = 0.9909
2018-03-12 19:13:37 -- dev ROC AUC = 0.9590
2018-03-12 19:13:37 -- 
2018-03-12 19:13:37 -- Epoch = 29/50:
2018-03-12 19:14:37 -- train loss = 0.0147
2018-03-12 19:14:37 -- dev loss = 0.0274
2018-03-12 19:14:37 -- train ROC AUC = 0.9916
2018-03-12 19:14:37 -- dev ROC AUC = 0.9592
2018-03-12 19:14:37 -- 
2018-03-12 19:14:37 -- Epoch = 30/50:
2018-03-12 19:15:38 -- train loss = 0.0139
2018-03-12 19:15:38 -- dev loss = 0.0277
2018-03-12 19:15:38 -- train ROC AUC = 0.9921
2018-03-12 19:15:38 -- dev ROC AUC = 0.9596
2018-03-12 19:15:38 -- 
2018-03-12 19:15:38 -- Epoch = 31/50:
2018-03-12 19:16:39 -- train loss = 0.0133
2018-03-12 19:16:39 -- dev loss = 0.0279
2018-03-12 19:16:39 -- train ROC AUC = 0.9923
2018-03-12 19:16:39 -- dev ROC AUC = 0.9598
2018-03-12 19:16:39 -- 
2018-03-12 19:16:39 -- Epoch = 32/50:
2018-03-12 19:17:40 -- train loss = 0.0127
2018-03-12 19:17:40 -- dev loss = 0.0285
2018-03-12 19:17:40 -- train ROC AUC = 0.9929
2018-03-12 19:17:40 -- dev ROC AUC = 0.9595
2018-03-12 19:17:40 -- 
2018-03-12 19:17:40 -- Epoch = 33/50:
2018-03-12 19:18:42 -- train loss = 0.0125
2018-03-12 19:18:42 -- dev loss = 0.0301
2018-03-12 19:18:42 -- train ROC AUC = 0.9928
2018-03-12 19:18:42 -- dev ROC AUC = 0.9575
2018-03-12 19:18:42 -- 
2018-03-12 19:18:42 -- Epoch = 34/50:
2018-03-12 19:19:44 -- train loss = 0.0124
2018-03-12 19:19:44 -- dev loss = 0.0292
2018-03-12 19:19:44 -- train ROC AUC = 0.9934
2018-03-12 19:19:44 -- dev ROC AUC = 0.9586
2018-03-12 19:19:44 -- 
2018-03-12 19:19:44 -- Epoch = 35/50:
2018-03-12 19:20:47 -- train loss = 0.0119
2018-03-12 19:20:47 -- dev loss = 0.0295
2018-03-12 19:20:47 -- train ROC AUC = 0.9935
2018-03-12 19:20:47 -- dev ROC AUC = 0.9587
2018-03-12 19:20:47 -- 
2018-03-12 19:20:47 -- Epoch = 36/50:
2018-03-12 19:21:49 -- train loss = 0.0117
2018-03-12 19:21:49 -- dev loss = 0.0300
2018-03-12 19:21:49 -- train ROC AUC = 0.9939
2018-03-12 19:21:49 -- dev ROC AUC = 0.9586
2018-03-12 19:21:49 -- 
2018-03-12 19:21:49 -- Epoch = 37/50:
2018-03-12 19:22:52 -- train loss = 0.0113
2018-03-12 19:22:52 -- dev loss = 0.0303
2018-03-12 19:22:52 -- train ROC AUC = 0.9941
2018-03-12 19:22:52 -- dev ROC AUC = 0.9585
2018-03-12 19:22:52 -- 
2018-03-12 19:22:52 -- Epoch = 38/50:
2018-03-12 19:23:55 -- train loss = 0.0111
2018-03-12 19:23:55 -- dev loss = 0.0309
2018-03-12 19:23:55 -- train ROC AUC = 0.9943
2018-03-12 19:23:55 -- dev ROC AUC = 0.9577
2018-03-12 19:23:55 -- 
2018-03-12 19:23:55 -- Epoch = 39/50:
2018-03-12 19:24:58 -- train loss = 0.0108
2018-03-12 19:24:58 -- dev loss = 0.0309
2018-03-12 19:24:58 -- train ROC AUC = 0.9946
2018-03-12 19:24:58 -- dev ROC AUC = 0.9585
2018-03-12 19:24:58 -- 
2018-03-12 19:24:58 -- Epoch = 40/50:
2018-03-12 19:26:02 -- train loss = 0.0113
2018-03-12 19:26:02 -- dev loss = 0.0309
2018-03-12 19:26:02 -- train ROC AUC = 0.9940
2018-03-12 19:26:02 -- dev ROC AUC = 0.9586
2018-03-12 19:26:02 -- 
2018-03-12 19:26:02 -- Epoch = 41/50:
2018-03-12 19:27:06 -- train loss = 0.0107
2018-03-12 19:27:06 -- dev loss = 0.0312
2018-03-12 19:27:06 -- train ROC AUC = 0.9948
2018-03-12 19:27:06 -- dev ROC AUC = 0.9574
2018-03-12 19:27:06 -- 
2018-03-12 19:27:06 -- Epoch = 42/50:
2018-03-12 19:28:10 -- train loss = 0.0103
2018-03-12 19:28:10 -- dev loss = 0.0318
2018-03-12 19:28:10 -- train ROC AUC = 0.9950
2018-03-12 19:28:10 -- dev ROC AUC = 0.9577
2018-03-12 19:28:10 -- 
2018-03-12 19:28:10 -- Epoch = 43/50:
2018-03-12 19:29:15 -- train loss = 0.0100
2018-03-12 19:29:15 -- dev loss = 0.0323
2018-03-12 19:29:15 -- train ROC AUC = 0.9951
2018-03-12 19:29:15 -- dev ROC AUC = 0.9570
2018-03-12 19:29:15 -- 
2018-03-12 19:29:15 -- Epoch = 44/50:
2018-03-12 19:30:20 -- train loss = 0.0099
2018-03-12 19:30:20 -- dev loss = 0.0328
2018-03-12 19:30:20 -- train ROC AUC = 0.9953
2018-03-12 19:30:20 -- dev ROC AUC = 0.9572
2018-03-12 19:30:20 -- 
2018-03-12 19:30:20 -- Epoch = 45/50:
2018-03-12 19:31:25 -- train loss = 0.0096
2018-03-12 19:31:25 -- dev loss = 0.0330
2018-03-12 19:31:25 -- train ROC AUC = 0.9954
2018-03-12 19:31:25 -- dev ROC AUC = 0.9565
2018-03-12 19:31:25 -- 
2018-03-12 19:31:25 -- Epoch = 46/50:
2018-03-12 19:32:31 -- train loss = 0.0103
2018-03-12 19:32:31 -- dev loss = 0.0331
2018-03-12 19:32:31 -- train ROC AUC = 0.9954
2018-03-12 19:32:31 -- dev ROC AUC = 0.9565
2018-03-12 19:32:31 -- 
2018-03-12 19:32:31 -- Epoch = 47/50:
2018-03-12 19:33:37 -- train loss = 0.0096
2018-03-12 19:33:37 -- dev loss = 0.0332
2018-03-12 19:33:37 -- train ROC AUC = 0.9955
2018-03-12 19:33:37 -- dev ROC AUC = 0.9563
2018-03-12 19:33:37 -- 
2018-03-12 19:33:37 -- Epoch = 48/50:
2018-03-12 19:34:44 -- train loss = 0.0093
2018-03-12 19:34:44 -- dev loss = 0.0338
2018-03-12 19:34:44 -- train ROC AUC = 0.9957
2018-03-12 19:34:44 -- dev ROC AUC = 0.9560
2018-03-12 19:34:44 -- 
2018-03-12 19:34:44 -- Epoch = 49/50:
2018-03-12 19:35:51 -- train loss = 0.0093
2018-03-12 19:35:51 -- dev loss = 0.0347
2018-03-12 19:35:51 -- train ROC AUC = 0.9958
2018-03-12 19:35:51 -- dev ROC AUC = 0.9558
2018-03-12 19:35:51 -- 
2018-03-12 19:35:51 -- Epoch = 50/50:
2018-03-12 19:36:58 -- train loss = 0.0089
2018-03-12 19:36:58 -- dev loss = 0.0353
2018-03-12 19:36:58 -- train ROC AUC = 0.9960
2018-03-12 19:36:58 -- dev ROC AUC = 0.9563
2018-03-12 19:36:58 -- 
2018-03-12 19:36:58 -- Testing...
2018-03-12 19:36:58 -- Rebuilding model...
2018-03-12 19:36:59 -- Restoring best model...
2018-03-12 19:37:08 -- Restoring parameters from out/new_test_1/new_test_1.weights
2018-03-12 19:37:08 -- Predicting labels for test set...
2018-03-12 19:37:40 -- Saving test prediction...
2018-03-12 19:37:41 -- 
2018-03-12 19:37:41 -- Evaluating...
2018-03-12 19:37:42 -- Mean column-wise ROC AUC - train = 0.9832
2018-03-12 19:37:43 -- Mean column-wise ROC AUC - dev = 0.9610
2018-03-12 19:37:43 -- ROC AUC of toxic - train = 0.9668
2018-03-12 19:37:43 -- ROC AUC of toxic - dev = 0.9441
2018-03-12 19:37:43 -- ROC AUC of severe_toxic - train = 0.9908
2018-03-12 19:37:43 -- ROC AUC of severe_toxic - dev = 0.9839
2018-03-12 19:37:43 -- ROC AUC of obscene - train = 0.9792
2018-03-12 19:37:43 -- ROC AUC of obscene - dev = 0.9599
2018-03-12 19:37:43 -- ROC AUC of threat - train = 0.9964
2018-03-12 19:37:43 -- ROC AUC of threat - dev = 0.9711
2018-03-12 19:37:43 -- ROC AUC of insult - train = 0.9796
2018-03-12 19:37:43 -- ROC AUC of insult - dev = 0.9585
2018-03-12 19:37:43 -- ROC AUC of identity_hate - train = 0.9864
2018-03-12 19:37:43 -- ROC AUC of identity_hate - dev = 0.9486
2018-03-12 19:37:44 -- Mean column-wise average precision - train = 0.6941
2018-03-12 19:37:44 -- Mean column-wise average precision - dev = 0.5009
2018-03-12 19:37:44 -- average precision of toxic - train = 0.8379
2018-03-12 19:37:44 -- average precision of toxic - dev = 0.7417
2018-03-12 19:37:44 -- average precision of severe_toxic - train = 0.5269
2018-03-12 19:37:44 -- average precision of severe_toxic - dev = 0.4297
2018-03-12 19:37:44 -- average precision of obscene - train = 0.8025
2018-03-12 19:37:44 -- average precision of obscene - dev = 0.7049
2018-03-12 19:37:44 -- average precision of threat - train = 0.7569
2018-03-12 19:37:45 -- average precision of threat - dev = 0.2942
2018-03-12 19:37:45 -- average precision of insult - train = 0.7524
2018-03-12 19:37:45 -- average precision of insult - dev = 0.6375
2018-03-12 19:37:45 -- average precision of identity_hate - train = 0.4880
2018-03-12 19:37:45 -- average precision of identity_hate - dev = 0.1973
