averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: GRU
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_6
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-13 01:39:37 -- 
2018-03-13 01:39:37 -- Initializing...
2018-03-13 01:39:37 -- Training...
2018-03-13 01:39:37 -- Building model...
2018-03-13 01:39:38 -- Training model...
2018-03-13 01:39:57 -- 
2018-03-13 01:39:57 -- Epoch = 1/50:
2018-03-13 01:40:58 -- train loss = 0.1857
2018-03-13 01:40:58 -- dev loss = 0.0526
2018-03-13 01:40:58 -- train ROC AUC = 0.6914
2018-03-13 01:40:58 -- dev ROC AUC = 0.6962
2018-03-13 01:40:58 -- New best dev ROC AUC = 0.6962
2018-03-13 01:40:58 -- Saving new best model...
2018-03-13 01:41:00 -- 
2018-03-13 01:41:00 -- Epoch = 2/50:
2018-03-13 01:42:01 -- train loss = 0.0597
2018-03-13 01:42:01 -- dev loss = 0.0452
2018-03-13 01:42:01 -- train ROC AUC = 0.8063
2018-03-13 01:42:01 -- dev ROC AUC = 0.8061
2018-03-13 01:42:01 -- New best dev ROC AUC = 0.8061
2018-03-13 01:42:01 -- Saving new best model...
2018-03-13 01:42:19 -- 
2018-03-13 01:42:19 -- Epoch = 3/50:
2018-03-13 01:43:21 -- train loss = 0.0506
2018-03-13 01:43:21 -- dev loss = 0.0386
2018-03-13 01:43:21 -- train ROC AUC = 0.9158
2018-03-13 01:43:21 -- dev ROC AUC = 0.9112
2018-03-13 01:43:21 -- New best dev ROC AUC = 0.9112
2018-03-13 01:43:21 -- Saving new best model...
2018-03-13 01:43:39 -- 
2018-03-13 01:43:39 -- Epoch = 4/50:
2018-03-13 01:44:41 -- train loss = 0.0421
2018-03-13 01:44:41 -- dev loss = 0.0339
2018-03-13 01:44:41 -- train ROC AUC = 0.9450
2018-03-13 01:44:41 -- dev ROC AUC = 0.9389
2018-03-13 01:44:41 -- New best dev ROC AUC = 0.9389
2018-03-13 01:44:41 -- Saving new best model...
2018-03-13 01:44:59 -- 
2018-03-13 01:44:59 -- Epoch = 5/50:
2018-03-13 01:46:01 -- train loss = 0.0369
2018-03-13 01:46:01 -- dev loss = 0.0308
2018-03-13 01:46:01 -- train ROC AUC = 0.9565
2018-03-13 01:46:01 -- dev ROC AUC = 0.9495
2018-03-13 01:46:01 -- New best dev ROC AUC = 0.9495
2018-03-13 01:46:01 -- Saving new best model...
2018-03-13 01:46:19 -- 
2018-03-13 01:46:19 -- Epoch = 6/50:
2018-03-13 01:47:21 -- train loss = 0.0330
2018-03-13 01:47:21 -- dev loss = 0.0285
2018-03-13 01:47:21 -- train ROC AUC = 0.9639
2018-03-13 01:47:21 -- dev ROC AUC = 0.9555
2018-03-13 01:47:21 -- New best dev ROC AUC = 0.9555
2018-03-13 01:47:21 -- Saving new best model...
2018-03-13 01:47:40 -- 
2018-03-13 01:47:40 -- Epoch = 7/50:
2018-03-13 01:48:42 -- train loss = 0.0300
2018-03-13 01:48:42 -- dev loss = 0.0266
2018-03-13 01:48:42 -- train ROC AUC = 0.9700
2018-03-13 01:48:42 -- dev ROC AUC = 0.9602
2018-03-13 01:48:42 -- New best dev ROC AUC = 0.9602
2018-03-13 01:48:42 -- Saving new best model...
2018-03-13 01:49:00 -- 
2018-03-13 01:49:00 -- Epoch = 8/50:
2018-03-13 01:50:02 -- train loss = 0.0275
2018-03-13 01:50:02 -- dev loss = 0.0255
2018-03-13 01:50:02 -- train ROC AUC = 0.9730
2018-03-13 01:50:02 -- dev ROC AUC = 0.9615
2018-03-13 01:50:02 -- New best dev ROC AUC = 0.9615
2018-03-13 01:50:02 -- Saving new best model...
2018-03-13 01:50:21 -- 
2018-03-13 01:50:21 -- Epoch = 9/50:
2018-03-13 01:51:24 -- train loss = 0.0257
2018-03-13 01:51:24 -- dev loss = 0.0248
2018-03-13 01:51:24 -- train ROC AUC = 0.9770
2018-03-13 01:51:24 -- dev ROC AUC = 0.9644
2018-03-13 01:51:24 -- New best dev ROC AUC = 0.9644
2018-03-13 01:51:24 -- Saving new best model...
2018-03-13 01:51:43 -- 
2018-03-13 01:51:43 -- Epoch = 10/50:
2018-03-13 01:52:46 -- train loss = 0.0240
2018-03-13 01:52:46 -- dev loss = 0.0243
2018-03-13 01:52:46 -- train ROC AUC = 0.9795
2018-03-13 01:52:46 -- dev ROC AUC = 0.9655
2018-03-13 01:52:46 -- New best dev ROC AUC = 0.9655
2018-03-13 01:52:46 -- Saving new best model...
2018-03-13 01:53:01 -- 
2018-03-13 01:53:01 -- Epoch = 11/50:
2018-03-13 01:54:05 -- train loss = 0.0227
2018-03-13 01:54:05 -- dev loss = 0.0241
2018-03-13 01:54:05 -- train ROC AUC = 0.9816
2018-03-13 01:54:05 -- dev ROC AUC = 0.9659
2018-03-13 01:54:05 -- New best dev ROC AUC = 0.9659
2018-03-13 01:54:05 -- Saving new best model...
2018-03-13 01:54:23 -- 
2018-03-13 01:54:23 -- Epoch = 12/50:
2018-03-13 01:55:27 -- train loss = 0.0215
2018-03-13 01:55:27 -- dev loss = 0.0243
2018-03-13 01:55:27 -- train ROC AUC = 0.9828
2018-03-13 01:55:27 -- dev ROC AUC = 0.9654
2018-03-13 01:55:27 -- 
2018-03-13 01:55:27 -- Epoch = 13/50:
2018-03-13 01:56:31 -- train loss = 0.0203
2018-03-13 01:56:31 -- dev loss = 0.0241
2018-03-13 01:56:31 -- train ROC AUC = 0.9844
2018-03-13 01:56:31 -- dev ROC AUC = 0.9653
2018-03-13 01:56:31 -- 
2018-03-13 01:56:31 -- Epoch = 14/50:
2018-03-13 01:57:34 -- train loss = 0.0195
2018-03-13 01:57:34 -- dev loss = 0.0247
2018-03-13 01:57:34 -- train ROC AUC = 0.9852
2018-03-13 01:57:34 -- dev ROC AUC = 0.9637
2018-03-13 01:57:34 -- 
2018-03-13 01:57:34 -- Epoch = 15/50:
2018-03-13 01:58:39 -- train loss = 0.0184
2018-03-13 01:58:39 -- dev loss = 0.0244
2018-03-13 01:58:39 -- train ROC AUC = 0.9864
2018-03-13 01:58:39 -- dev ROC AUC = 0.9646
2018-03-13 01:58:39 -- 
2018-03-13 01:58:39 -- Epoch = 16/50:
2018-03-13 01:59:43 -- train loss = 0.0176
2018-03-13 01:59:43 -- dev loss = 0.0244
2018-03-13 01:59:43 -- train ROC AUC = 0.9878
2018-03-13 01:59:43 -- dev ROC AUC = 0.9648
2018-03-13 01:59:43 -- 
2018-03-13 01:59:43 -- Epoch = 17/50:
2018-03-13 02:00:48 -- train loss = 0.0169
2018-03-13 02:00:48 -- dev loss = 0.0247
2018-03-13 02:00:48 -- train ROC AUC = 0.9885
2018-03-13 02:00:48 -- dev ROC AUC = 0.9645
2018-03-13 02:00:48 -- 
2018-03-13 02:00:48 -- Epoch = 18/50:
2018-03-13 02:01:53 -- train loss = 0.0163
2018-03-13 02:01:53 -- dev loss = 0.0250
2018-03-13 02:01:53 -- train ROC AUC = 0.9891
2018-03-13 02:01:53 -- dev ROC AUC = 0.9639
2018-03-13 02:01:53 -- 
2018-03-13 02:01:53 -- Epoch = 19/50:
2018-03-13 02:02:58 -- train loss = 0.0156
2018-03-13 02:02:58 -- dev loss = 0.0252
2018-03-13 02:02:58 -- train ROC AUC = 0.9898
2018-03-13 02:02:58 -- dev ROC AUC = 0.9638
2018-03-13 02:02:58 -- 
2018-03-13 02:02:58 -- Epoch = 20/50:
2018-03-13 02:04:04 -- train loss = 0.0150
2018-03-13 02:04:04 -- dev loss = 0.0255
2018-03-13 02:04:04 -- train ROC AUC = 0.9903
2018-03-13 02:04:04 -- dev ROC AUC = 0.9642
2018-03-13 02:04:04 -- 
2018-03-13 02:04:04 -- Epoch = 21/50:
2018-03-13 02:05:10 -- train loss = 0.0146
2018-03-13 02:05:10 -- dev loss = 0.0261
2018-03-13 02:05:10 -- train ROC AUC = 0.9905
2018-03-13 02:05:10 -- dev ROC AUC = 0.9630
2018-03-13 02:05:10 -- 
2018-03-13 02:05:10 -- Epoch = 22/50:
2018-03-13 02:06:16 -- train loss = 0.0142
2018-03-13 02:06:16 -- dev loss = 0.0257
2018-03-13 02:06:16 -- train ROC AUC = 0.9913
2018-03-13 02:06:16 -- dev ROC AUC = 0.9636
2018-03-13 02:06:16 -- 
2018-03-13 02:06:16 -- Epoch = 23/50:
2018-03-13 02:07:22 -- train loss = 0.0136
2018-03-13 02:07:22 -- dev loss = 0.0264
2018-03-13 02:07:22 -- train ROC AUC = 0.9918
2018-03-13 02:07:22 -- dev ROC AUC = 0.9629
2018-03-13 02:07:22 -- 
2018-03-13 02:07:22 -- Epoch = 24/50:
2018-03-13 02:08:31 -- train loss = 0.0134
2018-03-13 02:08:31 -- dev loss = 0.0264
2018-03-13 02:08:31 -- train ROC AUC = 0.9921
2018-03-13 02:08:31 -- dev ROC AUC = 0.9629
2018-03-13 02:08:31 -- 
2018-03-13 02:08:31 -- Epoch = 25/50:
2018-03-13 02:09:38 -- train loss = 0.0129
2018-03-13 02:09:38 -- dev loss = 0.0267
2018-03-13 02:09:38 -- train ROC AUC = 0.9923
2018-03-13 02:09:38 -- dev ROC AUC = 0.9630
2018-03-13 02:09:38 -- 
2018-03-13 02:09:38 -- Epoch = 26/50:
2018-03-13 02:10:46 -- train loss = 0.0126
2018-03-13 02:10:46 -- dev loss = 0.0274
2018-03-13 02:10:46 -- train ROC AUC = 0.9926
2018-03-13 02:10:46 -- dev ROC AUC = 0.9621
2018-03-13 02:10:46 -- 
2018-03-13 02:10:46 -- Epoch = 27/50:
2018-03-13 02:11:53 -- train loss = 0.0124
2018-03-13 02:11:53 -- dev loss = 0.0269
2018-03-13 02:11:53 -- train ROC AUC = 0.9930
2018-03-13 02:11:53 -- dev ROC AUC = 0.9627
2018-03-13 02:11:53 -- 
2018-03-13 02:11:53 -- Epoch = 28/50:
2018-03-13 02:13:02 -- train loss = 0.0119
2018-03-13 02:13:02 -- dev loss = 0.0273
2018-03-13 02:13:02 -- train ROC AUC = 0.9933
2018-03-13 02:13:02 -- dev ROC AUC = 0.9625
2018-03-13 02:13:02 -- 
2018-03-13 02:13:02 -- Epoch = 29/50:
2018-03-13 02:14:11 -- train loss = 0.0115
2018-03-13 02:14:11 -- dev loss = 0.0280
2018-03-13 02:14:11 -- train ROC AUC = 0.9934
2018-03-13 02:14:11 -- dev ROC AUC = 0.9618
2018-03-13 02:14:11 -- 
2018-03-13 02:14:11 -- Epoch = 30/50:
2018-03-13 02:15:20 -- train loss = 0.0112
2018-03-13 02:15:20 -- dev loss = 0.0280
2018-03-13 02:15:20 -- train ROC AUC = 0.9937
2018-03-13 02:15:20 -- dev ROC AUC = 0.9617
2018-03-13 02:15:20 -- 
2018-03-13 02:15:20 -- Epoch = 31/50:
2018-03-13 02:16:28 -- train loss = 0.0111
2018-03-13 02:16:28 -- dev loss = 0.0280
2018-03-13 02:16:28 -- train ROC AUC = 0.9940
2018-03-13 02:16:28 -- dev ROC AUC = 0.9617
2018-03-13 02:16:28 -- 
2018-03-13 02:16:28 -- Epoch = 32/50:
2018-03-13 02:17:38 -- train loss = 0.0109
2018-03-13 02:17:38 -- dev loss = 0.0287
2018-03-13 02:17:38 -- train ROC AUC = 0.9941
2018-03-13 02:17:38 -- dev ROC AUC = 0.9614
2018-03-13 02:17:38 -- 
2018-03-13 02:17:38 -- Epoch = 33/50:
2018-03-13 02:18:47 -- train loss = 0.0107
2018-03-13 02:18:47 -- dev loss = 0.0291
2018-03-13 02:18:47 -- train ROC AUC = 0.9944
2018-03-13 02:18:47 -- dev ROC AUC = 0.9613
2018-03-13 02:18:47 -- 
2018-03-13 02:18:47 -- Epoch = 34/50:
2018-03-13 02:19:57 -- train loss = 0.0103
2018-03-13 02:19:57 -- dev loss = 0.0296
2018-03-13 02:19:57 -- train ROC AUC = 0.9946
2018-03-13 02:19:57 -- dev ROC AUC = 0.9611
2018-03-13 02:19:57 -- 
2018-03-13 02:19:57 -- Epoch = 35/50:
2018-03-13 02:21:08 -- train loss = 0.0099
2018-03-13 02:21:08 -- dev loss = 0.0298
2018-03-13 02:21:08 -- train ROC AUC = 0.9947
2018-03-13 02:21:08 -- dev ROC AUC = 0.9607
2018-03-13 02:21:08 -- 
2018-03-13 02:21:08 -- Epoch = 36/50:
2018-03-13 02:22:18 -- train loss = 0.0099
2018-03-13 02:22:18 -- dev loss = 0.0301
2018-03-13 02:22:18 -- train ROC AUC = 0.9949
2018-03-13 02:22:18 -- dev ROC AUC = 0.9607
2018-03-13 02:22:18 -- 
2018-03-13 02:22:18 -- Epoch = 37/50:
2018-03-13 02:23:29 -- train loss = 0.0097
2018-03-13 02:23:29 -- dev loss = 0.0301
2018-03-13 02:23:29 -- train ROC AUC = 0.9950
2018-03-13 02:23:29 -- dev ROC AUC = 0.9604
2018-03-13 02:23:29 -- 
2018-03-13 02:23:29 -- Epoch = 38/50:
2018-03-13 02:24:41 -- train loss = 0.0095
2018-03-13 02:24:41 -- dev loss = 0.0308
2018-03-13 02:24:41 -- train ROC AUC = 0.9951
2018-03-13 02:24:41 -- dev ROC AUC = 0.9598
2018-03-13 02:24:41 -- 
2018-03-13 02:24:41 -- Epoch = 39/50:
2018-03-13 02:25:52 -- train loss = 0.0093
2018-03-13 02:25:52 -- dev loss = 0.0308
2018-03-13 02:25:52 -- train ROC AUC = 0.9954
2018-03-13 02:25:52 -- dev ROC AUC = 0.9602
2018-03-13 02:25:52 -- 
2018-03-13 02:25:52 -- Epoch = 40/50:
2018-03-13 02:27:05 -- train loss = 0.0089
2018-03-13 02:27:05 -- dev loss = 0.0316
2018-03-13 02:27:05 -- train ROC AUC = 0.9955
2018-03-13 02:27:05 -- dev ROC AUC = 0.9596
2018-03-13 02:27:05 -- 
2018-03-13 02:27:05 -- Epoch = 41/50:
2018-03-13 02:28:17 -- train loss = 0.0088
2018-03-13 02:28:17 -- dev loss = 0.0323
2018-03-13 02:28:17 -- train ROC AUC = 0.9955
2018-03-13 02:28:17 -- dev ROC AUC = 0.9594
2018-03-13 02:28:17 -- 
2018-03-13 02:28:17 -- Epoch = 42/50:
2018-03-13 02:29:30 -- train loss = 0.0087
2018-03-13 02:29:30 -- dev loss = 0.0326
2018-03-13 02:29:30 -- train ROC AUC = 0.9956
2018-03-13 02:29:30 -- dev ROC AUC = 0.9595
2018-03-13 02:29:30 -- 
2018-03-13 02:29:30 -- Epoch = 43/50:
2018-03-13 02:30:43 -- train loss = 0.0088
2018-03-13 02:30:43 -- dev loss = 0.0326
2018-03-13 02:30:43 -- train ROC AUC = 0.9956
2018-03-13 02:30:43 -- dev ROC AUC = 0.9594
2018-03-13 02:30:43 -- 
2018-03-13 02:30:43 -- Epoch = 44/50:
2018-03-13 02:31:56 -- train loss = 0.0085
2018-03-13 02:31:56 -- dev loss = 0.0327
2018-03-13 02:31:56 -- train ROC AUC = 0.9955
2018-03-13 02:31:56 -- dev ROC AUC = 0.9590
2018-03-13 02:31:56 -- 
2018-03-13 02:31:56 -- Epoch = 45/50:
2018-03-13 02:33:10 -- train loss = 0.0083
2018-03-13 02:33:10 -- dev loss = 0.0333
2018-03-13 02:33:10 -- train ROC AUC = 0.9960
2018-03-13 02:33:10 -- dev ROC AUC = 0.9593
2018-03-13 02:33:10 -- 
2018-03-13 02:33:10 -- Epoch = 46/50:
2018-03-13 02:34:24 -- train loss = 0.0079
2018-03-13 02:34:24 -- dev loss = 0.0336
2018-03-13 02:34:24 -- train ROC AUC = 0.9961
2018-03-13 02:34:24 -- dev ROC AUC = 0.9589
2018-03-13 02:34:24 -- 
2018-03-13 02:34:24 -- Epoch = 47/50:
2018-03-13 02:35:38 -- train loss = 0.0078
2018-03-13 02:35:38 -- dev loss = 0.0342
2018-03-13 02:35:38 -- train ROC AUC = 0.9963
2018-03-13 02:35:38 -- dev ROC AUC = 0.9588
2018-03-13 02:35:38 -- 
2018-03-13 02:35:38 -- Epoch = 48/50:
2018-03-13 02:36:53 -- train loss = 0.0076
2018-03-13 02:36:53 -- dev loss = 0.0345
2018-03-13 02:36:53 -- train ROC AUC = 0.9964
2018-03-13 02:36:53 -- dev ROC AUC = 0.9586
2018-03-13 02:36:53 -- 
2018-03-13 02:36:53 -- Epoch = 49/50:
2018-03-13 02:38:08 -- train loss = 0.0077
2018-03-13 02:38:08 -- dev loss = 0.0351
2018-03-13 02:38:08 -- train ROC AUC = 0.9965
2018-03-13 02:38:08 -- dev ROC AUC = 0.9581
2018-03-13 02:38:08 -- 
2018-03-13 02:38:08 -- Epoch = 50/50:
2018-03-13 02:39:23 -- train loss = 0.0074
2018-03-13 02:39:23 -- dev loss = 0.0354
2018-03-13 02:39:23 -- train ROC AUC = 0.9966
2018-03-13 02:39:23 -- dev ROC AUC = 0.9582
2018-03-13 02:39:23 -- 
2018-03-13 02:39:23 -- Testing...
2018-03-13 02:39:23 -- Rebuilding model...
2018-03-13 02:39:24 -- Restoring best model...
2018-03-13 02:39:33 -- Restoring parameters from out/new_test_6/new_test_6.weights
2018-03-13 02:39:34 -- Predicting labels for test set...
2018-03-13 02:40:08 -- Saving test prediction...
2018-03-13 02:40:09 -- 
2018-03-13 02:40:09 -- Evaluating...
2018-03-13 02:40:10 -- Mean column-wise ROC AUC - train = 0.9816
2018-03-13 02:40:10 -- Mean column-wise ROC AUC - dev = 0.9659
2018-03-13 02:40:10 -- ROC AUC of toxic - train = 0.9636
2018-03-13 02:40:10 -- ROC AUC of toxic - dev = 0.9446
2018-03-13 02:40:10 -- ROC AUC of severe_toxic - train = 0.9886
2018-03-13 02:40:10 -- ROC AUC of severe_toxic - dev = 0.9845
2018-03-13 02:40:10 -- ROC AUC of obscene - train = 0.9784
2018-03-13 02:40:10 -- ROC AUC of obscene - dev = 0.9649
2018-03-13 02:40:10 -- ROC AUC of threat - train = 0.9949
2018-03-13 02:40:10 -- ROC AUC of threat - dev = 0.9780
2018-03-13 02:40:11 -- ROC AUC of insult - train = 0.9776
2018-03-13 02:40:11 -- ROC AUC of insult - dev = 0.9647
2018-03-13 02:40:11 -- ROC AUC of identity_hate - train = 0.9867
2018-03-13 02:40:11 -- ROC AUC of identity_hate - dev = 0.9589
2018-03-13 02:40:11 -- Mean column-wise average precision - train = 0.6684
2018-03-13 02:40:11 -- Mean column-wise average precision - dev = 0.5180
2018-03-13 02:40:12 -- average precision of toxic - train = 0.8423
2018-03-13 02:40:12 -- average precision of toxic - dev = 0.7794
2018-03-13 02:40:12 -- average precision of severe_toxic - train = 0.4562
2018-03-13 02:40:12 -- average precision of severe_toxic - dev = 0.3884
2018-03-13 02:40:12 -- average precision of obscene - train = 0.8021
2018-03-13 02:40:12 -- average precision of obscene - dev = 0.7283
2018-03-13 02:40:12 -- average precision of threat - train = 0.6658
2018-03-13 02:40:12 -- average precision of threat - dev = 0.2979
2018-03-13 02:40:12 -- average precision of insult - train = 0.7386
2018-03-13 02:40:12 -- average precision of insult - dev = 0.6480
2018-03-13 02:40:12 -- average precision of identity_hate - train = 0.5051
2018-03-13 02:40:12 -- average precision of identity_hate - dev = 0.2657
