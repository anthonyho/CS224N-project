averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_5
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 2
state_size: 50
2018-03-12 23:23:30 -- 
2018-03-12 23:23:30 -- Initializing...
2018-03-12 23:23:30 -- Training...
2018-03-12 23:23:30 -- Building model...
2018-03-12 23:23:34 -- Training model...
2018-03-12 23:23:51 -- 
2018-03-12 23:23:51 -- Epoch = 1/50:
2018-03-12 23:26:22 -- train loss = 0.1320
2018-03-12 23:26:22 -- dev loss = 0.0479
2018-03-12 23:26:22 -- train ROC AUC = 0.6717
2018-03-12 23:26:22 -- dev ROC AUC = 0.6754
2018-03-12 23:26:22 -- New best dev ROC AUC = 0.6754
2018-03-12 23:26:22 -- Saving new best model...
2018-03-12 23:26:24 -- 
2018-03-12 23:26:24 -- Epoch = 2/50:
2018-03-12 23:28:55 -- train loss = 0.0559
2018-03-12 23:28:55 -- dev loss = 0.0449
2018-03-12 23:28:55 -- train ROC AUC = 0.8016
2018-03-12 23:28:55 -- dev ROC AUC = 0.8020
2018-03-12 23:28:55 -- New best dev ROC AUC = 0.8020
2018-03-12 23:28:55 -- Saving new best model...
2018-03-12 23:29:12 -- 
2018-03-12 23:29:12 -- Epoch = 3/50:
2018-03-12 23:31:43 -- train loss = 0.0453
2018-03-12 23:31:43 -- dev loss = 0.0319
2018-03-12 23:31:43 -- train ROC AUC = 0.9408
2018-03-12 23:31:43 -- dev ROC AUC = 0.9362
2018-03-12 23:31:43 -- New best dev ROC AUC = 0.9362
2018-03-12 23:31:43 -- Saving new best model...
2018-03-12 23:32:01 -- 
2018-03-12 23:32:01 -- Epoch = 4/50:
2018-03-12 23:34:33 -- train loss = 0.0339
2018-03-12 23:34:33 -- dev loss = 0.0271
2018-03-12 23:34:33 -- train ROC AUC = 0.9672
2018-03-12 23:34:33 -- dev ROC AUC = 0.9615
2018-03-12 23:34:33 -- New best dev ROC AUC = 0.9615
2018-03-12 23:34:33 -- Saving new best model...
2018-03-12 23:34:51 -- 
2018-03-12 23:34:51 -- Epoch = 5/50:
2018-03-12 23:37:22 -- train loss = 0.0292
2018-03-12 23:37:22 -- dev loss = 0.0251
2018-03-12 23:37:22 -- train ROC AUC = 0.9755
2018-03-12 23:37:22 -- dev ROC AUC = 0.9684
2018-03-12 23:37:22 -- New best dev ROC AUC = 0.9684
2018-03-12 23:37:22 -- Saving new best model...
2018-03-12 23:37:41 -- 
2018-03-12 23:37:41 -- Epoch = 6/50:
2018-03-12 23:40:12 -- train loss = 0.0281
2018-03-12 23:40:12 -- dev loss = 0.0243
2018-03-12 23:40:12 -- train ROC AUC = 0.9764
2018-03-12 23:40:12 -- dev ROC AUC = 0.9681
2018-03-12 23:40:12 -- 
2018-03-12 23:40:12 -- Epoch = 7/50:
2018-03-12 23:42:44 -- train loss = 0.0246
2018-03-12 23:42:44 -- dev loss = 0.0233
2018-03-12 23:42:44 -- train ROC AUC = 0.9791
2018-03-12 23:42:44 -- dev ROC AUC = 0.9689
2018-03-12 23:42:44 -- New best dev ROC AUC = 0.9689
2018-03-12 23:42:44 -- Saving new best model...
2018-03-12 23:43:03 -- 
2018-03-12 23:43:03 -- Epoch = 8/50:
2018-03-12 23:45:35 -- train loss = 0.0230
2018-03-12 23:45:35 -- dev loss = 0.0232
2018-03-12 23:45:35 -- train ROC AUC = 0.9778
2018-03-12 23:45:35 -- dev ROC AUC = 0.9645
2018-03-12 23:45:35 -- 
2018-03-12 23:45:35 -- Epoch = 9/50:
2018-03-12 23:48:08 -- train loss = 0.0210
2018-03-12 23:48:08 -- dev loss = 0.0227
2018-03-12 23:48:08 -- train ROC AUC = 0.9848
2018-03-12 23:48:08 -- dev ROC AUC = 0.9731
2018-03-12 23:48:08 -- New best dev ROC AUC = 0.9731
2018-03-12 23:48:08 -- Saving new best model...
2018-03-12 23:48:26 -- 
2018-03-12 23:48:26 -- Epoch = 10/50:
2018-03-12 23:51:00 -- train loss = 0.0197
2018-03-12 23:51:00 -- dev loss = 0.0220
2018-03-12 23:51:00 -- train ROC AUC = 0.9862
2018-03-12 23:51:00 -- dev ROC AUC = 0.9737
2018-03-12 23:51:00 -- New best dev ROC AUC = 0.9737
2018-03-12 23:51:00 -- Saving new best model...
2018-03-12 23:51:18 -- 
2018-03-12 23:51:18 -- Epoch = 11/50:
2018-03-12 23:53:51 -- train loss = 0.0181
2018-03-12 23:53:51 -- dev loss = 0.0222
2018-03-12 23:53:51 -- train ROC AUC = 0.9870
2018-03-12 23:53:51 -- dev ROC AUC = 0.9723
2018-03-12 23:53:51 -- 
2018-03-12 23:53:51 -- Epoch = 12/50:
2018-03-12 23:56:25 -- train loss = 0.0172
2018-03-12 23:56:25 -- dev loss = 0.0220
2018-03-12 23:56:25 -- train ROC AUC = 0.9892
2018-03-12 23:56:25 -- dev ROC AUC = 0.9747
2018-03-12 23:56:25 -- New best dev ROC AUC = 0.9747
2018-03-12 23:56:25 -- Saving new best model...
2018-03-12 23:56:43 -- 
2018-03-12 23:56:43 -- Epoch = 13/50:
2018-03-12 23:59:18 -- train loss = 0.0159
2018-03-12 23:59:18 -- dev loss = 0.0227
2018-03-12 23:59:18 -- train ROC AUC = 0.9902
2018-03-12 23:59:18 -- dev ROC AUC = 0.9745
2018-03-12 23:59:18 -- 
2018-03-12 23:59:18 -- Epoch = 14/50:
2018-03-13 00:01:52 -- train loss = 0.0149
2018-03-13 00:01:52 -- dev loss = 0.0235
2018-03-13 00:01:52 -- train ROC AUC = 0.9904
2018-03-13 00:01:52 -- dev ROC AUC = 0.9725
2018-03-13 00:01:52 -- 
2018-03-13 00:01:52 -- Epoch = 15/50:
2018-03-13 00:04:26 -- train loss = 0.0141
2018-03-13 00:04:26 -- dev loss = 0.0230
2018-03-13 00:04:26 -- train ROC AUC = 0.9912
2018-03-13 00:04:26 -- dev ROC AUC = 0.9737
2018-03-13 00:04:26 -- 
2018-03-13 00:04:26 -- Epoch = 16/50:
2018-03-13 00:07:00 -- train loss = 0.0135
2018-03-13 00:07:00 -- dev loss = 0.0232
2018-03-13 00:07:00 -- train ROC AUC = 0.9918
2018-03-13 00:07:00 -- dev ROC AUC = 0.9744
2018-03-13 00:07:00 -- 
2018-03-13 00:07:00 -- Epoch = 17/50:
2018-03-13 00:09:35 -- train loss = 0.0128
2018-03-13 00:09:35 -- dev loss = 0.0237
2018-03-13 00:09:35 -- train ROC AUC = 0.9923
2018-03-13 00:09:35 -- dev ROC AUC = 0.9740
2018-03-13 00:09:35 -- 
2018-03-13 00:09:35 -- Epoch = 18/50:
2018-03-13 00:12:11 -- train loss = 0.0121
2018-03-13 00:12:11 -- dev loss = 0.0238
2018-03-13 00:12:11 -- train ROC AUC = 0.9928
2018-03-13 00:12:11 -- dev ROC AUC = 0.9746
2018-03-13 00:12:11 -- 
2018-03-13 00:12:11 -- Epoch = 19/50:
2018-03-13 00:14:46 -- train loss = 0.0117
2018-03-13 00:14:46 -- dev loss = 0.0248
2018-03-13 00:14:46 -- train ROC AUC = 0.9925
2018-03-13 00:14:46 -- dev ROC AUC = 0.9711
2018-03-13 00:14:46 -- 
2018-03-13 00:14:46 -- Epoch = 20/50:
2018-03-13 00:17:23 -- train loss = 0.0113
2018-03-13 00:17:23 -- dev loss = 0.0248
2018-03-13 00:17:23 -- train ROC AUC = 0.9933
2018-03-13 00:17:23 -- dev ROC AUC = 0.9726
2018-03-13 00:17:23 -- 
2018-03-13 00:17:23 -- Epoch = 21/50:
2018-03-13 00:20:01 -- train loss = 0.0107
2018-03-13 00:20:01 -- dev loss = 0.0261
2018-03-13 00:20:01 -- train ROC AUC = 0.9934
2018-03-13 00:20:01 -- dev ROC AUC = 0.9703
2018-03-13 00:20:01 -- 
2018-03-13 00:20:01 -- Epoch = 22/50:
2018-03-13 00:22:37 -- train loss = 0.0106
2018-03-13 00:22:37 -- dev loss = 0.0259
2018-03-13 00:22:37 -- train ROC AUC = 0.9936
2018-03-13 00:22:37 -- dev ROC AUC = 0.9706
2018-03-13 00:22:37 -- 
2018-03-13 00:22:37 -- Epoch = 23/50:
2018-03-13 00:25:13 -- train loss = 0.0103
2018-03-13 00:25:13 -- dev loss = 0.0260
2018-03-13 00:25:13 -- train ROC AUC = 0.9941
2018-03-13 00:25:13 -- dev ROC AUC = 0.9716
2018-03-13 00:25:13 -- 
2018-03-13 00:25:13 -- Epoch = 24/50:
2018-03-13 00:27:50 -- train loss = 0.0098
2018-03-13 00:27:50 -- dev loss = 0.0271
2018-03-13 00:27:50 -- train ROC AUC = 0.9941
2018-03-13 00:27:50 -- dev ROC AUC = 0.9694
2018-03-13 00:27:50 -- 
2018-03-13 00:27:50 -- Epoch = 25/50:
2018-03-13 00:30:27 -- train loss = 0.0094
2018-03-13 00:30:27 -- dev loss = 0.0277
2018-03-13 00:30:27 -- train ROC AUC = 0.9944
2018-03-13 00:30:27 -- dev ROC AUC = 0.9700
2018-03-13 00:30:27 -- 
2018-03-13 00:30:27 -- Epoch = 26/50:
2018-03-13 00:33:03 -- train loss = 0.0094
2018-03-13 00:33:03 -- dev loss = 0.0273
2018-03-13 00:33:03 -- train ROC AUC = 0.9946
2018-03-13 00:33:03 -- dev ROC AUC = 0.9705
2018-03-13 00:33:03 -- 
2018-03-13 00:33:03 -- Epoch = 27/50:
2018-03-13 00:35:41 -- train loss = 0.0090
2018-03-13 00:35:41 -- dev loss = 0.0283
2018-03-13 00:35:41 -- train ROC AUC = 0.9949
2018-03-13 00:35:41 -- dev ROC AUC = 0.9706
2018-03-13 00:35:41 -- 
2018-03-13 00:35:41 -- Epoch = 28/50:
2018-03-13 00:38:19 -- train loss = 0.0091
2018-03-13 00:38:19 -- dev loss = 0.0279
2018-03-13 00:38:19 -- train ROC AUC = 0.9947
2018-03-13 00:38:19 -- dev ROC AUC = 0.9722
2018-03-13 00:38:19 -- 
2018-03-13 00:38:19 -- Epoch = 29/50:
2018-03-13 00:40:57 -- train loss = 0.0088
2018-03-13 00:40:57 -- dev loss = 0.0290
2018-03-13 00:40:57 -- train ROC AUC = 0.9947
2018-03-13 00:40:57 -- dev ROC AUC = 0.9677
2018-03-13 00:40:57 -- 
2018-03-13 00:40:57 -- Epoch = 30/50:
2018-03-13 00:43:37 -- train loss = 0.0085
2018-03-13 00:43:37 -- dev loss = 0.0293
2018-03-13 00:43:37 -- train ROC AUC = 0.9951
2018-03-13 00:43:37 -- dev ROC AUC = 0.9687
2018-03-13 00:43:37 -- 
2018-03-13 00:43:37 -- Epoch = 31/50:
2018-03-13 00:46:16 -- train loss = 0.0081
2018-03-13 00:46:16 -- dev loss = 0.0290
2018-03-13 00:46:16 -- train ROC AUC = 0.9953
2018-03-13 00:46:16 -- dev ROC AUC = 0.9701
2018-03-13 00:46:16 -- 
2018-03-13 00:46:16 -- Epoch = 32/50:
2018-03-13 00:48:56 -- train loss = 0.0100
2018-03-13 00:48:56 -- dev loss = 0.0297
2018-03-13 00:48:56 -- train ROC AUC = 0.9952
2018-03-13 00:48:56 -- dev ROC AUC = 0.9711
2018-03-13 00:48:56 -- 
2018-03-13 00:48:56 -- Epoch = 33/50:
2018-03-13 00:51:36 -- train loss = 0.0085
2018-03-13 00:51:36 -- dev loss = 0.0298
2018-03-13 00:51:36 -- train ROC AUC = 0.9955
2018-03-13 00:51:36 -- dev ROC AUC = 0.9703
2018-03-13 00:51:36 -- 
2018-03-13 00:51:36 -- Epoch = 34/50:
2018-03-13 00:54:17 -- train loss = 0.0077
2018-03-13 00:54:17 -- dev loss = 0.0311
2018-03-13 00:54:17 -- train ROC AUC = 0.9956
2018-03-13 00:54:17 -- dev ROC AUC = 0.9699
2018-03-13 00:54:17 -- 
2018-03-13 00:54:17 -- Epoch = 35/50:
2018-03-13 00:56:59 -- train loss = 0.0075
2018-03-13 00:56:59 -- dev loss = 0.0313
2018-03-13 00:56:59 -- train ROC AUC = 0.9958
2018-03-13 00:56:59 -- dev ROC AUC = 0.9693
2018-03-13 00:56:59 -- 
2018-03-13 00:56:59 -- Epoch = 36/50:
2018-03-13 00:59:40 -- train loss = 0.0071
2018-03-13 00:59:40 -- dev loss = 0.0317
2018-03-13 00:59:40 -- train ROC AUC = 0.9960
2018-03-13 00:59:40 -- dev ROC AUC = 0.9692
2018-03-13 00:59:40 -- 
2018-03-13 00:59:40 -- Epoch = 37/50:
2018-03-13 01:02:22 -- train loss = 0.0072
2018-03-13 01:02:22 -- dev loss = 0.0317
2018-03-13 01:02:22 -- train ROC AUC = 0.9961
2018-03-13 01:02:22 -- dev ROC AUC = 0.9694
2018-03-13 01:02:22 -- 
2018-03-13 01:02:22 -- Epoch = 38/50:
2018-03-13 01:05:05 -- train loss = 0.0082
2018-03-13 01:05:05 -- dev loss = 0.0313
2018-03-13 01:05:05 -- train ROC AUC = 0.9961
2018-03-13 01:05:05 -- dev ROC AUC = 0.9696
2018-03-13 01:05:05 -- 
2018-03-13 01:05:05 -- Epoch = 39/50:
2018-03-13 01:07:48 -- train loss = 0.0071
2018-03-13 01:07:48 -- dev loss = 0.0315
2018-03-13 01:07:48 -- train ROC AUC = 0.9964
2018-03-13 01:07:48 -- dev ROC AUC = 0.9702
2018-03-13 01:07:48 -- 
2018-03-13 01:07:48 -- Epoch = 40/50:
2018-03-13 01:10:31 -- train loss = 0.0068
2018-03-13 01:10:31 -- dev loss = 0.0334
2018-03-13 01:10:31 -- train ROC AUC = 0.9963
2018-03-13 01:10:31 -- dev ROC AUC = 0.9664
2018-03-13 01:10:31 -- 
2018-03-13 01:10:31 -- Epoch = 41/50:
2018-03-13 01:13:14 -- train loss = 0.0068
2018-03-13 01:13:14 -- dev loss = 0.0332
2018-03-13 01:13:14 -- train ROC AUC = 0.9963
2018-03-13 01:13:14 -- dev ROC AUC = 0.9674
2018-03-13 01:13:14 -- 
2018-03-13 01:13:14 -- Epoch = 42/50:
2018-03-13 01:15:58 -- train loss = 0.0064
2018-03-13 01:15:58 -- dev loss = 0.0337
2018-03-13 01:15:58 -- train ROC AUC = 0.9966
2018-03-13 01:15:58 -- dev ROC AUC = 0.9686
2018-03-13 01:15:58 -- 
2018-03-13 01:15:58 -- Epoch = 43/50:
2018-03-13 01:18:42 -- train loss = 0.0063
2018-03-13 01:18:42 -- dev loss = 0.0353
2018-03-13 01:18:42 -- train ROC AUC = 0.9965
2018-03-13 01:18:42 -- dev ROC AUC = 0.9657
2018-03-13 01:18:42 -- 
2018-03-13 01:18:42 -- Epoch = 44/50:
2018-03-13 01:21:26 -- train loss = 0.0068
2018-03-13 01:21:26 -- dev loss = 0.0346
2018-03-13 01:21:26 -- train ROC AUC = 0.9967
2018-03-13 01:21:26 -- dev ROC AUC = 0.9663
2018-03-13 01:21:26 -- 
2018-03-13 01:21:26 -- Epoch = 45/50:
2018-03-13 01:24:11 -- train loss = 0.0064
2018-03-13 01:24:11 -- dev loss = 0.0347
2018-03-13 01:24:11 -- train ROC AUC = 0.9968
2018-03-13 01:24:11 -- dev ROC AUC = 0.9671
2018-03-13 01:24:11 -- 
2018-03-13 01:24:11 -- Epoch = 46/50:
2018-03-13 01:26:56 -- train loss = 0.0061
2018-03-13 01:26:56 -- dev loss = 0.0351
2018-03-13 01:26:56 -- train ROC AUC = 0.9969
2018-03-13 01:26:56 -- dev ROC AUC = 0.9666
2018-03-13 01:26:56 -- 
2018-03-13 01:26:56 -- Epoch = 47/50:
2018-03-13 01:29:42 -- train loss = 0.0057
2018-03-13 01:29:42 -- dev loss = 0.0358
2018-03-13 01:29:42 -- train ROC AUC = 0.9970
2018-03-13 01:29:42 -- dev ROC AUC = 0.9659
2018-03-13 01:29:42 -- 
2018-03-13 01:29:42 -- Epoch = 48/50:
2018-03-13 01:32:28 -- train loss = 0.0056
2018-03-13 01:32:28 -- dev loss = 0.0366
2018-03-13 01:32:28 -- train ROC AUC = 0.9970
2018-03-13 01:32:28 -- dev ROC AUC = 0.9649
2018-03-13 01:32:28 -- 
2018-03-13 01:32:28 -- Epoch = 49/50:
2018-03-13 01:35:14 -- train loss = 0.0074
2018-03-13 01:35:14 -- dev loss = 0.0346
2018-03-13 01:35:14 -- train ROC AUC = 0.9959
2018-03-13 01:35:14 -- dev ROC AUC = 0.9656
2018-03-13 01:35:14 -- 
2018-03-13 01:35:14 -- Epoch = 50/50:
2018-03-13 01:38:02 -- train loss = 0.0071
2018-03-13 01:38:02 -- dev loss = 0.0352
2018-03-13 01:38:02 -- train ROC AUC = 0.9969
2018-03-13 01:38:02 -- dev ROC AUC = 0.9659
2018-03-13 01:38:02 -- 
2018-03-13 01:38:02 -- Testing...
2018-03-13 01:38:02 -- Rebuilding model...
2018-03-13 01:38:03 -- Restoring best model...
2018-03-13 01:38:24 -- Restoring parameters from out/new_test_5/new_test_5.weights
2018-03-13 01:38:24 -- Predicting labels for test set...
2018-03-13 01:39:31 -- Saving test prediction...
2018-03-13 01:39:32 -- 
2018-03-13 01:39:32 -- Evaluating...
2018-03-13 01:39:33 -- Mean column-wise ROC AUC - train = 0.9892
2018-03-13 01:39:33 -- Mean column-wise ROC AUC - dev = 0.9747
2018-03-13 01:39:33 -- ROC AUC of toxic - train = 0.9772
2018-03-13 01:39:33 -- ROC AUC of toxic - dev = 0.9605
2018-03-13 01:39:33 -- ROC AUC of severe_toxic - train = 0.9918
2018-03-13 01:39:33 -- ROC AUC of severe_toxic - dev = 0.9879
2018-03-13 01:39:33 -- ROC AUC of obscene - train = 0.9879
2018-03-13 01:39:33 -- ROC AUC of obscene - dev = 0.9785
2018-03-13 01:39:33 -- ROC AUC of threat - train = 0.9983
2018-03-13 01:39:33 -- ROC AUC of threat - dev = 0.9814
2018-03-13 01:39:33 -- ROC AUC of insult - train = 0.9868
2018-03-13 01:39:34 -- ROC AUC of insult - dev = 0.9743
2018-03-13 01:39:34 -- ROC AUC of identity_hate - train = 0.9931
2018-03-13 01:39:34 -- ROC AUC of identity_hate - dev = 0.9657
2018-03-13 01:39:35 -- Mean column-wise average precision - train = 0.7740
2018-03-13 01:39:35 -- Mean column-wise average precision - dev = 0.5882
2018-03-13 01:39:35 -- average precision of toxic - train = 0.8925
2018-03-13 01:39:35 -- average precision of toxic - dev = 0.8265
2018-03-13 01:39:35 -- average precision of severe_toxic - train = 0.5211
2018-03-13 01:39:35 -- average precision of severe_toxic - dev = 0.4781
2018-03-13 01:39:35 -- average precision of obscene - train = 0.8617
2018-03-13 01:39:35 -- average precision of obscene - dev = 0.8244
2018-03-13 01:39:35 -- average precision of threat - train = 0.8986
2018-03-13 01:39:35 -- average precision of threat - dev = 0.3718
2018-03-13 01:39:35 -- average precision of insult - train = 0.7907
2018-03-13 01:39:35 -- average precision of insult - dev = 0.7272
2018-03-13 01:39:35 -- average precision of identity_hate - train = 0.6796
2018-03-13 01:39:36 -- average precision of identity_hate - dev = 0.3012
