attention: true
attention_size: 10
averaging: false
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
clip_gradients: false
dropout: true
embed_size: 300
exp_name: final_test_3
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
max_grad_norm: 5
n_epochs: 25
n_labels: 6
n_layers: 2
sparsemax: false
state_size: 64
2018-03-15 04:13:09 -- 
2018-03-15 04:13:09 -- Initializing...
2018-03-15 04:13:09 -- Training...
2018-03-15 04:13:09 -- Building model...
2018-03-15 04:13:11 -- Training model...
2018-03-15 04:15:05 -- 
2018-03-15 04:15:05 -- Epoch = 1/25:
2018-03-15 04:17:57 -- grad norm = 0.1513
2018-03-15 04:17:57 -- train loss = 0.1247
2018-03-15 04:17:57 -- dev loss = 0.0483
2018-03-15 04:17:57 -- train ROC AUC = 0.6844
2018-03-15 04:17:57 -- dev ROC AUC = 0.6750
2018-03-15 04:17:57 -- New best dev ROC AUC = 0.6750
2018-03-15 04:17:57 -- Saving new best model...
2018-03-15 04:17:59 -- 
2018-03-15 04:17:59 -- Epoch = 2/25:
2018-03-15 04:20:51 -- grad norm = 0.0271
2018-03-15 04:20:51 -- train loss = 0.0532
2018-03-15 04:20:51 -- dev loss = 0.0394
2018-03-15 04:20:51 -- train ROC AUC = 0.8882
2018-03-15 04:20:51 -- dev ROC AUC = 0.8844
2018-03-15 04:20:51 -- New best dev ROC AUC = 0.8844
2018-03-15 04:20:51 -- Saving new best model...
2018-03-15 04:21:10 -- 
2018-03-15 04:21:10 -- Epoch = 3/25:
2018-03-15 04:24:01 -- grad norm = 0.0665
2018-03-15 04:24:01 -- train loss = 0.0379
2018-03-15 04:24:01 -- dev loss = 0.0285
2018-03-15 04:24:01 -- train ROC AUC = 0.9507
2018-03-15 04:24:01 -- dev ROC AUC = 0.9468
2018-03-15 04:24:01 -- New best dev ROC AUC = 0.9468
2018-03-15 04:24:01 -- Saving new best model...
2018-03-15 04:24:20 -- 
2018-03-15 04:24:20 -- Epoch = 4/25:
2018-03-15 04:27:11 -- grad norm = 0.0494
2018-03-15 04:27:11 -- train loss = 0.0296
2018-03-15 04:27:11 -- dev loss = 0.0249
2018-03-15 04:27:11 -- train ROC AUC = 0.9723
2018-03-15 04:27:11 -- dev ROC AUC = 0.9675
2018-03-15 04:27:11 -- New best dev ROC AUC = 0.9675
2018-03-15 04:27:11 -- Saving new best model...
2018-03-15 04:27:30 -- 
2018-03-15 04:27:30 -- Epoch = 5/25:
2018-03-15 04:30:21 -- grad norm = 0.0610
2018-03-15 04:30:21 -- train loss = 0.0266
2018-03-15 04:30:21 -- dev loss = 0.0236
2018-03-15 04:30:21 -- train ROC AUC = 0.9799
2018-03-15 04:30:21 -- dev ROC AUC = 0.9748
2018-03-15 04:30:21 -- New best dev ROC AUC = 0.9748
2018-03-15 04:30:21 -- Saving new best model...
2018-03-15 04:30:40 -- 
2018-03-15 04:30:40 -- Epoch = 6/25:
2018-03-15 04:33:32 -- grad norm = 0.0532
2018-03-15 04:33:32 -- train loss = 0.0244
2018-03-15 04:33:32 -- dev loss = 0.0228
2018-03-15 04:33:32 -- train ROC AUC = 0.9826
2018-03-15 04:33:32 -- dev ROC AUC = 0.9760
2018-03-15 04:33:32 -- New best dev ROC AUC = 0.9760
2018-03-15 04:33:32 -- Saving new best model...
2018-03-15 04:33:51 -- 
2018-03-15 04:33:51 -- Epoch = 7/25:
2018-03-15 04:36:44 -- grad norm = 0.0594
2018-03-15 04:36:44 -- train loss = 0.0225
2018-03-15 04:36:44 -- dev loss = 0.0218
2018-03-15 04:36:44 -- train ROC AUC = 0.9850
2018-03-15 04:36:44 -- dev ROC AUC = 0.9763
2018-03-15 04:36:44 -- New best dev ROC AUC = 0.9763
2018-03-15 04:36:44 -- Saving new best model...
2018-03-15 04:37:01 -- 
2018-03-15 04:37:01 -- Epoch = 8/25:
2018-03-15 04:39:55 -- grad norm = 0.0692
2018-03-15 04:39:55 -- train loss = 0.0207
2018-03-15 04:39:55 -- dev loss = 0.0214
2018-03-15 04:39:55 -- train ROC AUC = 0.9873
2018-03-15 04:39:55 -- dev ROC AUC = 0.9794
2018-03-15 04:39:55 -- New best dev ROC AUC = 0.9794
2018-03-15 04:39:55 -- Saving new best model...
2018-03-15 04:40:14 -- 
2018-03-15 04:40:14 -- Epoch = 9/25:
2018-03-15 04:43:08 -- grad norm = 0.0683
2018-03-15 04:43:08 -- train loss = 0.0191
2018-03-15 04:43:08 -- dev loss = 0.0219
2018-03-15 04:43:08 -- train ROC AUC = 0.9877
2018-03-15 04:43:08 -- dev ROC AUC = 0.9766
2018-03-15 04:43:08 -- 
2018-03-15 04:43:08 -- Epoch = 10/25:
2018-03-15 04:46:01 -- grad norm = 0.0643
2018-03-15 04:46:01 -- train loss = 0.0173
2018-03-15 04:46:01 -- dev loss = 0.0216
2018-03-15 04:46:01 -- train ROC AUC = 0.9894
2018-03-15 04:46:01 -- dev ROC AUC = 0.9774
2018-03-15 04:46:01 -- 
2018-03-15 04:46:01 -- Epoch = 11/25:
2018-03-15 04:48:54 -- grad norm = 0.0586
2018-03-15 04:48:54 -- train loss = 0.0163
2018-03-15 04:48:54 -- dev loss = 0.0211
2018-03-15 04:48:54 -- train ROC AUC = 0.9911
2018-03-15 04:48:54 -- dev ROC AUC = 0.9794
2018-03-15 04:48:54 -- 
2018-03-15 04:48:54 -- Epoch = 12/25:
2018-03-15 04:51:48 -- grad norm = 0.0820
2018-03-15 04:51:48 -- train loss = 0.0157
2018-03-15 04:51:48 -- dev loss = 0.0207
2018-03-15 04:51:48 -- train ROC AUC = 0.9915
2018-03-15 04:51:48 -- dev ROC AUC = 0.9788
2018-03-15 04:51:48 -- 
2018-03-15 04:51:48 -- Epoch = 13/25:
2018-03-15 04:54:42 -- grad norm = 0.0492
2018-03-15 04:54:42 -- train loss = 0.0141
2018-03-15 04:54:42 -- dev loss = 0.0216
2018-03-15 04:54:42 -- train ROC AUC = 0.9924
2018-03-15 04:54:42 -- dev ROC AUC = 0.9789
2018-03-15 04:54:42 -- 
2018-03-15 04:54:42 -- Epoch = 14/25:
2018-03-15 04:57:37 -- grad norm = 0.0553
2018-03-15 04:57:37 -- train loss = 0.0130
2018-03-15 04:57:37 -- dev loss = 0.0221
2018-03-15 04:57:37 -- train ROC AUC = 0.9929
2018-03-15 04:57:37 -- dev ROC AUC = 0.9785
2018-03-15 04:57:37 -- 
2018-03-15 04:57:37 -- Epoch = 15/25:
2018-03-15 05:00:32 -- grad norm = 0.0637
2018-03-15 05:00:32 -- train loss = 0.0125
2018-03-15 05:00:32 -- dev loss = 0.0232
2018-03-15 05:00:32 -- train ROC AUC = 0.9932
2018-03-15 05:00:32 -- dev ROC AUC = 0.9794
2018-03-15 05:00:32 -- New best dev ROC AUC = 0.9794
2018-03-15 05:00:32 -- Saving new best model...
2018-03-15 05:00:51 -- 
2018-03-15 05:00:51 -- Epoch = 16/25:
2018-03-15 05:03:46 -- grad norm = 0.0511
2018-03-15 05:03:46 -- train loss = 0.0119
2018-03-15 05:03:46 -- dev loss = 0.0238
2018-03-15 05:03:46 -- train ROC AUC = 0.9936
2018-03-15 05:03:46 -- dev ROC AUC = 0.9774
2018-03-15 05:03:46 -- 
2018-03-15 05:03:46 -- Epoch = 17/25:
2018-03-15 05:06:42 -- grad norm = 0.0515
2018-03-15 05:06:42 -- train loss = 0.0112
2018-03-15 05:06:42 -- dev loss = 0.0240
2018-03-15 05:06:42 -- train ROC AUC = 0.9941
2018-03-15 05:06:42 -- dev ROC AUC = 0.9783
2018-03-15 05:06:42 -- 
2018-03-15 05:06:42 -- Epoch = 18/25:
2018-03-15 05:09:38 -- grad norm = 0.0559
2018-03-15 05:09:38 -- train loss = 0.0108
2018-03-15 05:09:38 -- dev loss = 0.0243
2018-03-15 05:09:38 -- train ROC AUC = 0.9944
2018-03-15 05:09:38 -- dev ROC AUC = 0.9762
2018-03-15 05:09:38 -- 
2018-03-15 05:09:38 -- Epoch = 19/25:
2018-03-15 05:12:35 -- grad norm = 0.0492
2018-03-15 05:12:35 -- train loss = 0.0103
2018-03-15 05:12:35 -- dev loss = 0.0246
2018-03-15 05:12:35 -- train ROC AUC = 0.9946
2018-03-15 05:12:35 -- dev ROC AUC = 0.9757
2018-03-15 05:12:35 -- 
2018-03-15 05:12:35 -- Epoch = 20/25:
2018-03-15 05:15:33 -- grad norm = 0.0440
2018-03-15 05:15:33 -- train loss = 0.0098
2018-03-15 05:15:33 -- dev loss = 0.0251
2018-03-15 05:15:33 -- train ROC AUC = 0.9950
2018-03-15 05:15:33 -- dev ROC AUC = 0.9767
2018-03-15 05:15:33 -- 
2018-03-15 05:15:33 -- Epoch = 21/25:
2018-03-15 05:18:30 -- grad norm = 0.0492
2018-03-15 05:18:30 -- train loss = 0.0094
2018-03-15 05:18:30 -- dev loss = 0.0256
2018-03-15 05:18:30 -- train ROC AUC = 0.9952
2018-03-15 05:18:30 -- dev ROC AUC = 0.9763
2018-03-15 05:18:30 -- 
2018-03-15 05:18:30 -- Epoch = 22/25:
2018-03-15 05:21:27 -- grad norm = 0.0491
2018-03-15 05:21:27 -- train loss = 0.0091
2018-03-15 05:21:27 -- dev loss = 0.0272
2018-03-15 05:21:27 -- train ROC AUC = 0.9953
2018-03-15 05:21:27 -- dev ROC AUC = 0.9761
2018-03-15 05:21:27 -- 
2018-03-15 05:21:27 -- Epoch = 23/25:
2018-03-15 05:24:26 -- grad norm = 0.0586
2018-03-15 05:24:26 -- train loss = 0.0093
2018-03-15 05:24:26 -- dev loss = 0.0265
2018-03-15 05:24:26 -- train ROC AUC = 0.9954
2018-03-15 05:24:26 -- dev ROC AUC = 0.9774
2018-03-15 05:24:26 -- 
2018-03-15 05:24:26 -- Epoch = 24/25:
2018-03-15 05:27:25 -- grad norm = 0.0477
2018-03-15 05:27:25 -- train loss = 0.0087
2018-03-15 05:27:25 -- dev loss = 0.0269
2018-03-15 05:27:25 -- train ROC AUC = 0.9957
2018-03-15 05:27:25 -- dev ROC AUC = 0.9767
2018-03-15 05:27:25 -- 
2018-03-15 05:27:25 -- Epoch = 25/25:
2018-03-15 05:30:23 -- grad norm = 0.0377
2018-03-15 05:30:23 -- train loss = 0.0081
2018-03-15 05:30:23 -- dev loss = 0.0280
2018-03-15 05:30:23 -- train ROC AUC = 0.9958
2018-03-15 05:30:23 -- dev ROC AUC = 0.9757
2018-03-15 05:30:23 -- 
2018-03-15 05:30:23 -- Testing...
2018-03-15 05:30:23 -- Rebuilding model...
2018-03-15 05:30:27 -- Restoring best model...
2018-03-15 05:30:43 -- Restoring parameters from out/final_test_3/final_test_3.weights
2018-03-15 05:30:43 -- Predicting labels for test set...
2018-03-15 05:33:22 -- Saving test prediction...
2018-03-15 05:33:23 -- 
2018-03-15 05:33:23 -- Evaluating...
2018-03-15 05:33:24 -- Mean column-wise ROC AUC - train = 0.9932
2018-03-15 05:33:24 -- Mean column-wise ROC AUC - dev = 0.9794
2018-03-15 05:33:24 -- ROC AUC of toxic - train = 0.9859
2018-03-15 05:33:24 -- ROC AUC of toxic - dev = 0.9692
2018-03-15 05:33:24 -- ROC AUC of severe_toxic - train = 0.9948
2018-03-15 05:33:24 -- ROC AUC of severe_toxic - dev = 0.9881
2018-03-15 05:33:24 -- ROC AUC of obscene - train = 0.9933
2018-03-15 05:33:24 -- ROC AUC of obscene - dev = 0.9858
2018-03-15 05:33:24 -- ROC AUC of threat - train = 0.9996
2018-03-15 05:33:25 -- ROC AUC of threat - dev = 0.9815
2018-03-15 05:33:25 -- ROC AUC of insult - train = 0.9899
2018-03-15 05:33:25 -- ROC AUC of insult - dev = 0.9800
2018-03-15 05:33:25 -- ROC AUC of identity_hate - train = 0.9958
2018-03-15 05:33:25 -- ROC AUC of identity_hate - dev = 0.9718
2018-03-15 05:33:26 -- Mean column-wise average precision - train = 0.8319
2018-03-15 05:33:26 -- Mean column-wise average precision - dev = 0.6101
2018-03-15 05:33:26 -- average precision of toxic - train = 0.9220
2018-03-15 05:33:26 -- average precision of toxic - dev = 0.8493
2018-03-15 05:33:26 -- average precision of severe_toxic - train = 0.5909
2018-03-15 05:33:26 -- average precision of severe_toxic - dev = 0.4883
2018-03-15 05:33:26 -- average precision of obscene - train = 0.9071
2018-03-15 05:33:26 -- average precision of obscene - dev = 0.8427
2018-03-15 05:33:26 -- average precision of threat - train = 0.9348
2018-03-15 05:33:26 -- average precision of threat - dev = 0.3572
2018-03-15 05:33:26 -- average precision of insult - train = 0.8174
2018-03-15 05:33:26 -- average precision of insult - dev = 0.7482
2018-03-15 05:33:27 -- average precision of identity_hate - train = 0.8190
2018-03-15 05:33:27 -- average precision of identity_hate - dev = 0.3750
