averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_4
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-12 21:53:52 -- 
2018-03-12 21:53:52 -- Initializing...
2018-03-12 21:53:52 -- Training...
2018-03-12 21:53:52 -- Building model...
2018-03-12 21:53:54 -- Training model...
2018-03-12 21:54:13 -- 
2018-03-12 21:54:13 -- Epoch = 1/50:
2018-03-12 21:55:48 -- train loss = 0.1584
2018-03-12 21:55:48 -- dev loss = 0.0513
2018-03-12 21:55:48 -- train ROC AUC = 0.6953
2018-03-12 21:55:48 -- dev ROC AUC = 0.6969
2018-03-12 21:55:48 -- New best dev ROC AUC = 0.6969
2018-03-12 21:55:48 -- Saving new best model...
2018-03-12 21:55:50 -- 
2018-03-12 21:55:50 -- Epoch = 2/50:
2018-03-12 21:57:25 -- train loss = 0.0586
2018-03-12 21:57:25 -- dev loss = 0.0451
2018-03-12 21:57:25 -- train ROC AUC = 0.7982
2018-03-12 21:57:25 -- dev ROC AUC = 0.7979
2018-03-12 21:57:25 -- New best dev ROC AUC = 0.7979
2018-03-12 21:57:25 -- Saving new best model...
2018-03-12 21:57:43 -- 
2018-03-12 21:57:43 -- Epoch = 3/50:
2018-03-12 21:59:18 -- train loss = 0.0499
2018-03-12 21:59:18 -- dev loss = 0.0373
2018-03-12 21:59:18 -- train ROC AUC = 0.9154
2018-03-12 21:59:18 -- dev ROC AUC = 0.9119
2018-03-12 21:59:18 -- New best dev ROC AUC = 0.9119
2018-03-12 21:59:18 -- Saving new best model...
2018-03-12 21:59:37 -- 
2018-03-12 21:59:37 -- Epoch = 4/50:
2018-03-12 22:01:12 -- train loss = 0.0389
2018-03-12 22:01:12 -- dev loss = 0.0298
2018-03-12 22:01:12 -- train ROC AUC = 0.9568
2018-03-12 22:01:12 -- dev ROC AUC = 0.9491
2018-03-12 22:01:12 -- New best dev ROC AUC = 0.9491
2018-03-12 22:01:12 -- Saving new best model...
2018-03-12 22:01:30 -- 
2018-03-12 22:01:30 -- Epoch = 5/50:
2018-03-12 22:03:05 -- train loss = 0.0322
2018-03-12 22:03:05 -- dev loss = 0.0269
2018-03-12 22:03:05 -- train ROC AUC = 0.9703
2018-03-12 22:03:05 -- dev ROC AUC = 0.9614
2018-03-12 22:03:05 -- New best dev ROC AUC = 0.9614
2018-03-12 22:03:05 -- Saving new best model...
2018-03-12 22:03:24 -- 
2018-03-12 22:03:24 -- Epoch = 6/50:
2018-03-12 22:04:59 -- train loss = 0.0290
2018-03-12 22:04:59 -- dev loss = 0.0253
2018-03-12 22:04:59 -- train ROC AUC = 0.9747
2018-03-12 22:04:59 -- dev ROC AUC = 0.9653
2018-03-12 22:04:59 -- New best dev ROC AUC = 0.9653
2018-03-12 22:04:59 -- Saving new best model...
2018-03-12 22:05:18 -- 
2018-03-12 22:05:18 -- Epoch = 7/50:
2018-03-12 22:06:54 -- train loss = 0.0265
2018-03-12 22:06:54 -- dev loss = 0.0243
2018-03-12 22:06:54 -- train ROC AUC = 0.9778
2018-03-12 22:06:54 -- dev ROC AUC = 0.9670
2018-03-12 22:06:54 -- New best dev ROC AUC = 0.9670
2018-03-12 22:06:54 -- Saving new best model...
2018-03-12 22:07:12 -- 
2018-03-12 22:07:12 -- Epoch = 8/50:
2018-03-12 22:08:48 -- train loss = 0.0243
2018-03-12 22:08:48 -- dev loss = 0.0231
2018-03-12 22:08:48 -- train ROC AUC = 0.9812
2018-03-12 22:08:48 -- dev ROC AUC = 0.9697
2018-03-12 22:08:48 -- New best dev ROC AUC = 0.9697
2018-03-12 22:08:48 -- Saving new best model...
2018-03-12 22:09:07 -- 
2018-03-12 22:09:07 -- Epoch = 9/50:
2018-03-12 22:10:43 -- train loss = 0.0229
2018-03-12 22:10:43 -- dev loss = 0.0226
2018-03-12 22:10:43 -- train ROC AUC = 0.9838
2018-03-12 22:10:43 -- dev ROC AUC = 0.9725
2018-03-12 22:10:43 -- New best dev ROC AUC = 0.9725
2018-03-12 22:10:43 -- Saving new best model...
2018-03-12 22:11:00 -- 
2018-03-12 22:11:00 -- Epoch = 10/50:
2018-03-12 22:12:37 -- train loss = 0.0213
2018-03-12 22:12:37 -- dev loss = 0.0222
2018-03-12 22:12:37 -- train ROC AUC = 0.9852
2018-03-12 22:12:37 -- dev ROC AUC = 0.9724
2018-03-12 22:12:37 -- 
2018-03-12 22:12:37 -- Epoch = 11/50:
2018-03-12 22:14:14 -- train loss = 0.0204
2018-03-12 22:14:14 -- dev loss = 0.0217
2018-03-12 22:14:14 -- train ROC AUC = 0.9868
2018-03-12 22:14:14 -- dev ROC AUC = 0.9732
2018-03-12 22:14:14 -- New best dev ROC AUC = 0.9732
2018-03-12 22:14:14 -- Saving new best model...
2018-03-12 22:14:33 -- 
2018-03-12 22:14:33 -- Epoch = 12/50:
2018-03-12 22:16:10 -- train loss = 0.0194
2018-03-12 22:16:10 -- dev loss = 0.0214
2018-03-12 22:16:10 -- train ROC AUC = 0.9882
2018-03-12 22:16:10 -- dev ROC AUC = 0.9743
2018-03-12 22:16:10 -- New best dev ROC AUC = 0.9743
2018-03-12 22:16:10 -- Saving new best model...
2018-03-12 22:16:29 -- 
2018-03-12 22:16:29 -- Epoch = 13/50:
2018-03-12 22:18:06 -- train loss = 0.0183
2018-03-12 22:18:06 -- dev loss = 0.0214
2018-03-12 22:18:06 -- train ROC AUC = 0.9891
2018-03-12 22:18:06 -- dev ROC AUC = 0.9741
2018-03-12 22:18:06 -- 
2018-03-12 22:18:06 -- Epoch = 14/50:
2018-03-12 22:19:44 -- train loss = 0.0186
2018-03-12 22:19:44 -- dev loss = 0.0217
2018-03-12 22:19:44 -- train ROC AUC = 0.9894
2018-03-12 22:19:44 -- dev ROC AUC = 0.9734
2018-03-12 22:19:44 -- 
2018-03-12 22:19:44 -- Epoch = 15/50:
2018-03-12 22:21:22 -- train loss = 0.0171
2018-03-12 22:21:22 -- dev loss = 0.0225
2018-03-12 22:21:22 -- train ROC AUC = 0.9899
2018-03-12 22:21:22 -- dev ROC AUC = 0.9717
2018-03-12 22:21:22 -- 
2018-03-12 22:21:22 -- Epoch = 16/50:
2018-03-12 22:23:00 -- train loss = 0.0166
2018-03-12 22:23:00 -- dev loss = 0.0214
2018-03-12 22:23:00 -- train ROC AUC = 0.9912
2018-03-12 22:23:00 -- dev ROC AUC = 0.9747
2018-03-12 22:23:00 -- New best dev ROC AUC = 0.9747
2018-03-12 22:23:00 -- Saving new best model...
2018-03-12 22:23:18 -- 
2018-03-12 22:23:18 -- Epoch = 17/50:
2018-03-12 22:24:57 -- train loss = 0.0155
2018-03-12 22:24:57 -- dev loss = 0.0215
2018-03-12 22:24:57 -- train ROC AUC = 0.9917
2018-03-12 22:24:57 -- dev ROC AUC = 0.9742
2018-03-12 22:24:57 -- 
2018-03-12 22:24:57 -- Epoch = 18/50:
2018-03-12 22:26:35 -- train loss = 0.0146
2018-03-12 22:26:35 -- dev loss = 0.0220
2018-03-12 22:26:35 -- train ROC AUC = 0.9921
2018-03-12 22:26:35 -- dev ROC AUC = 0.9729
2018-03-12 22:26:35 -- 
2018-03-12 22:26:35 -- Epoch = 19/50:
2018-03-12 22:28:13 -- train loss = 0.0147
2018-03-12 22:28:13 -- dev loss = 0.0223
2018-03-12 22:28:13 -- train ROC AUC = 0.9918
2018-03-12 22:28:13 -- dev ROC AUC = 0.9720
2018-03-12 22:28:13 -- 
2018-03-12 22:28:13 -- Epoch = 20/50:
2018-03-12 22:29:52 -- train loss = 0.0142
2018-03-12 22:29:52 -- dev loss = 0.0219
2018-03-12 22:29:52 -- train ROC AUC = 0.9930
2018-03-12 22:29:52 -- dev ROC AUC = 0.9739
2018-03-12 22:29:52 -- 
2018-03-12 22:29:52 -- Epoch = 21/50:
2018-03-12 22:31:32 -- train loss = 0.0135
2018-03-12 22:31:32 -- dev loss = 0.0224
2018-03-12 22:31:32 -- train ROC AUC = 0.9934
2018-03-12 22:31:32 -- dev ROC AUC = 0.9731
2018-03-12 22:31:32 -- 
2018-03-12 22:31:32 -- Epoch = 22/50:
2018-03-12 22:33:12 -- train loss = 0.0129
2018-03-12 22:33:12 -- dev loss = 0.0223
2018-03-12 22:33:12 -- train ROC AUC = 0.9938
2018-03-12 22:33:12 -- dev ROC AUC = 0.9736
2018-03-12 22:33:12 -- 
2018-03-12 22:33:12 -- Epoch = 23/50:
2018-03-12 22:34:52 -- train loss = 0.0123
2018-03-12 22:34:52 -- dev loss = 0.0227
2018-03-12 22:34:52 -- train ROC AUC = 0.9941
2018-03-12 22:34:52 -- dev ROC AUC = 0.9724
2018-03-12 22:34:52 -- 
2018-03-12 22:34:52 -- Epoch = 24/50:
2018-03-12 22:36:32 -- train loss = 0.0120
2018-03-12 22:36:32 -- dev loss = 0.0230
2018-03-12 22:36:32 -- train ROC AUC = 0.9944
2018-03-12 22:36:32 -- dev ROC AUC = 0.9722
2018-03-12 22:36:32 -- 
2018-03-12 22:36:32 -- Epoch = 25/50:
2018-03-12 22:38:12 -- train loss = 0.0118
2018-03-12 22:38:12 -- dev loss = 0.0235
2018-03-12 22:38:12 -- train ROC AUC = 0.9945
2018-03-12 22:38:12 -- dev ROC AUC = 0.9716
2018-03-12 22:38:12 -- 
2018-03-12 22:38:12 -- Epoch = 26/50:
2018-03-12 22:39:53 -- train loss = 0.0116
2018-03-12 22:39:53 -- dev loss = 0.0232
2018-03-12 22:39:53 -- train ROC AUC = 0.9947
2018-03-12 22:39:53 -- dev ROC AUC = 0.9724
2018-03-12 22:39:53 -- 
2018-03-12 22:39:53 -- Epoch = 27/50:
2018-03-12 22:41:34 -- train loss = 0.0112
2018-03-12 22:41:34 -- dev loss = 0.0239
2018-03-12 22:41:34 -- train ROC AUC = 0.9950
2018-03-12 22:41:34 -- dev ROC AUC = 0.9714
2018-03-12 22:41:34 -- 
2018-03-12 22:41:34 -- Epoch = 28/50:
2018-03-12 22:43:14 -- train loss = 0.0121
2018-03-12 22:43:14 -- dev loss = 0.0237
2018-03-12 22:43:14 -- train ROC AUC = 0.9947
2018-03-12 22:43:14 -- dev ROC AUC = 0.9711
2018-03-12 22:43:14 -- 
2018-03-12 22:43:14 -- Epoch = 29/50:
2018-03-12 22:44:57 -- train loss = 0.0111
2018-03-12 22:44:57 -- dev loss = 0.0246
2018-03-12 22:44:57 -- train ROC AUC = 0.9950
2018-03-12 22:44:57 -- dev ROC AUC = 0.9700
2018-03-12 22:44:57 -- 
2018-03-12 22:44:57 -- Epoch = 30/50:
2018-03-12 22:46:39 -- train loss = 0.0108
2018-03-12 22:46:39 -- dev loss = 0.0241
2018-03-12 22:46:39 -- train ROC AUC = 0.9952
2018-03-12 22:46:39 -- dev ROC AUC = 0.9709
2018-03-12 22:46:39 -- 
2018-03-12 22:46:39 -- Epoch = 31/50:
2018-03-12 22:48:21 -- train loss = 0.0105
2018-03-12 22:48:21 -- dev loss = 0.0245
2018-03-12 22:48:21 -- train ROC AUC = 0.9956
2018-03-12 22:48:21 -- dev ROC AUC = 0.9705
2018-03-12 22:48:21 -- 
2018-03-12 22:48:21 -- Epoch = 32/50:
2018-03-12 22:50:04 -- train loss = 0.0101
2018-03-12 22:50:04 -- dev loss = 0.0249
2018-03-12 22:50:04 -- train ROC AUC = 0.9958
2018-03-12 22:50:04 -- dev ROC AUC = 0.9699
2018-03-12 22:50:04 -- 
2018-03-12 22:50:04 -- Epoch = 33/50:
2018-03-12 22:51:47 -- train loss = 0.0103
2018-03-12 22:51:47 -- dev loss = 0.0250
2018-03-12 22:51:47 -- train ROC AUC = 0.9958
2018-03-12 22:51:47 -- dev ROC AUC = 0.9702
2018-03-12 22:51:47 -- 
2018-03-12 22:51:47 -- Epoch = 34/50:
2018-03-12 22:53:30 -- train loss = 0.0097
2018-03-12 22:53:30 -- dev loss = 0.0255
2018-03-12 22:53:30 -- train ROC AUC = 0.9960
2018-03-12 22:53:30 -- dev ROC AUC = 0.9693
2018-03-12 22:53:30 -- 
2018-03-12 22:53:30 -- Epoch = 35/50:
2018-03-12 22:55:14 -- train loss = 0.0094
2018-03-12 22:55:14 -- dev loss = 0.0256
2018-03-12 22:55:14 -- train ROC AUC = 0.9961
2018-03-12 22:55:14 -- dev ROC AUC = 0.9699
2018-03-12 22:55:14 -- 
2018-03-12 22:55:14 -- Epoch = 36/50:
2018-03-12 22:56:58 -- train loss = 0.0095
2018-03-12 22:56:58 -- dev loss = 0.0260
2018-03-12 22:56:58 -- train ROC AUC = 0.9963
2018-03-12 22:56:58 -- dev ROC AUC = 0.9696
2018-03-12 22:56:58 -- 
2018-03-12 22:56:58 -- Epoch = 37/50:
2018-03-12 22:58:42 -- train loss = 0.0090
2018-03-12 22:58:42 -- dev loss = 0.0265
2018-03-12 22:58:42 -- train ROC AUC = 0.9964
2018-03-12 22:58:42 -- dev ROC AUC = 0.9688
2018-03-12 22:58:42 -- 
2018-03-12 22:58:42 -- Epoch = 38/50:
2018-03-12 23:00:27 -- train loss = 0.0087
2018-03-12 23:00:27 -- dev loss = 0.0269
2018-03-12 23:00:27 -- train ROC AUC = 0.9965
2018-03-12 23:00:27 -- dev ROC AUC = 0.9686
2018-03-12 23:00:27 -- 
2018-03-12 23:00:27 -- Epoch = 39/50:
2018-03-12 23:02:12 -- train loss = 0.0088
2018-03-12 23:02:12 -- dev loss = 0.0266
2018-03-12 23:02:12 -- train ROC AUC = 0.9966
2018-03-12 23:02:12 -- dev ROC AUC = 0.9690
2018-03-12 23:02:12 -- 
2018-03-12 23:02:12 -- Epoch = 40/50:
2018-03-12 23:03:57 -- train loss = 0.0086
2018-03-12 23:03:57 -- dev loss = 0.0269
2018-03-12 23:03:57 -- train ROC AUC = 0.9967
2018-03-12 23:03:57 -- dev ROC AUC = 0.9693
2018-03-12 23:03:57 -- 
2018-03-12 23:03:57 -- Epoch = 41/50:
2018-03-12 23:05:44 -- train loss = 0.0083
2018-03-12 23:05:44 -- dev loss = 0.0274
2018-03-12 23:05:44 -- train ROC AUC = 0.9968
2018-03-12 23:05:44 -- dev ROC AUC = 0.9692
2018-03-12 23:05:44 -- 
2018-03-12 23:05:44 -- Epoch = 42/50:
2018-03-12 23:07:30 -- train loss = 0.0081
2018-03-12 23:07:30 -- dev loss = 0.0284
2018-03-12 23:07:30 -- train ROC AUC = 0.9969
2018-03-12 23:07:30 -- dev ROC AUC = 0.9678
2018-03-12 23:07:30 -- 
2018-03-12 23:07:30 -- Epoch = 43/50:
2018-03-12 23:09:17 -- train loss = 0.0081
2018-03-12 23:09:17 -- dev loss = 0.0278
2018-03-12 23:09:17 -- train ROC AUC = 0.9970
2018-03-12 23:09:17 -- dev ROC AUC = 0.9687
2018-03-12 23:09:17 -- 
2018-03-12 23:09:17 -- Epoch = 44/50:
2018-03-12 23:11:05 -- train loss = 0.0082
2018-03-12 23:11:05 -- dev loss = 0.0281
2018-03-12 23:11:05 -- train ROC AUC = 0.9970
2018-03-12 23:11:05 -- dev ROC AUC = 0.9689
2018-03-12 23:11:05 -- 
2018-03-12 23:11:05 -- Epoch = 45/50:
2018-03-12 23:12:53 -- train loss = 0.0079
2018-03-12 23:12:53 -- dev loss = 0.0297
2018-03-12 23:12:53 -- train ROC AUC = 0.9969
2018-03-12 23:12:53 -- dev ROC AUC = 0.9674
2018-03-12 23:12:53 -- 
2018-03-12 23:12:53 -- Epoch = 46/50:
2018-03-12 23:14:43 -- train loss = 0.0087
2018-03-12 23:14:43 -- dev loss = 0.0294
2018-03-12 23:14:43 -- train ROC AUC = 0.9958
2018-03-12 23:14:43 -- dev ROC AUC = 0.9661
2018-03-12 23:14:43 -- 
2018-03-12 23:14:43 -- Epoch = 47/50:
2018-03-12 23:16:32 -- train loss = 0.0088
2018-03-12 23:16:32 -- dev loss = 0.0286
2018-03-12 23:16:32 -- train ROC AUC = 0.9968
2018-03-12 23:16:32 -- dev ROC AUC = 0.9682
2018-03-12 23:16:32 -- 
2018-03-12 23:16:32 -- Epoch = 48/50:
2018-03-12 23:18:21 -- train loss = 0.0080
2018-03-12 23:18:21 -- dev loss = 0.0290
2018-03-12 23:18:21 -- train ROC AUC = 0.9971
2018-03-12 23:18:21 -- dev ROC AUC = 0.9681
2018-03-12 23:18:21 -- 
2018-03-12 23:18:21 -- Epoch = 49/50:
2018-03-12 23:20:36 -- train loss = 0.0074
2018-03-12 23:20:36 -- dev loss = 0.0289
2018-03-12 23:20:36 -- train ROC AUC = 0.9973
2018-03-12 23:20:36 -- dev ROC AUC = 0.9684
2018-03-12 23:20:36 -- 
2018-03-12 23:20:36 -- Epoch = 50/50:
2018-03-12 23:22:25 -- train loss = 0.0088
2018-03-12 23:22:25 -- dev loss = 0.0292
2018-03-12 23:22:25 -- train ROC AUC = 0.9963
2018-03-12 23:22:25 -- dev ROC AUC = 0.9683
2018-03-12 23:22:25 -- 
2018-03-12 23:22:25 -- Testing...
2018-03-12 23:22:25 -- Rebuilding model...
2018-03-12 23:22:27 -- Restoring best model...
2018-03-12 23:22:40 -- Restoring parameters from out/new_test_4/new_test_4.weights
2018-03-12 23:22:40 -- Predicting labels for test set...
2018-03-12 23:23:25 -- Saving test prediction...
2018-03-12 23:23:26 -- 
2018-03-12 23:23:26 -- Evaluating...
2018-03-12 23:23:26 -- Mean column-wise ROC AUC - train = 0.9912
2018-03-12 23:23:26 -- Mean column-wise ROC AUC - dev = 0.9747
2018-03-12 23:23:26 -- ROC AUC of toxic - train = 0.9824
2018-03-12 23:23:27 -- ROC AUC of toxic - dev = 0.9607
2018-03-12 23:23:27 -- ROC AUC of severe_toxic - train = 0.9922
2018-03-12 23:23:27 -- ROC AUC of severe_toxic - dev = 0.9871
2018-03-12 23:23:27 -- ROC AUC of obscene - train = 0.9905
2018-03-12 23:23:27 -- ROC AUC of obscene - dev = 0.9738
2018-03-12 23:23:27 -- ROC AUC of threat - train = 0.9989
2018-03-12 23:23:27 -- ROC AUC of threat - dev = 0.9874
2018-03-12 23:23:27 -- ROC AUC of insult - train = 0.9894
2018-03-12 23:23:27 -- ROC AUC of insult - dev = 0.9746
2018-03-12 23:23:27 -- ROC AUC of identity_hate - train = 0.9938
2018-03-12 23:23:27 -- ROC AUC of identity_hate - dev = 0.9646
2018-03-12 23:23:28 -- Mean column-wise average precision - train = 0.7835
2018-03-12 23:23:28 -- Mean column-wise average precision - dev = 0.5788
2018-03-12 23:23:28 -- average precision of toxic - train = 0.9056
2018-03-12 23:23:28 -- average precision of toxic - dev = 0.8171
2018-03-12 23:23:28 -- average precision of severe_toxic - train = 0.5251
2018-03-12 23:23:28 -- average precision of severe_toxic - dev = 0.4651
2018-03-12 23:23:28 -- average precision of obscene - train = 0.8794
2018-03-12 23:23:28 -- average precision of obscene - dev = 0.7964
2018-03-12 23:23:28 -- average precision of threat - train = 0.9076
2018-03-12 23:23:28 -- average precision of threat - dev = 0.3827
2018-03-12 23:23:28 -- average precision of insult - train = 0.8126
2018-03-12 23:23:29 -- average precision of insult - dev = 0.7184
2018-03-12 23:23:29 -- average precision of identity_hate - train = 0.6705
2018-03-12 23:23:29 -- average precision of identity_hate - dev = 0.2933
