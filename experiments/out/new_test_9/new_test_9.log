attention: true
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_9
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-13 10:20:22 -- 
2018-03-13 10:20:22 -- Initializing...
2018-03-13 10:20:22 -- Training...
2018-03-13 10:20:22 -- Building model...
2018-03-13 10:20:23 -- Training model...
2018-03-13 10:20:44 -- 
2018-03-13 10:20:44 -- Epoch = 1/50:
2018-03-13 10:21:42 -- train loss = 0.1778
2018-03-13 10:21:42 -- dev loss = 0.0536
2018-03-13 10:21:42 -- train ROC AUC = 0.7011
2018-03-13 10:21:42 -- dev ROC AUC = 0.6873
2018-03-13 10:21:42 -- New best dev ROC AUC = 0.6873
2018-03-13 10:21:42 -- Saving new best model...
2018-03-13 10:21:44 -- 
2018-03-13 10:21:44 -- Epoch = 2/50:
2018-03-13 10:22:41 -- train loss = 0.0588
2018-03-13 10:22:41 -- dev loss = 0.0453
2018-03-13 10:22:41 -- train ROC AUC = 0.8019
2018-03-13 10:22:41 -- dev ROC AUC = 0.7927
2018-03-13 10:22:41 -- New best dev ROC AUC = 0.7927
2018-03-13 10:22:41 -- Saving new best model...
2018-03-13 10:22:59 -- 
2018-03-13 10:22:59 -- Epoch = 3/50:
2018-03-13 10:23:57 -- train loss = 0.0505
2018-03-13 10:23:57 -- dev loss = 0.0400
2018-03-13 10:23:57 -- train ROC AUC = 0.8888
2018-03-13 10:23:57 -- dev ROC AUC = 0.8809
2018-03-13 10:23:57 -- New best dev ROC AUC = 0.8809
2018-03-13 10:23:57 -- Saving new best model...
2018-03-13 10:24:15 -- 
2018-03-13 10:24:15 -- Epoch = 4/50:
2018-03-13 10:25:13 -- train loss = 0.0427
2018-03-13 10:25:13 -- dev loss = 0.0344
2018-03-13 10:25:13 -- train ROC AUC = 0.9282
2018-03-13 10:25:13 -- dev ROC AUC = 0.9184
2018-03-13 10:25:13 -- New best dev ROC AUC = 0.9184
2018-03-13 10:25:13 -- Saving new best model...
2018-03-13 10:25:31 -- 
2018-03-13 10:25:31 -- Epoch = 5/50:
2018-03-13 10:26:29 -- train loss = 0.0361
2018-03-13 10:26:29 -- dev loss = 0.0296
2018-03-13 10:26:29 -- train ROC AUC = 0.9585
2018-03-13 10:26:29 -- dev ROC AUC = 0.9484
2018-03-13 10:26:29 -- New best dev ROC AUC = 0.9484
2018-03-13 10:26:29 -- Saving new best model...
2018-03-13 10:26:47 -- 
2018-03-13 10:26:47 -- Epoch = 6/50:
2018-03-13 10:27:46 -- train loss = 0.0310
2018-03-13 10:27:46 -- dev loss = 0.0267
2018-03-13 10:27:46 -- train ROC AUC = 0.9731
2018-03-13 10:27:46 -- dev ROC AUC = 0.9629
2018-03-13 10:27:46 -- New best dev ROC AUC = 0.9629
2018-03-13 10:27:46 -- Saving new best model...
2018-03-13 10:28:04 -- 
2018-03-13 10:28:04 -- Epoch = 7/50:
2018-03-13 10:29:02 -- train loss = 0.0272
2018-03-13 10:29:02 -- dev loss = 0.0248
2018-03-13 10:29:02 -- train ROC AUC = 0.9786
2018-03-13 10:29:02 -- dev ROC AUC = 0.9663
2018-03-13 10:29:02 -- New best dev ROC AUC = 0.9663
2018-03-13 10:29:02 -- Saving new best model...
2018-03-13 10:29:20 -- 
2018-03-13 10:29:20 -- Epoch = 8/50:
2018-03-13 10:30:19 -- train loss = 0.0242
2018-03-13 10:30:19 -- dev loss = 0.0232
2018-03-13 10:30:19 -- train ROC AUC = 0.9835
2018-03-13 10:30:19 -- dev ROC AUC = 0.9719
2018-03-13 10:30:19 -- New best dev ROC AUC = 0.9719
2018-03-13 10:30:19 -- Saving new best model...
2018-03-13 10:30:37 -- 
2018-03-13 10:30:37 -- Epoch = 9/50:
2018-03-13 10:31:37 -- train loss = 0.0222
2018-03-13 10:31:37 -- dev loss = 0.0230
2018-03-13 10:31:37 -- train ROC AUC = 0.9847
2018-03-13 10:31:37 -- dev ROC AUC = 0.9716
2018-03-13 10:31:37 -- 
2018-03-13 10:31:37 -- Epoch = 10/50:
2018-03-13 10:32:38 -- train loss = 0.0202
2018-03-13 10:32:38 -- dev loss = 0.0228
2018-03-13 10:32:38 -- train ROC AUC = 0.9874
2018-03-13 10:32:38 -- dev ROC AUC = 0.9743
2018-03-13 10:32:38 -- New best dev ROC AUC = 0.9743
2018-03-13 10:32:38 -- Saving new best model...
2018-03-13 10:32:56 -- 
2018-03-13 10:32:56 -- Epoch = 11/50:
2018-03-13 10:33:56 -- train loss = 0.0187
2018-03-13 10:33:56 -- dev loss = 0.0220
2018-03-13 10:33:56 -- train ROC AUC = 0.9890
2018-03-13 10:33:56 -- dev ROC AUC = 0.9747
2018-03-13 10:33:56 -- New best dev ROC AUC = 0.9747
2018-03-13 10:33:56 -- Saving new best model...
2018-03-13 10:34:14 -- 
2018-03-13 10:34:14 -- Epoch = 12/50:
2018-03-13 10:35:15 -- train loss = 0.0174
2018-03-13 10:35:15 -- dev loss = 0.0226
2018-03-13 10:35:15 -- train ROC AUC = 0.9897
2018-03-13 10:35:15 -- dev ROC AUC = 0.9734
2018-03-13 10:35:15 -- 
2018-03-13 10:35:15 -- Epoch = 13/50:
2018-03-13 10:36:15 -- train loss = 0.0165
2018-03-13 10:36:15 -- dev loss = 0.0221
2018-03-13 10:36:15 -- train ROC AUC = 0.9909
2018-03-13 10:36:15 -- dev ROC AUC = 0.9745
2018-03-13 10:36:15 -- 
2018-03-13 10:36:15 -- Epoch = 14/50:
2018-03-13 10:37:15 -- train loss = 0.0157
2018-03-13 10:37:15 -- dev loss = 0.0227
2018-03-13 10:37:15 -- train ROC AUC = 0.9913
2018-03-13 10:37:15 -- dev ROC AUC = 0.9744
2018-03-13 10:37:15 -- 
2018-03-13 10:37:15 -- Epoch = 15/50:
2018-03-13 10:38:16 -- train loss = 0.0148
2018-03-13 10:38:16 -- dev loss = 0.0233
2018-03-13 10:38:16 -- train ROC AUC = 0.9920
2018-03-13 10:38:16 -- dev ROC AUC = 0.9731
2018-03-13 10:38:16 -- 
2018-03-13 10:38:16 -- Epoch = 16/50:
2018-03-13 10:39:17 -- train loss = 0.0141
2018-03-13 10:39:17 -- dev loss = 0.0225
2018-03-13 10:39:17 -- train ROC AUC = 0.9929
2018-03-13 10:39:17 -- dev ROC AUC = 0.9739
2018-03-13 10:39:17 -- 
2018-03-13 10:39:17 -- Epoch = 17/50:
2018-03-13 10:40:18 -- train loss = 0.0135
2018-03-13 10:40:18 -- dev loss = 0.0233
2018-03-13 10:40:18 -- train ROC AUC = 0.9933
2018-03-13 10:40:18 -- dev ROC AUC = 0.9735
2018-03-13 10:40:18 -- 
2018-03-13 10:40:18 -- Epoch = 18/50:
2018-03-13 10:41:19 -- train loss = 0.0135
2018-03-13 10:41:19 -- dev loss = 0.0237
2018-03-13 10:41:19 -- train ROC AUC = 0.9937
2018-03-13 10:41:19 -- dev ROC AUC = 0.9725
2018-03-13 10:41:19 -- 
2018-03-13 10:41:19 -- Epoch = 19/50:
2018-03-13 10:42:21 -- train loss = 0.0125
2018-03-13 10:42:21 -- dev loss = 0.0239
2018-03-13 10:42:21 -- train ROC AUC = 0.9940
2018-03-13 10:42:21 -- dev ROC AUC = 0.9724
2018-03-13 10:42:21 -- 
2018-03-13 10:42:21 -- Epoch = 20/50:
2018-03-13 10:43:23 -- train loss = 0.0120
2018-03-13 10:43:23 -- dev loss = 0.0243
2018-03-13 10:43:23 -- train ROC AUC = 0.9943
2018-03-13 10:43:23 -- dev ROC AUC = 0.9717
2018-03-13 10:43:23 -- 
2018-03-13 10:43:23 -- Epoch = 21/50:
2018-03-13 10:44:25 -- train loss = 0.0118
2018-03-13 10:44:25 -- dev loss = 0.0247
2018-03-13 10:44:25 -- train ROC AUC = 0.9946
2018-03-13 10:44:25 -- dev ROC AUC = 0.9710
2018-03-13 10:44:25 -- 
2018-03-13 10:44:25 -- Epoch = 22/50:
2018-03-13 10:45:28 -- train loss = 0.0114
2018-03-13 10:45:28 -- dev loss = 0.0249
2018-03-13 10:45:28 -- train ROC AUC = 0.9949
2018-03-13 10:45:28 -- dev ROC AUC = 0.9710
2018-03-13 10:45:28 -- 
2018-03-13 10:45:28 -- Epoch = 23/50:
2018-03-13 10:46:30 -- train loss = 0.0111
2018-03-13 10:46:30 -- dev loss = 0.0246
2018-03-13 10:46:30 -- train ROC AUC = 0.9949
2018-03-13 10:46:30 -- dev ROC AUC = 0.9707
2018-03-13 10:46:30 -- 
2018-03-13 10:46:30 -- Epoch = 24/50:
2018-03-13 10:47:33 -- train loss = 0.0107
2018-03-13 10:47:33 -- dev loss = 0.0256
2018-03-13 10:47:33 -- train ROC AUC = 0.9953
2018-03-13 10:47:33 -- dev ROC AUC = 0.9703
2018-03-13 10:47:33 -- 
2018-03-13 10:47:33 -- Epoch = 25/50:
2018-03-13 10:48:37 -- train loss = 0.0101
2018-03-13 10:48:37 -- dev loss = 0.0262
2018-03-13 10:48:37 -- train ROC AUC = 0.9956
2018-03-13 10:48:37 -- dev ROC AUC = 0.9695
2018-03-13 10:48:37 -- 
2018-03-13 10:48:37 -- Epoch = 26/50:
2018-03-13 10:49:41 -- train loss = 0.0100
2018-03-13 10:49:41 -- dev loss = 0.0276
2018-03-13 10:49:41 -- train ROC AUC = 0.9954
2018-03-13 10:49:41 -- dev ROC AUC = 0.9690
2018-03-13 10:49:41 -- 
2018-03-13 10:49:41 -- Epoch = 27/50:
2018-03-13 10:50:45 -- train loss = 0.0100
2018-03-13 10:50:45 -- dev loss = 0.0273
2018-03-13 10:50:45 -- train ROC AUC = 0.9958
2018-03-13 10:50:45 -- dev ROC AUC = 0.9681
2018-03-13 10:50:45 -- 
2018-03-13 10:50:45 -- Epoch = 28/50:
2018-03-13 10:51:49 -- train loss = 0.0095
2018-03-13 10:51:49 -- dev loss = 0.0275
2018-03-13 10:51:49 -- train ROC AUC = 0.9961
2018-03-13 10:51:49 -- dev ROC AUC = 0.9688
2018-03-13 10:51:49 -- 
2018-03-13 10:51:49 -- Epoch = 29/50:
2018-03-13 10:52:54 -- train loss = 0.0092
2018-03-13 10:52:54 -- dev loss = 0.0284
2018-03-13 10:52:54 -- train ROC AUC = 0.9962
2018-03-13 10:52:54 -- dev ROC AUC = 0.9670
2018-03-13 10:52:54 -- 
2018-03-13 10:52:54 -- Epoch = 30/50:
2018-03-13 10:53:59 -- train loss = 0.0162
2018-03-13 10:53:59 -- dev loss = 0.0244
2018-03-13 10:53:59 -- train ROC AUC = 0.9945
2018-03-13 10:53:59 -- dev ROC AUC = 0.9709
2018-03-13 10:53:59 -- 
2018-03-13 10:53:59 -- Epoch = 31/50:
2018-03-13 10:55:04 -- train loss = 0.0123
2018-03-13 10:55:04 -- dev loss = 0.0260
2018-03-13 10:55:04 -- train ROC AUC = 0.9955
2018-03-13 10:55:04 -- dev ROC AUC = 0.9715
2018-03-13 10:55:04 -- 
2018-03-13 10:55:04 -- Epoch = 32/50:
2018-03-13 10:56:10 -- train loss = 0.0105
2018-03-13 10:56:10 -- dev loss = 0.0257
2018-03-13 10:56:10 -- train ROC AUC = 0.9961
2018-03-13 10:56:10 -- dev ROC AUC = 0.9702
2018-03-13 10:56:10 -- 
2018-03-13 10:56:10 -- Epoch = 33/50:
2018-03-13 10:57:17 -- train loss = 0.0096
2018-03-13 10:57:17 -- dev loss = 0.0267
2018-03-13 10:57:17 -- train ROC AUC = 0.9963
2018-03-13 10:57:17 -- dev ROC AUC = 0.9690
2018-03-13 10:57:17 -- 
2018-03-13 10:57:17 -- Epoch = 34/50:
2018-03-13 10:58:24 -- train loss = 0.0092
2018-03-13 10:58:24 -- dev loss = 0.0269
2018-03-13 10:58:24 -- train ROC AUC = 0.9965
2018-03-13 10:58:24 -- dev ROC AUC = 0.9684
2018-03-13 10:58:24 -- 
2018-03-13 10:58:24 -- Epoch = 35/50:
2018-03-13 10:59:30 -- train loss = 0.0088
2018-03-13 10:59:30 -- dev loss = 0.0280
2018-03-13 10:59:30 -- train ROC AUC = 0.9967
2018-03-13 10:59:30 -- dev ROC AUC = 0.9676
2018-03-13 10:59:30 -- 
2018-03-13 10:59:30 -- Epoch = 36/50:
2018-03-13 11:00:37 -- train loss = 0.0087
2018-03-13 11:00:37 -- dev loss = 0.0284
2018-03-13 11:00:37 -- train ROC AUC = 0.9968
2018-03-13 11:00:37 -- dev ROC AUC = 0.9672
2018-03-13 11:00:37 -- 
2018-03-13 11:00:37 -- Epoch = 37/50:
2018-03-13 11:01:45 -- train loss = 0.0083
2018-03-13 11:01:45 -- dev loss = 0.0288
2018-03-13 11:01:45 -- train ROC AUC = 0.9970
2018-03-13 11:01:45 -- dev ROC AUC = 0.9668
2018-03-13 11:01:45 -- 
2018-03-13 11:01:45 -- Epoch = 38/50:
2018-03-13 11:02:53 -- train loss = 0.0082
2018-03-13 11:02:53 -- dev loss = 0.0294
2018-03-13 11:02:53 -- train ROC AUC = 0.9970
2018-03-13 11:02:53 -- dev ROC AUC = 0.9663
2018-03-13 11:02:53 -- 
2018-03-13 11:02:53 -- Epoch = 39/50:
2018-03-13 11:04:01 -- train loss = 0.0079
2018-03-13 11:04:01 -- dev loss = 0.0299
2018-03-13 11:04:01 -- train ROC AUC = 0.9971
2018-03-13 11:04:01 -- dev ROC AUC = 0.9663
2018-03-13 11:04:01 -- 
2018-03-13 11:04:01 -- Epoch = 40/50:
2018-03-13 11:05:09 -- train loss = 0.0078
2018-03-13 11:05:09 -- dev loss = 0.0303
2018-03-13 11:05:09 -- train ROC AUC = 0.9972
2018-03-13 11:05:09 -- dev ROC AUC = 0.9660
2018-03-13 11:05:09 -- 
2018-03-13 11:05:09 -- Epoch = 41/50:
2018-03-13 11:06:18 -- train loss = 0.0077
2018-03-13 11:06:18 -- dev loss = 0.0304
2018-03-13 11:06:18 -- train ROC AUC = 0.9973
2018-03-13 11:06:18 -- dev ROC AUC = 0.9659
2018-03-13 11:06:18 -- 
2018-03-13 11:06:18 -- Epoch = 42/50:
2018-03-13 11:07:26 -- train loss = 0.0074
2018-03-13 11:07:26 -- dev loss = 0.0306
2018-03-13 11:07:26 -- train ROC AUC = 0.9974
2018-03-13 11:07:26 -- dev ROC AUC = 0.9659
2018-03-13 11:07:26 -- 
2018-03-13 11:07:26 -- Epoch = 43/50:
2018-03-13 11:08:35 -- train loss = 0.0072
2018-03-13 11:08:35 -- dev loss = 0.0314
2018-03-13 11:08:35 -- train ROC AUC = 0.9975
2018-03-13 11:08:35 -- dev ROC AUC = 0.9655
2018-03-13 11:08:35 -- 
2018-03-13 11:08:35 -- Epoch = 44/50:
2018-03-13 11:09:44 -- train loss = 0.0078
2018-03-13 11:09:44 -- dev loss = 0.0309
2018-03-13 11:09:44 -- train ROC AUC = 0.9974
2018-03-13 11:09:44 -- dev ROC AUC = 0.9660
2018-03-13 11:09:44 -- 
2018-03-13 11:09:44 -- Epoch = 45/50:
2018-03-13 11:10:54 -- train loss = 0.0077
2018-03-13 11:10:54 -- dev loss = 0.0309
2018-03-13 11:10:54 -- train ROC AUC = 0.9975
2018-03-13 11:10:54 -- dev ROC AUC = 0.9661
2018-03-13 11:10:54 -- 
2018-03-13 11:10:54 -- Epoch = 46/50:
2018-03-13 11:12:04 -- train loss = 0.0071
2018-03-13 11:12:04 -- dev loss = 0.0314
2018-03-13 11:12:04 -- train ROC AUC = 0.9977
2018-03-13 11:12:04 -- dev ROC AUC = 0.9653
2018-03-13 11:12:04 -- 
2018-03-13 11:12:04 -- Epoch = 47/50:
2018-03-13 11:13:14 -- train loss = 0.0069
2018-03-13 11:13:14 -- dev loss = 0.0325
2018-03-13 11:13:14 -- train ROC AUC = 0.9977
2018-03-13 11:13:14 -- dev ROC AUC = 0.9647
2018-03-13 11:13:14 -- 
2018-03-13 11:13:14 -- Epoch = 48/50:
2018-03-13 11:14:24 -- train loss = 0.0066
2018-03-13 11:14:24 -- dev loss = 0.0325
2018-03-13 11:14:24 -- train ROC AUC = 0.9978
2018-03-13 11:14:24 -- dev ROC AUC = 0.9643
2018-03-13 11:14:24 -- 
2018-03-13 11:14:24 -- Epoch = 49/50:
2018-03-13 11:15:35 -- train loss = 0.0064
2018-03-13 11:15:35 -- dev loss = 0.0335
2018-03-13 11:15:35 -- train ROC AUC = 0.9979
2018-03-13 11:15:35 -- dev ROC AUC = 0.9644
2018-03-13 11:15:35 -- 
2018-03-13 11:15:35 -- Epoch = 50/50:
2018-03-13 11:16:46 -- train loss = 0.0064
2018-03-13 11:16:46 -- dev loss = 0.0337
2018-03-13 11:16:46 -- train ROC AUC = 0.9980
2018-03-13 11:16:46 -- dev ROC AUC = 0.9636
2018-03-13 11:16:46 -- 
2018-03-13 11:16:46 -- Testing...
2018-03-13 11:16:46 -- Rebuilding model...
2018-03-13 11:16:49 -- Restoring best model...
2018-03-13 11:17:06 -- Restoring parameters from out/new_test_9/new_test_9.weights
2018-03-13 11:17:07 -- Predicting labels for test set...
2018-03-13 11:17:39 -- Saving test prediction...
2018-03-13 11:17:40 -- 
2018-03-13 11:17:40 -- Evaluating...
2018-03-13 11:17:41 -- Mean column-wise ROC AUC - train = 0.9890
2018-03-13 11:17:41 -- Mean column-wise ROC AUC - dev = 0.9747
2018-03-13 11:17:41 -- ROC AUC of toxic - train = 0.9760
2018-03-13 11:17:41 -- ROC AUC of toxic - dev = 0.9648
2018-03-13 11:17:41 -- ROC AUC of severe_toxic - train = 0.9919
2018-03-13 11:17:41 -- ROC AUC of severe_toxic - dev = 0.9878
2018-03-13 11:17:41 -- ROC AUC of obscene - train = 0.9880
2018-03-13 11:17:41 -- ROC AUC of obscene - dev = 0.9791
2018-03-13 11:17:41 -- ROC AUC of threat - train = 0.9992
2018-03-13 11:17:41 -- ROC AUC of threat - dev = 0.9713
2018-03-13 11:17:41 -- ROC AUC of insult - train = 0.9866
2018-03-13 11:17:41 -- ROC AUC of insult - dev = 0.9748
2018-03-13 11:17:41 -- ROC AUC of identity_hate - train = 0.9925
2018-03-13 11:17:41 -- ROC AUC of identity_hate - dev = 0.9708
2018-03-13 11:17:42 -- Mean column-wise average precision - train = 0.7564
2018-03-13 11:17:42 -- Mean column-wise average precision - dev = 0.5803
2018-03-13 11:17:42 -- average precision of toxic - train = 0.8887
2018-03-13 11:17:42 -- average precision of toxic - dev = 0.8395
2018-03-13 11:17:42 -- average precision of severe_toxic - train = 0.4958
2018-03-13 11:17:42 -- average precision of severe_toxic - dev = 0.4313
2018-03-13 11:17:43 -- average precision of obscene - train = 0.8740
2018-03-13 11:17:43 -- average precision of obscene - dev = 0.8205
2018-03-13 11:17:43 -- average precision of threat - train = 0.8643
2018-03-13 11:17:43 -- average precision of threat - dev = 0.3227
2018-03-13 11:17:43 -- average precision of insult - train = 0.8039
2018-03-13 11:17:43 -- average precision of insult - dev = 0.7126
2018-03-13 11:17:43 -- average precision of identity_hate - train = 0.6118
2018-03-13 11:17:43 -- average precision of identity_hate - dev = 0.3549
