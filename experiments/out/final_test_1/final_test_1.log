attention: true
attention_size: 10
averaging: false
batch_size: 256
bidirectional: true
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
clip_gradients: false
dropout: true
embed_size: 300
exp_name: final_test_1
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
max_grad_norm: 5
n_epochs: 20
n_labels: 6
n_layers: 2
sparsemax: false
state_size: 256
2018-03-14 21:17:02 -- 
2018-03-14 21:17:02 -- Initializing...
2018-03-14 21:17:02 -- Training...
2018-03-14 21:17:02 -- Building model...
2018-03-14 21:17:06 -- Training model...
2018-03-14 21:18:56 -- 
2018-03-14 21:18:56 -- Epoch = 1/20:
2018-03-14 21:30:51 -- grad norm = 0.0660
2018-03-14 21:30:51 -- train loss = 0.0410
2018-03-14 21:30:51 -- dev loss = 0.0250
2018-03-14 21:30:51 -- train ROC AUC = 0.9730
2018-03-14 21:30:51 -- dev ROC AUC = 0.9712
2018-03-14 21:30:51 -- New best dev ROC AUC = 0.9712
2018-03-14 21:30:51 -- Saving new best model...
2018-03-14 21:30:54 -- 
2018-03-14 21:30:54 -- Epoch = 2/20:
2018-03-14 21:42:53 -- grad norm = 0.0454
2018-03-14 21:42:53 -- train loss = 0.0241
2018-03-14 21:42:53 -- dev loss = 0.0216
2018-03-14 21:42:53 -- train ROC AUC = 0.9833
2018-03-14 21:42:53 -- dev ROC AUC = 0.9796
2018-03-14 21:42:53 -- New best dev ROC AUC = 0.9796
2018-03-14 21:42:53 -- Saving new best model...
2018-03-14 21:43:11 -- 
2018-03-14 21:43:11 -- Epoch = 3/20:
2018-03-14 21:55:16 -- grad norm = 0.0450
2018-03-14 21:55:16 -- train loss = 0.0198
2018-03-14 21:55:16 -- dev loss = 0.0205
2018-03-14 21:55:16 -- train ROC AUC = 0.9877
2018-03-14 21:55:16 -- dev ROC AUC = 0.9816
2018-03-14 21:55:16 -- New best dev ROC AUC = 0.9816
2018-03-14 21:55:16 -- Saving new best model...
2018-03-14 21:55:34 -- 
2018-03-14 21:55:34 -- Epoch = 4/20:
2018-03-14 22:07:43 -- grad norm = 0.0428
2018-03-14 22:07:43 -- train loss = 0.0171
2018-03-14 22:07:43 -- dev loss = 0.0185
2018-03-14 22:07:43 -- train ROC AUC = 0.9916
2018-03-14 22:07:43 -- dev ROC AUC = 0.9850
2018-03-14 22:07:43 -- New best dev ROC AUC = 0.9850
2018-03-14 22:07:43 -- Saving new best model...
2018-03-14 22:08:01 -- 
2018-03-14 22:08:01 -- Epoch = 5/20:
2018-03-14 22:20:16 -- grad norm = 0.0381
2018-03-14 22:20:16 -- train loss = 0.0148
2018-03-14 22:20:16 -- dev loss = 0.0189
2018-03-14 22:20:16 -- train ROC AUC = 0.9931
2018-03-14 22:20:16 -- dev ROC AUC = 0.9842
2018-03-14 22:20:16 -- 
2018-03-14 22:20:16 -- Epoch = 6/20:
2018-03-14 22:32:38 -- grad norm = 0.0365
2018-03-14 22:32:38 -- train loss = 0.0130
2018-03-14 22:32:38 -- dev loss = 0.0195
2018-03-14 22:32:38 -- train ROC AUC = 0.9942
2018-03-14 22:32:38 -- dev ROC AUC = 0.9834
2018-03-14 22:32:38 -- 
2018-03-14 22:32:38 -- Epoch = 7/20:
2018-03-14 22:45:06 -- grad norm = 0.0314
2018-03-14 22:45:06 -- train loss = 0.0114
2018-03-14 22:45:06 -- dev loss = 0.0208
2018-03-14 22:45:06 -- train ROC AUC = 0.9951
2018-03-14 22:45:06 -- dev ROC AUC = 0.9821
2018-03-14 22:45:06 -- 
2018-03-14 22:45:06 -- Epoch = 8/20:
2018-03-14 22:57:39 -- grad norm = 0.0315
2018-03-14 22:57:39 -- train loss = 0.0104
2018-03-14 22:57:39 -- dev loss = 0.0227
2018-03-14 22:57:39 -- train ROC AUC = 0.9958
2018-03-14 22:57:39 -- dev ROC AUC = 0.9811
2018-03-14 22:57:39 -- 
2018-03-14 22:57:39 -- Epoch = 9/20:
2018-03-14 23:10:20 -- grad norm = 0.0303
2018-03-14 23:10:20 -- train loss = 0.0095
2018-03-14 23:10:20 -- dev loss = 0.0232
2018-03-14 23:10:20 -- train ROC AUC = 0.9963
2018-03-14 23:10:20 -- dev ROC AUC = 0.9806
2018-03-14 23:10:20 -- 
2018-03-14 23:10:20 -- Epoch = 10/20:
2018-03-14 23:23:07 -- grad norm = 0.0294
2018-03-14 23:23:07 -- train loss = 0.0086
2018-03-14 23:23:07 -- dev loss = 0.0251
2018-03-14 23:23:07 -- train ROC AUC = 0.9969
2018-03-14 23:23:07 -- dev ROC AUC = 0.9782
2018-03-14 23:23:07 -- 
2018-03-14 23:23:07 -- Epoch = 11/20:
2018-03-14 23:36:02 -- grad norm = 0.0278
2018-03-14 23:36:02 -- train loss = 0.0078
2018-03-14 23:36:02 -- dev loss = 0.0271
2018-03-14 23:36:02 -- train ROC AUC = 0.9971
2018-03-14 23:36:02 -- dev ROC AUC = 0.9768
2018-03-14 23:36:02 -- 
2018-03-14 23:36:02 -- Epoch = 12/20:
2018-03-14 23:49:03 -- grad norm = 0.0250
2018-03-14 23:49:03 -- train loss = 0.0071
2018-03-14 23:49:03 -- dev loss = 0.0291
2018-03-14 23:49:03 -- train ROC AUC = 0.9976
2018-03-14 23:49:03 -- dev ROC AUC = 0.9759
2018-03-14 23:49:03 -- 
2018-03-14 23:49:03 -- Epoch = 13/20:
2018-03-15 00:02:11 -- grad norm = 0.0282
2018-03-15 00:02:11 -- train loss = 0.0067
2018-03-15 00:02:11 -- dev loss = 0.0306
2018-03-15 00:02:11 -- train ROC AUC = 0.9977
2018-03-15 00:02:11 -- dev ROC AUC = 0.9734
2018-03-15 00:02:11 -- 
2018-03-15 00:02:11 -- Epoch = 14/20:
2018-03-15 00:15:24 -- grad norm = 0.0249
2018-03-15 00:15:24 -- train loss = 0.0061
2018-03-15 00:15:24 -- dev loss = 0.0301
2018-03-15 00:15:24 -- train ROC AUC = 0.9980
2018-03-15 00:15:24 -- dev ROC AUC = 0.9760
2018-03-15 00:15:24 -- 
2018-03-15 00:15:24 -- Epoch = 15/20:
2018-03-15 00:28:43 -- grad norm = 0.0249
2018-03-15 00:28:43 -- train loss = 0.0057
2018-03-15 00:28:43 -- dev loss = 0.0325
2018-03-15 00:28:43 -- train ROC AUC = 0.9984
2018-03-15 00:28:43 -- dev ROC AUC = 0.9717
2018-03-15 00:28:43 -- 
2018-03-15 00:28:43 -- Epoch = 16/20:
2018-03-15 00:42:08 -- grad norm = 0.0249
2018-03-15 00:42:08 -- train loss = 0.0052
2018-03-15 00:42:08 -- dev loss = 0.0346
2018-03-15 00:42:08 -- train ROC AUC = 0.9985
2018-03-15 00:42:08 -- dev ROC AUC = 0.9711
2018-03-15 00:42:08 -- 
2018-03-15 00:42:08 -- Epoch = 17/20:
2018-03-15 00:55:39 -- grad norm = 0.0246
2018-03-15 00:55:39 -- train loss = 0.0048
2018-03-15 00:55:39 -- dev loss = 0.0351
2018-03-15 00:55:39 -- train ROC AUC = 0.9987
2018-03-15 00:55:39 -- dev ROC AUC = 0.9710
2018-03-15 00:55:39 -- 
2018-03-15 00:55:39 -- Epoch = 18/20:
2018-03-15 01:09:16 -- grad norm = 0.0280
2018-03-15 01:09:16 -- train loss = 0.0046
2018-03-15 01:09:16 -- dev loss = 0.0349
2018-03-15 01:09:16 -- train ROC AUC = 0.9989
2018-03-15 01:09:16 -- dev ROC AUC = 0.9701
2018-03-15 01:09:16 -- 
2018-03-15 01:09:16 -- Epoch = 19/20:
2018-03-15 01:22:59 -- grad norm = 0.0219
2018-03-15 01:22:59 -- train loss = 0.0040
2018-03-15 01:22:59 -- dev loss = 0.0387
2018-03-15 01:22:59 -- train ROC AUC = 0.9990
2018-03-15 01:22:59 -- dev ROC AUC = 0.9694
2018-03-15 01:22:59 -- 
2018-03-15 01:22:59 -- Epoch = 20/20:
2018-03-15 01:36:43 -- grad norm = 0.0200
2018-03-15 01:36:43 -- train loss = 0.0036
2018-03-15 01:36:43 -- dev loss = 0.0412
2018-03-15 01:36:43 -- train ROC AUC = 0.9991
2018-03-15 01:36:43 -- dev ROC AUC = 0.9683
2018-03-15 01:36:43 -- 
2018-03-15 01:36:43 -- Testing...
2018-03-15 01:36:43 -- Rebuilding model...
2018-03-15 01:36:45 -- Restoring best model...
2018-03-15 01:37:31 -- Restoring parameters from out/final_test_1/final_test_1.weights
2018-03-15 01:37:32 -- Predicting labels for test set...
2018-03-15 01:43:16 -- Saving test prediction...
2018-03-15 01:43:17 -- 
2018-03-15 01:43:17 -- Evaluating...
2018-03-15 01:43:25 -- Mean column-wise ROC AUC - train = 0.9916
2018-03-15 01:43:25 -- Mean column-wise ROC AUC - dev = 0.9850
2018-03-15 01:43:26 -- ROC AUC of toxic - train = 0.9845
2018-03-15 01:43:26 -- ROC AUC of toxic - dev = 0.9742
2018-03-15 01:43:26 -- ROC AUC of severe_toxic - train = 0.9928
2018-03-15 01:43:26 -- ROC AUC of severe_toxic - dev = 0.9899
2018-03-15 01:43:26 -- ROC AUC of obscene - train = 0.9925
2018-03-15 01:43:26 -- ROC AUC of obscene - dev = 0.9886
2018-03-15 01:43:26 -- ROC AUC of threat - train = 0.9986
2018-03-15 01:43:26 -- ROC AUC of threat - dev = 0.9923
2018-03-15 01:43:26 -- ROC AUC of insult - train = 0.9879
2018-03-15 01:43:26 -- ROC AUC of insult - dev = 0.9837
2018-03-15 01:43:26 -- ROC AUC of identity_hate - train = 0.9931
2018-03-15 01:43:26 -- ROC AUC of identity_hate - dev = 0.9814
2018-03-15 01:43:27 -- Mean column-wise average precision - train = 0.7503
2018-03-15 01:43:27 -- Mean column-wise average precision - dev = 0.6445
2018-03-15 01:43:27 -- average precision of toxic - train = 0.9083
2018-03-15 01:43:27 -- average precision of toxic - dev = 0.8768
2018-03-15 01:43:28 -- average precision of severe_toxic - train = 0.5215
2018-03-15 01:43:28 -- average precision of severe_toxic - dev = 0.4984
2018-03-15 01:43:28 -- average precision of obscene - train = 0.9031
2018-03-15 01:43:28 -- average precision of obscene - dev = 0.8766
2018-03-15 01:43:28 -- average precision of threat - train = 0.7610
2018-03-15 01:43:28 -- average precision of threat - dev = 0.4287
2018-03-15 01:43:28 -- average precision of insult - train = 0.7874
2018-03-15 01:43:28 -- average precision of insult - dev = 0.7716
2018-03-15 01:43:28 -- average precision of identity_hate - train = 0.6202
2018-03-15 01:43:28 -- average precision of identity_hate - dev = 0.4146
