attention: false
attention_size: 10
averaging: true
batch_size: 1024
bidirectional: true
cell_kwargs: {}
cell_type: GRU
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_7
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 1
state_size: 50
2018-03-13 06:01:02 -- 
2018-03-13 06:01:02 -- Initializing...
2018-03-13 06:01:02 -- Training...
2018-03-13 06:01:02 -- Building model...
2018-03-13 06:01:06 -- Training model...
2018-03-13 06:01:24 -- 
2018-03-13 06:01:24 -- Epoch = 1/50:
2018-03-13 06:03:15 -- train loss = 0.1450
2018-03-13 06:03:15 -- dev loss = 0.0492
2018-03-13 06:03:15 -- train ROC AUC = 0.7237
2018-03-13 06:03:15 -- dev ROC AUC = 0.7036
2018-03-13 06:03:15 -- New best dev ROC AUC = 0.7036
2018-03-13 06:03:15 -- Saving new best model...
2018-03-13 06:03:19 -- 
2018-03-13 06:03:19 -- Epoch = 2/50:
2018-03-13 06:05:10 -- train loss = 0.0553
2018-03-13 06:05:10 -- dev loss = 0.0439
2018-03-13 06:05:10 -- train ROC AUC = 0.8414
2018-03-13 06:05:10 -- dev ROC AUC = 0.8255
2018-03-13 06:05:10 -- New best dev ROC AUC = 0.8255
2018-03-13 06:05:10 -- Saving new best model...
2018-03-13 06:05:28 -- 
2018-03-13 06:05:28 -- Epoch = 3/50:
2018-03-13 06:07:18 -- train loss = 0.0472
2018-03-13 06:07:18 -- dev loss = 0.0364
2018-03-13 06:07:18 -- train ROC AUC = 0.9324
2018-03-13 06:07:18 -- dev ROC AUC = 0.9248
2018-03-13 06:07:18 -- New best dev ROC AUC = 0.9248
2018-03-13 06:07:18 -- Saving new best model...
2018-03-13 06:07:37 -- 
2018-03-13 06:07:37 -- Epoch = 4/50:
2018-03-13 06:09:27 -- train loss = 0.0393
2018-03-13 06:09:27 -- dev loss = 0.0310
2018-03-13 06:09:27 -- train ROC AUC = 0.9604
2018-03-13 06:09:27 -- dev ROC AUC = 0.9534
2018-03-13 06:09:27 -- New best dev ROC AUC = 0.9534
2018-03-13 06:09:27 -- Saving new best model...
2018-03-13 06:09:46 -- 
2018-03-13 06:09:46 -- Epoch = 5/50:
2018-03-13 06:11:37 -- train loss = 0.0329
2018-03-13 06:11:37 -- dev loss = 0.0272
2018-03-13 06:11:37 -- train ROC AUC = 0.9715
2018-03-13 06:11:37 -- dev ROC AUC = 0.9643
2018-03-13 06:11:37 -- New best dev ROC AUC = 0.9643
2018-03-13 06:11:37 -- Saving new best model...
2018-03-13 06:11:55 -- 
2018-03-13 06:11:55 -- Epoch = 6/50:
2018-03-13 06:13:46 -- train loss = 0.0287
2018-03-13 06:13:46 -- dev loss = 0.0254
2018-03-13 06:13:46 -- train ROC AUC = 0.9765
2018-03-13 06:13:46 -- dev ROC AUC = 0.9687
2018-03-13 06:13:46 -- New best dev ROC AUC = 0.9687
2018-03-13 06:13:46 -- Saving new best model...
2018-03-13 06:14:05 -- 
2018-03-13 06:14:05 -- Epoch = 7/50:
2018-03-13 06:15:56 -- train loss = 0.0263
2018-03-13 06:15:56 -- dev loss = 0.0245
2018-03-13 06:15:56 -- train ROC AUC = 0.9795
2018-03-13 06:15:56 -- dev ROC AUC = 0.9706
2018-03-13 06:15:56 -- New best dev ROC AUC = 0.9706
2018-03-13 06:15:56 -- Saving new best model...
2018-03-13 06:16:14 -- 
2018-03-13 06:16:14 -- Epoch = 8/50:
2018-03-13 06:18:06 -- train loss = 0.0242
2018-03-13 06:18:06 -- dev loss = 0.0238
2018-03-13 06:18:06 -- train ROC AUC = 0.9820
2018-03-13 06:18:06 -- dev ROC AUC = 0.9720
2018-03-13 06:18:06 -- New best dev ROC AUC = 0.9720
2018-03-13 06:18:06 -- Saving new best model...
2018-03-13 06:18:24 -- 
2018-03-13 06:18:24 -- Epoch = 9/50:
2018-03-13 06:20:16 -- train loss = 0.0227
2018-03-13 06:20:16 -- dev loss = 0.0232
2018-03-13 06:20:16 -- train ROC AUC = 0.9842
2018-03-13 06:20:16 -- dev ROC AUC = 0.9735
2018-03-13 06:20:16 -- New best dev ROC AUC = 0.9735
2018-03-13 06:20:16 -- Saving new best model...
2018-03-13 06:20:34 -- 
2018-03-13 06:20:34 -- Epoch = 10/50:
2018-03-13 06:22:27 -- train loss = 0.0214
2018-03-13 06:22:27 -- dev loss = 0.0228
2018-03-13 06:22:27 -- train ROC AUC = 0.9858
2018-03-13 06:22:27 -- dev ROC AUC = 0.9744
2018-03-13 06:22:27 -- New best dev ROC AUC = 0.9744
2018-03-13 06:22:27 -- Saving new best model...
2018-03-13 06:22:45 -- 
2018-03-13 06:22:45 -- Epoch = 11/50:
2018-03-13 06:24:38 -- train loss = 0.0203
2018-03-13 06:24:38 -- dev loss = 0.0228
2018-03-13 06:24:38 -- train ROC AUC = 0.9869
2018-03-13 06:24:38 -- dev ROC AUC = 0.9741
2018-03-13 06:24:38 -- 
2018-03-13 06:24:38 -- Epoch = 12/50:
2018-03-13 06:26:31 -- train loss = 0.0195
2018-03-13 06:26:31 -- dev loss = 0.0224
2018-03-13 06:26:31 -- train ROC AUC = 0.9884
2018-03-13 06:26:31 -- dev ROC AUC = 0.9752
2018-03-13 06:26:31 -- New best dev ROC AUC = 0.9752
2018-03-13 06:26:31 -- Saving new best model...
2018-03-13 06:26:50 -- 
2018-03-13 06:26:50 -- Epoch = 13/50:
2018-03-13 06:28:43 -- train loss = 0.0182
2018-03-13 06:28:43 -- dev loss = 0.0224
2018-03-13 06:28:43 -- train ROC AUC = 0.9893
2018-03-13 06:28:43 -- dev ROC AUC = 0.9747
2018-03-13 06:28:43 -- 
2018-03-13 06:28:43 -- Epoch = 14/50:
2018-03-13 06:30:37 -- train loss = 0.0172
2018-03-13 06:30:37 -- dev loss = 0.0223
2018-03-13 06:30:37 -- train ROC AUC = 0.9902
2018-03-13 06:30:37 -- dev ROC AUC = 0.9751
2018-03-13 06:30:37 -- 
2018-03-13 06:30:37 -- Epoch = 15/50:
2018-03-13 06:32:32 -- train loss = 0.0165
2018-03-13 06:32:32 -- dev loss = 0.0224
2018-03-13 06:32:32 -- train ROC AUC = 0.9908
2018-03-13 06:32:32 -- dev ROC AUC = 0.9749
2018-03-13 06:32:32 -- 
2018-03-13 06:32:32 -- Epoch = 16/50:
2018-03-13 06:34:26 -- train loss = 0.0156
2018-03-13 06:34:26 -- dev loss = 0.0224
2018-03-13 06:34:26 -- train ROC AUC = 0.9915
2018-03-13 06:34:26 -- dev ROC AUC = 0.9750
2018-03-13 06:34:26 -- 
2018-03-13 06:34:26 -- Epoch = 17/50:
2018-03-13 06:36:20 -- train loss = 0.0150
2018-03-13 06:36:20 -- dev loss = 0.0225
2018-03-13 06:36:20 -- train ROC AUC = 0.9920
2018-03-13 06:36:20 -- dev ROC AUC = 0.9750
2018-03-13 06:36:20 -- 
2018-03-13 06:36:20 -- Epoch = 18/50:
2018-03-13 06:38:15 -- train loss = 0.0144
2018-03-13 06:38:15 -- dev loss = 0.0226
2018-03-13 06:38:15 -- train ROC AUC = 0.9925
2018-03-13 06:38:15 -- dev ROC AUC = 0.9749
2018-03-13 06:38:15 -- 
2018-03-13 06:38:15 -- Epoch = 19/50:
2018-03-13 06:40:09 -- train loss = 0.0139
2018-03-13 06:40:09 -- dev loss = 0.0226
2018-03-13 06:40:09 -- train ROC AUC = 0.9930
2018-03-13 06:40:09 -- dev ROC AUC = 0.9753
2018-03-13 06:40:09 -- New best dev ROC AUC = 0.9753
2018-03-13 06:40:09 -- Saving new best model...
2018-03-13 06:40:27 -- 
2018-03-13 06:40:27 -- Epoch = 20/50:
2018-03-13 06:42:22 -- train loss = 0.0134
2018-03-13 06:42:22 -- dev loss = 0.0226
2018-03-13 06:42:22 -- train ROC AUC = 0.9933
2018-03-13 06:42:22 -- dev ROC AUC = 0.9755
2018-03-13 06:42:22 -- New best dev ROC AUC = 0.9755
2018-03-13 06:42:22 -- Saving new best model...
2018-03-13 06:42:41 -- 
2018-03-13 06:42:41 -- Epoch = 21/50:
2018-03-13 06:44:37 -- train loss = 0.0130
2018-03-13 06:44:37 -- dev loss = 0.0229
2018-03-13 06:44:37 -- train ROC AUC = 0.9937
2018-03-13 06:44:37 -- dev ROC AUC = 0.9754
2018-03-13 06:44:37 -- 
2018-03-13 06:44:37 -- Epoch = 22/50:
2018-03-13 06:46:32 -- train loss = 0.0125
2018-03-13 06:46:32 -- dev loss = 0.0233
2018-03-13 06:46:32 -- train ROC AUC = 0.9939
2018-03-13 06:46:32 -- dev ROC AUC = 0.9751
2018-03-13 06:46:32 -- 
2018-03-13 06:46:32 -- Epoch = 23/50:
2018-03-13 06:48:29 -- train loss = 0.0122
2018-03-13 06:48:29 -- dev loss = 0.0234
2018-03-13 06:48:29 -- train ROC AUC = 0.9942
2018-03-13 06:48:29 -- dev ROC AUC = 0.9753
2018-03-13 06:48:29 -- 
2018-03-13 06:48:29 -- Epoch = 24/50:
2018-03-13 06:50:25 -- train loss = 0.0120
2018-03-13 06:50:25 -- dev loss = 0.0235
2018-03-13 06:50:25 -- train ROC AUC = 0.9945
2018-03-13 06:50:25 -- dev ROC AUC = 0.9754
2018-03-13 06:50:25 -- 
2018-03-13 06:50:25 -- Epoch = 25/50:
2018-03-13 06:52:21 -- train loss = 0.0115
2018-03-13 06:52:21 -- dev loss = 0.0241
2018-03-13 06:52:21 -- train ROC AUC = 0.9946
2018-03-13 06:52:21 -- dev ROC AUC = 0.9749
2018-03-13 06:52:21 -- 
2018-03-13 06:52:21 -- Epoch = 26/50:
2018-03-13 06:54:17 -- train loss = 0.0112
2018-03-13 06:54:17 -- dev loss = 0.0245
2018-03-13 06:54:17 -- train ROC AUC = 0.9949
2018-03-13 06:54:17 -- dev ROC AUC = 0.9748
2018-03-13 06:54:17 -- 
2018-03-13 06:54:17 -- Epoch = 27/50:
2018-03-13 06:56:14 -- train loss = 0.0109
2018-03-13 06:56:14 -- dev loss = 0.0244
2018-03-13 06:56:14 -- train ROC AUC = 0.9950
2018-03-13 06:56:14 -- dev ROC AUC = 0.9751
2018-03-13 06:56:14 -- 
2018-03-13 06:56:14 -- Epoch = 28/50:
2018-03-13 06:58:12 -- train loss = 0.0106
2018-03-13 06:58:12 -- dev loss = 0.0248
2018-03-13 06:58:12 -- train ROC AUC = 0.9952
2018-03-13 06:58:12 -- dev ROC AUC = 0.9749
2018-03-13 06:58:12 -- 
2018-03-13 06:58:12 -- Epoch = 29/50:
2018-03-13 07:00:09 -- train loss = 0.0103
2018-03-13 07:00:09 -- dev loss = 0.0250
2018-03-13 07:00:09 -- train ROC AUC = 0.9954
2018-03-13 07:00:09 -- dev ROC AUC = 0.9746
2018-03-13 07:00:09 -- 
2018-03-13 07:00:09 -- Epoch = 30/50:
2018-03-13 07:02:07 -- train loss = 0.0101
2018-03-13 07:02:07 -- dev loss = 0.0255
2018-03-13 07:02:07 -- train ROC AUC = 0.9956
2018-03-13 07:02:07 -- dev ROC AUC = 0.9742
2018-03-13 07:02:07 -- 
2018-03-13 07:02:07 -- Epoch = 31/50:
2018-03-13 07:04:05 -- train loss = 0.0098
2018-03-13 07:04:05 -- dev loss = 0.0257
2018-03-13 07:04:05 -- train ROC AUC = 0.9957
2018-03-13 07:04:05 -- dev ROC AUC = 0.9740
2018-03-13 07:04:05 -- 
2018-03-13 07:04:05 -- Epoch = 32/50:
2018-03-13 07:06:04 -- train loss = 0.0097
2018-03-13 07:06:04 -- dev loss = 0.0260
2018-03-13 07:06:04 -- train ROC AUC = 0.9959
2018-03-13 07:06:04 -- dev ROC AUC = 0.9741
2018-03-13 07:06:04 -- 
2018-03-13 07:06:04 -- Epoch = 33/50:
2018-03-13 07:08:03 -- train loss = 0.0095
2018-03-13 07:08:03 -- dev loss = 0.0260
2018-03-13 07:08:03 -- train ROC AUC = 0.9961
2018-03-13 07:08:03 -- dev ROC AUC = 0.9740
2018-03-13 07:08:03 -- 
2018-03-13 07:08:03 -- Epoch = 34/50:
2018-03-13 07:10:02 -- train loss = 0.0092
2018-03-13 07:10:02 -- dev loss = 0.0262
2018-03-13 07:10:02 -- train ROC AUC = 0.9962
2018-03-13 07:10:02 -- dev ROC AUC = 0.9739
2018-03-13 07:10:02 -- 
2018-03-13 07:10:02 -- Epoch = 35/50:
2018-03-13 07:12:02 -- train loss = 0.0090
2018-03-13 07:12:02 -- dev loss = 0.0273
2018-03-13 07:12:02 -- train ROC AUC = 0.9961
2018-03-13 07:12:02 -- dev ROC AUC = 0.9733
2018-03-13 07:12:02 -- 
2018-03-13 07:12:02 -- Epoch = 36/50:
2018-03-13 07:14:02 -- train loss = 0.0091
2018-03-13 07:14:02 -- dev loss = 0.0268
2018-03-13 07:14:02 -- train ROC AUC = 0.9964
2018-03-13 07:14:02 -- dev ROC AUC = 0.9735
2018-03-13 07:14:02 -- 
2018-03-13 07:14:02 -- Epoch = 37/50:
2018-03-13 07:16:03 -- train loss = 0.0087
2018-03-13 07:16:03 -- dev loss = 0.0274
2018-03-13 07:16:03 -- train ROC AUC = 0.9966
2018-03-13 07:16:03 -- dev ROC AUC = 0.9732
2018-03-13 07:16:03 -- 
2018-03-13 07:16:03 -- Epoch = 38/50:
2018-03-13 07:18:04 -- train loss = 0.0084
2018-03-13 07:18:04 -- dev loss = 0.0278
2018-03-13 07:18:04 -- train ROC AUC = 0.9967
2018-03-13 07:18:04 -- dev ROC AUC = 0.9732
2018-03-13 07:18:04 -- 
2018-03-13 07:18:04 -- Epoch = 39/50:
2018-03-13 07:20:05 -- train loss = 0.0083
2018-03-13 07:20:05 -- dev loss = 0.0279
2018-03-13 07:20:05 -- train ROC AUC = 0.9968
2018-03-13 07:20:05 -- dev ROC AUC = 0.9733
2018-03-13 07:20:05 -- 
2018-03-13 07:20:05 -- Epoch = 40/50:
2018-03-13 07:22:07 -- train loss = 0.0081
2018-03-13 07:22:07 -- dev loss = 0.0281
2018-03-13 07:22:07 -- train ROC AUC = 0.9969
2018-03-13 07:22:07 -- dev ROC AUC = 0.9733
2018-03-13 07:22:07 -- 
2018-03-13 07:22:07 -- Epoch = 41/50:
2018-03-13 07:24:09 -- train loss = 0.0078
2018-03-13 07:24:09 -- dev loss = 0.0284
2018-03-13 07:24:09 -- train ROC AUC = 0.9970
2018-03-13 07:24:09 -- dev ROC AUC = 0.9728
2018-03-13 07:24:09 -- 
2018-03-13 07:24:09 -- Epoch = 42/50:
2018-03-13 07:26:11 -- train loss = 0.0078
2018-03-13 07:26:11 -- dev loss = 0.0287
2018-03-13 07:26:11 -- train ROC AUC = 0.9971
2018-03-13 07:26:11 -- dev ROC AUC = 0.9725
2018-03-13 07:26:11 -- 
2018-03-13 07:26:11 -- Epoch = 43/50:
2018-03-13 07:28:14 -- train loss = 0.0076
2018-03-13 07:28:14 -- dev loss = 0.0295
2018-03-13 07:28:14 -- train ROC AUC = 0.9972
2018-03-13 07:28:14 -- dev ROC AUC = 0.9722
2018-03-13 07:28:14 -- 
2018-03-13 07:28:14 -- Epoch = 44/50:
2018-03-13 07:30:17 -- train loss = 0.0075
2018-03-13 07:30:17 -- dev loss = 0.0302
2018-03-13 07:30:17 -- train ROC AUC = 0.9973
2018-03-13 07:30:17 -- dev ROC AUC = 0.9721
2018-03-13 07:30:17 -- 
2018-03-13 07:30:17 -- Epoch = 45/50:
2018-03-13 07:32:20 -- train loss = 0.0074
2018-03-13 07:32:20 -- dev loss = 0.0296
2018-03-13 07:32:20 -- train ROC AUC = 0.9974
2018-03-13 07:32:20 -- dev ROC AUC = 0.9722
2018-03-13 07:32:20 -- 
2018-03-13 07:32:20 -- Epoch = 46/50:
2018-03-13 07:34:24 -- train loss = 0.0071
2018-03-13 07:34:24 -- dev loss = 0.0297
2018-03-13 07:34:24 -- train ROC AUC = 0.9974
2018-03-13 07:34:24 -- dev ROC AUC = 0.9725
2018-03-13 07:34:24 -- 
2018-03-13 07:34:24 -- Epoch = 47/50:
2018-03-13 07:36:28 -- train loss = 0.0070
2018-03-13 07:36:28 -- dev loss = 0.0299
2018-03-13 07:36:28 -- train ROC AUC = 0.9975
2018-03-13 07:36:28 -- dev ROC AUC = 0.9724
2018-03-13 07:36:28 -- 
2018-03-13 07:36:28 -- Epoch = 48/50:
2018-03-13 07:38:33 -- train loss = 0.0069
2018-03-13 07:38:33 -- dev loss = 0.0303
2018-03-13 07:38:33 -- train ROC AUC = 0.9976
2018-03-13 07:38:33 -- dev ROC AUC = 0.9723
2018-03-13 07:38:33 -- 
2018-03-13 07:38:33 -- Epoch = 49/50:
2018-03-13 07:40:38 -- train loss = 0.0067
2018-03-13 07:40:38 -- dev loss = 0.0309
2018-03-13 07:40:38 -- train ROC AUC = 0.9977
2018-03-13 07:40:38 -- dev ROC AUC = 0.9718
2018-03-13 07:40:38 -- 
2018-03-13 07:40:38 -- Epoch = 50/50:
2018-03-13 07:42:43 -- train loss = 0.0065
2018-03-13 07:42:43 -- dev loss = 0.0319
2018-03-13 07:42:43 -- train ROC AUC = 0.9977
2018-03-13 07:42:43 -- dev ROC AUC = 0.9717
2018-03-13 07:42:43 -- 
2018-03-13 07:42:43 -- Testing...
2018-03-13 07:42:43 -- Rebuilding model...
2018-03-13 07:42:46 -- Restoring best model...
2018-03-13 07:43:00 -- Restoring parameters from out/new_test_7/new_test_7.weights
2018-03-13 07:43:01 -- Predicting labels for test set...
2018-03-13 07:43:50 -- Saving test prediction...
2018-03-13 07:43:51 -- 
2018-03-13 07:43:51 -- Evaluating...
2018-03-13 07:43:51 -- Mean column-wise ROC AUC - train = 0.9933
2018-03-13 07:43:52 -- Mean column-wise ROC AUC - dev = 0.9755
2018-03-13 07:43:52 -- ROC AUC of toxic - train = 0.9855
2018-03-13 07:43:52 -- ROC AUC of toxic - dev = 0.9628
2018-03-13 07:43:52 -- ROC AUC of severe_toxic - train = 0.9932
2018-03-13 07:43:52 -- ROC AUC of severe_toxic - dev = 0.9860
2018-03-13 07:43:52 -- ROC AUC of obscene - train = 0.9925
2018-03-13 07:43:52 -- ROC AUC of obscene - dev = 0.9777
2018-03-13 07:43:52 -- ROC AUC of threat - train = 0.9998
2018-03-13 07:43:52 -- ROC AUC of threat - dev = 0.9778
2018-03-13 07:43:52 -- ROC AUC of insult - train = 0.9914
2018-03-13 07:43:52 -- ROC AUC of insult - dev = 0.9745
2018-03-13 07:43:52 -- ROC AUC of identity_hate - train = 0.9974
2018-03-13 07:43:52 -- ROC AUC of identity_hate - dev = 0.9745
2018-03-13 07:43:53 -- Mean column-wise average precision - train = 0.8329
2018-03-13 07:43:53 -- Mean column-wise average precision - dev = 0.5837
2018-03-13 07:43:53 -- average precision of toxic - train = 0.9166
2018-03-13 07:43:53 -- average precision of toxic - dev = 0.8267
2018-03-13 07:43:53 -- average precision of severe_toxic - train = 0.5454
2018-03-13 07:43:53 -- average precision of severe_toxic - dev = 0.4532
2018-03-13 07:43:53 -- average precision of obscene - train = 0.9032
2018-03-13 07:43:53 -- average precision of obscene - dev = 0.8010
2018-03-13 07:43:54 -- average precision of threat - train = 0.9407
2018-03-13 07:43:54 -- average precision of threat - dev = 0.2992
2018-03-13 07:43:54 -- average precision of insult - train = 0.8515
2018-03-13 07:43:54 -- average precision of insult - dev = 0.7002
2018-03-13 07:43:54 -- average precision of identity_hate - train = 0.8400
2018-03-13 07:43:54 -- average precision of identity_hate - dev = 0.4220
