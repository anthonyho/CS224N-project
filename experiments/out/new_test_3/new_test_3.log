averaging: true
batch_size: 1024
bidirectional: false
cell_kwargs: {}
cell_type: LSTM
class_weights: [1.0, 9.58871448, 1.810155, 31.99581504, 1.94160208, 10.88540896]
dropout: true
embed_size: 300
exp_name: new_test_3
keep_prob: 0.5
lr: 0.0005
max_comment_size: 250
n_epochs: 50
n_labels: 6
n_layers: 2
state_size: 50
2018-03-12 20:43:14 -- 
2018-03-12 20:43:14 -- Initializing...
2018-03-12 20:43:14 -- Training...
2018-03-12 20:43:14 -- Building model...
2018-03-12 20:43:15 -- Training model...
2018-03-12 20:43:34 -- 
2018-03-12 20:43:34 -- Epoch = 1/50:
2018-03-12 20:44:48 -- train loss = 0.1758
2018-03-12 20:44:48 -- dev loss = 0.0521
2018-03-12 20:44:48 -- train ROC AUC = 0.6394
2018-03-12 20:44:48 -- dev ROC AUC = 0.6484
2018-03-12 20:44:48 -- New best dev ROC AUC = 0.6484
2018-03-12 20:44:48 -- Saving new best model...
2018-03-12 20:44:50 -- 
2018-03-12 20:44:50 -- Epoch = 2/50:
2018-03-12 20:46:05 -- train loss = 0.0596
2018-03-12 20:46:05 -- dev loss = 0.0477
2018-03-12 20:46:05 -- train ROC AUC = 0.6611
2018-03-12 20:46:05 -- dev ROC AUC = 0.6687
2018-03-12 20:46:05 -- New best dev ROC AUC = 0.6687
2018-03-12 20:46:05 -- Saving new best model...
2018-03-12 20:46:21 -- 
2018-03-12 20:46:21 -- Epoch = 3/50:
2018-03-12 20:47:36 -- train loss = 0.0549
2018-03-12 20:47:36 -- dev loss = 0.0460
2018-03-12 20:47:36 -- train ROC AUC = 0.7318
2018-03-12 20:47:36 -- dev ROC AUC = 0.7329
2018-03-12 20:47:36 -- New best dev ROC AUC = 0.7329
2018-03-12 20:47:36 -- Saving new best model...
2018-03-12 20:47:51 -- 
2018-03-12 20:47:51 -- Epoch = 4/50:
2018-03-12 20:49:06 -- train loss = 0.0496
2018-03-12 20:49:06 -- dev loss = 0.0380
2018-03-12 20:49:06 -- train ROC AUC = 0.9024
2018-03-12 20:49:06 -- dev ROC AUC = 0.8975
2018-03-12 20:49:06 -- New best dev ROC AUC = 0.8975
2018-03-12 20:49:06 -- Saving new best model...
2018-03-12 20:49:23 -- 
2018-03-12 20:49:23 -- Epoch = 5/50:
2018-03-12 20:50:38 -- train loss = 0.0393
2018-03-12 20:50:38 -- dev loss = 0.0313
2018-03-12 20:50:38 -- train ROC AUC = 0.9483
2018-03-12 20:50:38 -- dev ROC AUC = 0.9397
2018-03-12 20:50:38 -- New best dev ROC AUC = 0.9397
2018-03-12 20:50:38 -- Saving new best model...
2018-03-12 20:50:56 -- 
2018-03-12 20:50:56 -- Epoch = 6/50:
2018-03-12 20:52:11 -- train loss = 0.0333
2018-03-12 20:52:11 -- dev loss = 0.0288
2018-03-12 20:52:11 -- train ROC AUC = 0.9630
2018-03-12 20:52:11 -- dev ROC AUC = 0.9515
2018-03-12 20:52:11 -- New best dev ROC AUC = 0.9515
2018-03-12 20:52:11 -- Saving new best model...
2018-03-12 20:52:28 -- 
2018-03-12 20:52:28 -- Epoch = 7/50:
2018-03-12 20:53:43 -- train loss = 0.0301
2018-03-12 20:53:43 -- dev loss = 0.0278
2018-03-12 20:53:43 -- train ROC AUC = 0.9698
2018-03-12 20:53:43 -- dev ROC AUC = 0.9544
2018-03-12 20:53:43 -- New best dev ROC AUC = 0.9544
2018-03-12 20:53:43 -- Saving new best model...
2018-03-12 20:54:02 -- 
2018-03-12 20:54:02 -- Epoch = 8/50:
2018-03-12 20:55:17 -- train loss = 0.0282
2018-03-12 20:55:17 -- dev loss = 0.0279
2018-03-12 20:55:17 -- train ROC AUC = 0.9728
2018-03-12 20:55:17 -- dev ROC AUC = 0.9524
2018-03-12 20:55:17 -- 
2018-03-12 20:55:17 -- Epoch = 9/50:
2018-03-12 20:56:35 -- train loss = 0.0264
2018-03-12 20:56:35 -- dev loss = 0.0270
2018-03-12 20:56:35 -- train ROC AUC = 0.9770
2018-03-12 20:56:35 -- dev ROC AUC = 0.9546
2018-03-12 20:56:35 -- New best dev ROC AUC = 0.9546
2018-03-12 20:56:35 -- Saving new best model...
2018-03-12 20:56:53 -- 
2018-03-12 20:56:53 -- Epoch = 10/50:
2018-03-12 20:58:10 -- train loss = 0.0249
2018-03-12 20:58:10 -- dev loss = 0.0270
2018-03-12 20:58:10 -- train ROC AUC = 0.9798
2018-03-12 20:58:10 -- dev ROC AUC = 0.9541
2018-03-12 20:58:10 -- 
2018-03-12 20:58:10 -- Epoch = 11/50:
2018-03-12 20:59:26 -- train loss = 0.0234
2018-03-12 20:59:26 -- dev loss = 0.0268
2018-03-12 20:59:26 -- train ROC AUC = 0.9819
2018-03-12 20:59:26 -- dev ROC AUC = 0.9526
2018-03-12 20:59:26 -- 
2018-03-12 20:59:26 -- Epoch = 12/50:
2018-03-12 21:00:43 -- train loss = 0.0222
2018-03-12 21:00:43 -- dev loss = 0.0268
2018-03-12 21:00:43 -- train ROC AUC = 0.9837
2018-03-12 21:00:43 -- dev ROC AUC = 0.9522
2018-03-12 21:00:43 -- 
2018-03-12 21:00:43 -- Epoch = 13/50:
2018-03-12 21:02:00 -- train loss = 0.0208
2018-03-12 21:02:00 -- dev loss = 0.0269
2018-03-12 21:02:00 -- train ROC AUC = 0.9855
2018-03-12 21:02:00 -- dev ROC AUC = 0.9515
2018-03-12 21:02:00 -- 
2018-03-12 21:02:00 -- Epoch = 14/50:
2018-03-12 21:03:17 -- train loss = 0.0195
2018-03-12 21:03:17 -- dev loss = 0.0268
2018-03-12 21:03:17 -- train ROC AUC = 0.9866
2018-03-12 21:03:17 -- dev ROC AUC = 0.9518
2018-03-12 21:03:17 -- 
2018-03-12 21:03:17 -- Epoch = 15/50:
2018-03-12 21:04:35 -- train loss = 0.0186
2018-03-12 21:04:35 -- dev loss = 0.0265
2018-03-12 21:04:35 -- train ROC AUC = 0.9880
2018-03-12 21:04:35 -- dev ROC AUC = 0.9527
2018-03-12 21:04:35 -- 
2018-03-12 21:04:35 -- Epoch = 16/50:
2018-03-12 21:05:53 -- train loss = 0.0176
2018-03-12 21:05:53 -- dev loss = 0.0267
2018-03-12 21:05:53 -- train ROC AUC = 0.9887
2018-03-12 21:05:53 -- dev ROC AUC = 0.9534
2018-03-12 21:05:53 -- 
2018-03-12 21:05:53 -- Epoch = 17/50:
2018-03-12 21:07:11 -- train loss = 0.0170
2018-03-12 21:07:11 -- dev loss = 0.0269
2018-03-12 21:07:11 -- train ROC AUC = 0.9893
2018-03-12 21:07:11 -- dev ROC AUC = 0.9529
2018-03-12 21:07:11 -- 
2018-03-12 21:07:11 -- Epoch = 18/50:
2018-03-12 21:08:29 -- train loss = 0.0162
2018-03-12 21:08:29 -- dev loss = 0.0270
2018-03-12 21:08:29 -- train ROC AUC = 0.9899
2018-03-12 21:08:29 -- dev ROC AUC = 0.9510
2018-03-12 21:08:29 -- 
2018-03-12 21:08:29 -- Epoch = 19/50:
2018-03-12 21:09:47 -- train loss = 0.0158
2018-03-12 21:09:47 -- dev loss = 0.0275
2018-03-12 21:09:47 -- train ROC AUC = 0.9907
2018-03-12 21:09:47 -- dev ROC AUC = 0.9515
2018-03-12 21:09:47 -- 
2018-03-12 21:09:47 -- Epoch = 20/50:
2018-03-12 21:11:06 -- train loss = 0.0149
2018-03-12 21:11:06 -- dev loss = 0.0274
2018-03-12 21:11:06 -- train ROC AUC = 0.9913
2018-03-12 21:11:06 -- dev ROC AUC = 0.9527
2018-03-12 21:11:06 -- 
2018-03-12 21:11:06 -- Epoch = 21/50:
2018-03-12 21:12:26 -- train loss = 0.0144
2018-03-12 21:12:26 -- dev loss = 0.0281
2018-03-12 21:12:26 -- train ROC AUC = 0.9916
2018-03-12 21:12:26 -- dev ROC AUC = 0.9512
2018-03-12 21:12:26 -- 
2018-03-12 21:12:26 -- Epoch = 22/50:
2018-03-12 21:13:45 -- train loss = 0.0140
2018-03-12 21:13:45 -- dev loss = 0.0279
2018-03-12 21:13:45 -- train ROC AUC = 0.9918
2018-03-12 21:13:45 -- dev ROC AUC = 0.9508
2018-03-12 21:13:45 -- 
2018-03-12 21:13:45 -- Epoch = 23/50:
2018-03-12 21:15:05 -- train loss = 0.0135
2018-03-12 21:15:05 -- dev loss = 0.0287
2018-03-12 21:15:05 -- train ROC AUC = 0.9924
2018-03-12 21:15:05 -- dev ROC AUC = 0.9524
2018-03-12 21:15:05 -- 
2018-03-12 21:15:05 -- Epoch = 24/50:
2018-03-12 21:16:25 -- train loss = 0.0128
2018-03-12 21:16:25 -- dev loss = 0.0289
2018-03-12 21:16:25 -- train ROC AUC = 0.9927
2018-03-12 21:16:25 -- dev ROC AUC = 0.9521
2018-03-12 21:16:25 -- 
2018-03-12 21:16:25 -- Epoch = 25/50:
2018-03-12 21:17:45 -- train loss = 0.0124
2018-03-12 21:17:45 -- dev loss = 0.0298
2018-03-12 21:17:45 -- train ROC AUC = 0.9933
2018-03-12 21:17:45 -- dev ROC AUC = 0.9512
2018-03-12 21:17:45 -- 
2018-03-12 21:17:45 -- Epoch = 26/50:
2018-03-12 21:19:05 -- train loss = 0.0120
2018-03-12 21:19:05 -- dev loss = 0.0301
2018-03-12 21:19:05 -- train ROC AUC = 0.9936
2018-03-12 21:19:05 -- dev ROC AUC = 0.9506
2018-03-12 21:19:05 -- 
2018-03-12 21:19:05 -- Epoch = 27/50:
2018-03-12 21:20:26 -- train loss = 0.0117
2018-03-12 21:20:26 -- dev loss = 0.0296
2018-03-12 21:20:26 -- train ROC AUC = 0.9940
2018-03-12 21:20:26 -- dev ROC AUC = 0.9511
2018-03-12 21:20:26 -- 
2018-03-12 21:20:26 -- Epoch = 28/50:
2018-03-12 21:21:48 -- train loss = 0.0113
2018-03-12 21:21:48 -- dev loss = 0.0307
2018-03-12 21:21:48 -- train ROC AUC = 0.9943
2018-03-12 21:21:48 -- dev ROC AUC = 0.9504
2018-03-12 21:21:48 -- 
2018-03-12 21:21:48 -- Epoch = 29/50:
2018-03-12 21:23:10 -- train loss = 0.0108
2018-03-12 21:23:10 -- dev loss = 0.0311
2018-03-12 21:23:10 -- train ROC AUC = 0.9945
2018-03-12 21:23:10 -- dev ROC AUC = 0.9504
2018-03-12 21:23:10 -- 
2018-03-12 21:23:10 -- Epoch = 30/50:
2018-03-12 21:24:33 -- train loss = 0.0104
2018-03-12 21:24:33 -- dev loss = 0.0322
2018-03-12 21:24:33 -- train ROC AUC = 0.9946
2018-03-12 21:24:33 -- dev ROC AUC = 0.9478
2018-03-12 21:24:33 -- 
2018-03-12 21:24:33 -- Epoch = 31/50:
2018-03-12 21:25:56 -- train loss = 0.0104
2018-03-12 21:25:56 -- dev loss = 0.0320
2018-03-12 21:25:56 -- train ROC AUC = 0.9949
2018-03-12 21:25:56 -- dev ROC AUC = 0.9492
2018-03-12 21:25:56 -- 
2018-03-12 21:25:56 -- Epoch = 32/50:
2018-03-12 21:27:19 -- train loss = 0.0103
2018-03-12 21:27:19 -- dev loss = 0.0325
2018-03-12 21:27:19 -- train ROC AUC = 0.9951
2018-03-12 21:27:19 -- dev ROC AUC = 0.9497
2018-03-12 21:27:19 -- 
2018-03-12 21:27:19 -- Epoch = 33/50:
2018-03-12 21:28:42 -- train loss = 0.0098
2018-03-12 21:28:42 -- dev loss = 0.0323
2018-03-12 21:28:42 -- train ROC AUC = 0.9952
2018-03-12 21:28:42 -- dev ROC AUC = 0.9497
2018-03-12 21:28:42 -- 
2018-03-12 21:28:42 -- Epoch = 34/50:
2018-03-12 21:30:05 -- train loss = 0.0096
2018-03-12 21:30:05 -- dev loss = 0.0328
2018-03-12 21:30:05 -- train ROC AUC = 0.9955
2018-03-12 21:30:05 -- dev ROC AUC = 0.9491
2018-03-12 21:30:05 -- 
2018-03-12 21:30:05 -- Epoch = 35/50:
2018-03-12 21:31:29 -- train loss = 0.0095
2018-03-12 21:31:29 -- dev loss = 0.0336
2018-03-12 21:31:29 -- train ROC AUC = 0.9957
2018-03-12 21:31:29 -- dev ROC AUC = 0.9495
2018-03-12 21:31:29 -- 
2018-03-12 21:31:29 -- Epoch = 36/50:
2018-03-12 21:32:52 -- train loss = 0.0090
2018-03-12 21:32:52 -- dev loss = 0.0346
2018-03-12 21:32:52 -- train ROC AUC = 0.9958
2018-03-12 21:32:52 -- dev ROC AUC = 0.9476
2018-03-12 21:32:52 -- 
2018-03-12 21:32:52 -- Epoch = 37/50:
2018-03-12 21:34:16 -- train loss = 0.0097
2018-03-12 21:34:16 -- dev loss = 0.0345
2018-03-12 21:34:16 -- train ROC AUC = 0.9958
2018-03-12 21:34:16 -- dev ROC AUC = 0.9485
2018-03-12 21:34:16 -- 
2018-03-12 21:34:16 -- Epoch = 38/50:
2018-03-12 21:35:40 -- train loss = 0.0091
2018-03-12 21:35:40 -- dev loss = 0.0345
2018-03-12 21:35:40 -- train ROC AUC = 0.9958
2018-03-12 21:35:40 -- dev ROC AUC = 0.9484
2018-03-12 21:35:40 -- 
2018-03-12 21:35:40 -- Epoch = 39/50:
2018-03-12 21:37:05 -- train loss = 0.0087
2018-03-12 21:37:05 -- dev loss = 0.0346
2018-03-12 21:37:05 -- train ROC AUC = 0.9961
2018-03-12 21:37:05 -- dev ROC AUC = 0.9489
2018-03-12 21:37:05 -- 
2018-03-12 21:37:05 -- Epoch = 40/50:
2018-03-12 21:38:29 -- train loss = 0.0083
2018-03-12 21:38:29 -- dev loss = 0.0350
2018-03-12 21:38:29 -- train ROC AUC = 0.9963
2018-03-12 21:38:29 -- dev ROC AUC = 0.9485
2018-03-12 21:38:29 -- 
2018-03-12 21:38:29 -- Epoch = 41/50:
2018-03-12 21:39:54 -- train loss = 0.0082
2018-03-12 21:39:54 -- dev loss = 0.0354
2018-03-12 21:39:54 -- train ROC AUC = 0.9964
2018-03-12 21:39:54 -- dev ROC AUC = 0.9466
2018-03-12 21:39:54 -- 
2018-03-12 21:39:54 -- Epoch = 42/50:
2018-03-12 21:41:20 -- train loss = 0.0079
2018-03-12 21:41:20 -- dev loss = 0.0364
2018-03-12 21:41:20 -- train ROC AUC = 0.9965
2018-03-12 21:41:20 -- dev ROC AUC = 0.9471
2018-03-12 21:41:20 -- 
2018-03-12 21:41:20 -- Epoch = 43/50:
2018-03-12 21:42:46 -- train loss = 0.0085
2018-03-12 21:42:46 -- dev loss = 0.0358
2018-03-12 21:42:46 -- train ROC AUC = 0.9964
2018-03-12 21:42:46 -- dev ROC AUC = 0.9466
2018-03-12 21:42:46 -- 
2018-03-12 21:42:46 -- Epoch = 44/50:
2018-03-12 21:44:12 -- train loss = 0.0080
2018-03-12 21:44:12 -- dev loss = 0.0368
2018-03-12 21:44:12 -- train ROC AUC = 0.9967
2018-03-12 21:44:12 -- dev ROC AUC = 0.9463
2018-03-12 21:44:12 -- 
2018-03-12 21:44:12 -- Epoch = 45/50:
2018-03-12 21:45:38 -- train loss = 0.0075
2018-03-12 21:45:38 -- dev loss = 0.0371
2018-03-12 21:45:38 -- train ROC AUC = 0.9969
2018-03-12 21:45:38 -- dev ROC AUC = 0.9457
2018-03-12 21:45:38 -- 
2018-03-12 21:45:38 -- Epoch = 46/50:
2018-03-12 21:47:05 -- train loss = 0.0071
2018-03-12 21:47:05 -- dev loss = 0.0385
2018-03-12 21:47:05 -- train ROC AUC = 0.9969
2018-03-12 21:47:05 -- dev ROC AUC = 0.9457
2018-03-12 21:47:05 -- 
2018-03-12 21:47:05 -- Epoch = 47/50:
2018-03-12 21:48:32 -- train loss = 0.0071
2018-03-12 21:48:32 -- dev loss = 0.0391
2018-03-12 21:48:32 -- train ROC AUC = 0.9971
2018-03-12 21:48:32 -- dev ROC AUC = 0.9456
2018-03-12 21:48:32 -- 
2018-03-12 21:48:32 -- Epoch = 48/50:
2018-03-12 21:50:00 -- train loss = 0.0069
2018-03-12 21:50:00 -- dev loss = 0.0394
2018-03-12 21:50:00 -- train ROC AUC = 0.9971
2018-03-12 21:50:00 -- dev ROC AUC = 0.9453
2018-03-12 21:50:00 -- 
2018-03-12 21:50:00 -- Epoch = 49/50:
2018-03-12 21:51:29 -- train loss = 0.0097
2018-03-12 21:51:29 -- dev loss = 0.0344
2018-03-12 21:51:29 -- train ROC AUC = 0.9962
2018-03-12 21:51:29 -- dev ROC AUC = 0.9480
2018-03-12 21:51:29 -- 
2018-03-12 21:51:29 -- Epoch = 50/50:
2018-03-12 21:52:57 -- train loss = 0.0085
2018-03-12 21:52:57 -- dev loss = 0.0370
2018-03-12 21:52:57 -- train ROC AUC = 0.9968
2018-03-12 21:52:57 -- dev ROC AUC = 0.9455
2018-03-12 21:52:57 -- 
2018-03-12 21:52:57 -- Testing...
2018-03-12 21:52:57 -- Rebuilding model...
2018-03-12 21:53:01 -- Restoring best model...
2018-03-12 21:53:10 -- Restoring parameters from out/new_test_3/new_test_3.weights
2018-03-12 21:53:11 -- Predicting labels for test set...
2018-03-12 21:53:47 -- Saving test prediction...
2018-03-12 21:53:48 -- 
2018-03-12 21:53:48 -- Evaluating...
2018-03-12 21:53:49 -- Mean column-wise ROC AUC - train = 0.9770
2018-03-12 21:53:49 -- Mean column-wise ROC AUC - dev = 0.9546
2018-03-12 21:53:49 -- ROC AUC of toxic - train = 0.9568
2018-03-12 21:53:49 -- ROC AUC of toxic - dev = 0.9326
2018-03-12 21:53:49 -- ROC AUC of severe_toxic - train = 0.9887
2018-03-12 21:53:49 -- ROC AUC of severe_toxic - dev = 0.9841
2018-03-12 21:53:49 -- ROC AUC of obscene - train = 0.9734
2018-03-12 21:53:49 -- ROC AUC of obscene - dev = 0.9506
2018-03-12 21:53:49 -- ROC AUC of threat - train = 0.9871
2018-03-12 21:53:49 -- ROC AUC of threat - dev = 0.9636
2018-03-12 21:53:49 -- ROC AUC of insult - train = 0.9758
2018-03-12 21:53:49 -- ROC AUC of insult - dev = 0.9538
2018-03-12 21:53:50 -- ROC AUC of identity_hate - train = 0.9801
2018-03-12 21:53:50 -- ROC AUC of identity_hate - dev = 0.9426
2018-03-12 21:53:50 -- Mean column-wise average precision - train = 0.5466
2018-03-12 21:53:50 -- Mean column-wise average precision - dev = 0.4470
2018-03-12 21:53:51 -- average precision of toxic - train = 0.8118
2018-03-12 21:53:51 -- average precision of toxic - dev = 0.7303
2018-03-12 21:53:51 -- average precision of severe_toxic - train = 0.4536
2018-03-12 21:53:51 -- average precision of severe_toxic - dev = 0.4153
2018-03-12 21:53:51 -- average precision of obscene - train = 0.7400
2018-03-12 21:53:51 -- average precision of obscene - dev = 0.6534
2018-03-12 21:53:51 -- average precision of threat - train = 0.2565
2018-03-12 21:53:51 -- average precision of threat - dev = 0.1161
2018-03-12 21:53:51 -- average precision of insult - train = 0.7151
2018-03-12 21:53:51 -- average precision of insult - dev = 0.6112
2018-03-12 21:53:51 -- average precision of identity_hate - train = 0.3023
2018-03-12 21:53:51 -- average precision of identity_hate - dev = 0.1559
